<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Google Sheets</title>
    <!-- Google Identity Services -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <style>
        /* ========================================
           CENTRALIZED SVG ICON LIBRARY
           All icons defined here, used everywhere
           Update once, changes apply globally
        ======================================== */
        
        :root {
            /* ========================================
               LIGHT MODE COLOR SYSTEM
               All colors organized in one place
            ======================================== */
            
            /* Background Colors */
            --bg-primary: #ffffff;
            --bg-secondary: #f8f9fa;
            --bg-hover: #f1f3f5;
            --card-bg: #ffffff;
            
            /* Text Colors */
            --text-primary: #212529;
            --text-secondary: #6c757d;
            
            /* Border & Shadow */
            --border-color: #dee2e6;
            --shadow: rgba(0, 0, 0, 0.1);
            
            /* Icon Colors - LIGHT MODE */
            --icon-primary: %23212529;        /* Dark gray for primary icons */
            --icon-secondary: %236c757d;      /* Medium gray for secondary icons */
            --icon-on-badge: %234E6B52;       /* Type badge icon color */
            --icon-location: %23D65052;       /* Location/area icon color */
            --icon-hover-light: %23ffffff;    /* White for hover states on colored backgrounds */
            
            /* Badge Colors */
            --badge-type-bg: rgba(78, 107, 82, 0.1);
            --badge-type-color: #4E6B52;
            --badge-area-bg: rgba(214, 80, 82, 0.1);
            --badge-area-color: #D65052;
            --badge-featured-bg: rgba(214, 80, 82, 0.9);
            --badge-featured-color: #ffffff;
            
            /* SVG Icon Definitions - All icons with stroke='currentColor' */
            --icon-wine: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M8 22h8'/%3E%3Cpath d='M7 10h10'/%3E%3Cpath d='M12 15v7'/%3E%3Cpath d='M12 15a5 5 0 0 0 5-5c0-2-.5-4-2-8H9c-1.5 4-2 6-2 8a5 5 0 0 0 5 5z'/%3E%3C/svg%3E");
            --icon-beer: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M17 11h1a3 3 0 0 1 0 6h-1'/%3E%3Cpath d='M9 12v6'/%3E%3Cpath d='M13 12v6'/%3E%3Cpath d='M14 7.5c-1 0-1.44.5-3 .5s-2-.5-3-.5-1.72.5-2.5.5a2.5 2.5 0 0 1 0-5c.78 0 1.5.5 2.5.5s2.22-.5 3.5-.5 2.5.5 3.5.5a2.5 2.5 0 0 1 0 5c-.78 0-1.5-.5-2.5-.5z'/%3E%3Cpath d='M5 8v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V8'/%3E%3C/svg%3E");
            --icon-spirits: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M8 2h8l.5 3h-9z'/%3E%3Cpath d='M7.5 5h9l1 12a2 2 0 0 1-2 2h-7a2 2 0 0 1-2-2z'/%3E%3Cpath d='M10 22v-3'/%3E%3Cpath d='M14 22v-3'/%3E%3C/svg%3E");
            --icon-cocktail: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M3 3l9 9v9'/%3E%3Cpath d='M21 3l-9 9'/%3E%3Cpath d='M3 3h18'/%3E%3Cpath d='M9 21h6'/%3E%3C/svg%3E");
            --icon-coffee: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M18 8h1a4 4 0 1 1 0 8h-1'/%3E%3Cpath d='M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z'/%3E%3Cpath d='M6 1v3'/%3E%3Cpath d='M10 1v3'/%3E%3Cpath d='M14 1v3'/%3E%3C/svg%3E");
            --icon-tea: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M18 8h1a4 4 0 1 1 0 8h-1'/%3E%3Cpath d='M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z'/%3E%3Cpath d='M6 1v2'/%3E%3Cpath d='M10 1v2'/%3E%3Cpath d='M14 1v2'/%3E%3Cpath d='M6 4v1'/%3E%3Cpath d='M10 4v1'/%3E%3Cpath d='M14 4v1'/%3E%3C/svg%3E");
            --icon-restaurant: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M3 2v7c0 1.1.9 2 2 2h0a2 2 0 0 0 2-2V2'/%3E%3Cpath d='M7 2v20'/%3E%3Cpath d='M21 15V2a5 5 0 0 0-5 5v8'/%3E%3Cpath d='M21 15v7'/%3E%3C/svg%3E");
            --icon-bakery: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M20 10c0-4.4-3.6-8-8-8s-8 3.6-8 8c0 .9.1 1.7.4 2.5L6 21h12l1.6-8.5c.3-.8.4-1.6.4-2.5z'/%3E%3Cpath d='M6 10h12'/%3E%3C/svg%3E");
            --icon-cheese: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m2 16 10 6V12L2 6z'/%3E%3Cpath d='m12 22 10-6V6l-10 6'/%3E%3Cpath d='M2 16V6l10-6 10 6v10'/%3E%3Ccircle cx='7' cy='13' r='1'/%3E%3Ccircle cx='17' cy='13' r='1'/%3E%3C/svg%3E");
            --icon-chocolate: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect width='18' height='18' x='3' y='3' rx='2'/%3E%3Cpath d='M3 9h18'/%3E%3Cpath d='M3 15h18'/%3E%3Cpath d='M9 3v18'/%3E%3Cpath d='M15 3v18'/%3E%3C/svg%3E");
            --icon-museum: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m3 21 18 0'/%3E%3Cpath d='M3 7v1a3 3 0 0 0 6 0V7'/%3E%3Cpath d='M9 21v-9'/%3E%3Cpath d='M15 7v1a3 3 0 0 0 6 0V7'/%3E%3Cpath d='M21 21v-9'/%3E%3Cpath d='M3 7h18L12 3z'/%3E%3C/svg%3E");
            --icon-art: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4'/%3E%3Cpolyline points='7 10 12 15 17 10'/%3E%3Cline x1='12' x2='12' y1='15' y2='3'/%3E%3C/svg%3E");
            --icon-gallery: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect width='18' height='18' x='3' y='3' rx='2' ry='2'/%3E%3Ccircle cx='9' cy='9' r='2'/%3E%3Cpath d='m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21'/%3E%3C/svg%3E");
            --icon-hiking: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='Ccircle cx='10' cy='4' r='2'/%3E%3Cpath d='M7 22V12l-2 3'/%3E%3Cpath d='M7 8v4l6 2 1 6'/%3E%3Cpath d='M14 22v-8'/%3E%3Cpath d='M19 12l-3-6'/%3E%3Cpath d='M19 22V9'/%3E%3C/svg%3E");
            --icon-cycling: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='5.5' cy='17.5' r='3.5'/%3E%3Ccircle cx='18.5' cy='17.5' r='3.5'/%3E%3Cpath d='M15 6a1 1 0 1 0 0-2 1 1 0 0 0 0 2z'/%3E%3Cpath d='m12 17.5-3.5-5.5L15 6'/%3E%3Cpath d='m12 6 3 5.5'/%3E%3C/svg%3E");
            --icon-activity: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='5.5' cy='17.5' r='3.5'/%3E%3Ccircle cx='18.5' cy='17.5' r='3.5'/%3E%3Cpath d='M15 6a1 1 0 1 0 0-2 1 1 0 0 0 0 2z'/%3E%3Cpath d='m12 17.5-3.5-5.5L15 6'/%3E%3Cpath d='m12 6 3 5.5'/%3E%3C/svg%3E");
            --icon-kayaking: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M6 19v-3'/%3E%3Cpath d='M10 19v-3'/%3E%3Cpath d='M14 19v-3'/%3E%3Cpath d='M18 19v-3'/%3E%3Cpath d='M8 11V9'/%3E%3Cpath d='M16 11V9'/%3E%3Cpath d='M12 11V9'/%3E%3Cpath d='M2 15h20'/%3E%3Cpath d='M2 7a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v1.1c0 .2 0 .3-.1.5L20.4 13H3.6L2.1 8.6c-.1-.2-.1-.3-.1-.5z'/%3E%3C/svg%3E");
            --icon-spa: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12 3a7 7 0 0 0-9 10h18a7 7 0 0 0-9-10z'/%3E%3Cpath d='M12 3v18'/%3E%3C/svg%3E");
            --icon-wellness: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.29 1.51 4.04 3 5.5l7 7z'/%3E%3C/svg%3E");
            --icon-shopping: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z'/%3E%3Cline x1='3' x2='21' y1='6' y2='6'/%3E%3Cpath d='M16 10a4 4 0 0 1-8 0'/%3E%3C/svg%3E");
            --icon-market: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M3 9 12 2l9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z'/%3E%3Cpolyline points='9 22 9 12 15 12 15 22'/%3E%3C/svg%3E");
            --icon-concert: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M9 18V5l12-2v13'/%3E%3Ccircle cx='6' cy='18' r='3'/%3E%3Ccircle cx='18' cy='16' r='3'/%3E%3C/svg%3E");
            --icon-theater: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M2 12a5 5 0 0 0 5 5 8 8 0 0 1 5 2 8 8 0 0 1 5-2 5 5 0 0 0 5-5V7h-5a8 8 0 0 0-5 2 8 8 0 0 0-5-2H2z'/%3E%3Cpath d='M6 11c1.5 0 3 .5 3 2-2 0-3 0-3-2z'/%3E%3Cpath d='M18 11c-1.5 0-3 .5-3 2 2 0 3 0 3-2z'/%3E%3C/svg%3E");
            --icon-cinema: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect width='18' height='18' x='3' y='3' rx='2'/%3E%3Cpath d='m16 10-4 4-4-4'/%3E%3C/svg%3E");
            --icon-festival: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M4 22h16'/%3E%3Cpath d='M6 18v-7'/%3E%3Cpath d='M10 18v-7'/%3E%3Cpath d='M14 18v-7'/%3E%3Cpath d='M18 18v-7'/%3E%3Cpath d='m4 11 2-2 2 2 2-2 2 2 2-2 2 2 2-2 2 2'/%3E%3Cpath d='M8 7V4c0-1.1.9-2 2-2h4a2 2 0 0 1 2 2v3'/%3E%3C/svg%3E");
            --icon-hotel: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M3 10h18V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2z'/%3E%3Cpath d='M21 14v8'/%3E%3Cpath d='M3 14v8'/%3E%3Cpath d='M3 14h18'/%3E%3C/svg%3E");
            --icon-lodging: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z'/%3E%3Cpolyline points='9 22 9 12 15 12 15 22'/%3E%3C/svg%3E");
            --icon-transport: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M19 17h2l.64-2.54c.24-.959.24-1.962 0-2.92l-1.07-4.27A3 3 0 0 0 17.66 5H4a2 2 0 0 0-2 2v10h2'/%3E%3Ccircle cx='6.5' cy='17.5' r='2.5'/%3E%3Ccircle cx='16.5' cy='17.5' r='2.5'/%3E%3C/svg%3E");
            --icon-train: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect width='16' height='16' x='4' y='3' rx='2'/%3E%3Cpath d='M4 11h16'/%3E%3Cpath d='M12 3v8'/%3E%3Cpath d='m8 19-2 3'/%3E%3Cpath d='m16 19 2 3'/%3E%3C/svg%3E");
            --icon-boat: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1 .6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1'/%3E%3Cpolyline points='7 4 2 9 7 14'/%3E%3Cpath d='M22 9 7 9 7 2 12 2z'/%3E%3C/svg%3E");
            --icon-scenic: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m8 2 1.88 1.88'/%3E%3Cpath d='M14.12 3.88 16 2'/%3E%3Cpath d='M9 7.13v-1a3.003 3.003 0 1 1 6 0v1'/%3E%3Cpath d='M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6'/%3E%3Cpath d='M12 20v-9'/%3E%3Cpath d='M6.53 9C4.6 8.8 3 7.1 3 5'/%3E%3Cpath d='M6 13H2'/%3E%3Cpath d='M3 21c0-2.1 1.7-3.9 3.8-4'/%3E%3Cpath d='M20.97 5c0 2.1-1.6 3.8-3.5 4'/%3E%3Cpath d='M22 13h-4'/%3E%3Cpath d='M17.2 17c2.1.1 3.8 1.9 3.8 4'/%3E%3C/svg%3E");
            --icon-viewpoint: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7z'/%3E%3Ccircle cx='12' cy='12' r='3'/%3E%3C/svg%3E");
            --icon-park: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12 22v-8.5'/%3E%3Cpath d='M7 12 3 8c-.6-.6-.9-1.3-.9-2 0-1.7 1.3-3 3-3 .7 0 1.4.3 2 .9l4 4 4-4c.6-.6 1.3-.9 2-.9 1.7 0 3 1.3 3 3 0 .7-.3 1.4-.9 2l-4 4'/%3E%3C/svg%3E");
            --icon-garden: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12 22c-4.97 0-9-4.03-9-9 0-2.5 1-4.75 2.63-6.41 1.32.87 3.14.7 4.24-.4a3 3 0 0 1 4.24 0c1.1 1.1 2.92 1.27 4.24.4C19.97 8.25 21 10.5 21 13c0 4.97-4.03 9-9 9z'/%3E%3Cpath d='M12 2v7'/%3E%3C/svg%3E");
            --icon-beach: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M17.28 9.05a5.5 5.5 0 1 0-10.56 0A5.5 5.5 0 1 0 12 17.66a5.5 5.5 0 1 0 5.28-8.6z'/%3E%3Cpath d='M12 17.66 12 22'/%3E%3C/svg%3E");
            --icon-history: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='12' cy='12' r='10'/%3E%3Cpolyline points='12 6 12 12 16 14'/%3E%3C/svg%3E");
            --icon-culture: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M22 20v-9H2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2z'/%3E%3Cpath d='M18 11V4H6v7'/%3E%3Cpath d='m9 9 1.5-1.5'/%3E%3Cpath d='m15 9-1.5-1.5'/%3E%3C/svg%3E");
            --icon-architecture: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M3 21h18'/%3E%3Cpath d='M6 21V7'/%3E%3Cpath d='M10 21V7'/%3E%3Cpath d='M14 21V7'/%3E%3Cpath d='M18 21V7'/%3E%3Cpath d='M3 7h18L12 2 3 7z'/%3E%3C/svg%3E");
            --icon-local: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0z'/%3E%3Ccircle cx='12' cy='10' r='3'/%3E%3C/svg%3E");
            --icon-tour: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='12' cy='12' r='10'/%3E%3Cpath d='M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20'/%3E%3Cpath d='M2 12h20'/%3E%3C/svg%3E");
            --icon-workshop: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z'/%3E%3C/svg%3E");
            --icon-class: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20'/%3E%3C/svg%3E");
            --icon-food: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M18 8h1a4 4 0 0 1 0 8h-1'/%3E%3Cpath d='M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z'/%3E%3Cline x1='6' x2='6' y1='1' y2='4'/%3E%3Cline x1='10' x2='10' y1='1' y2='4'/%3E%3Cline x1='14' x2='14' y1='1' y2='4'/%3E%3C/svg%3E");
            --icon-default: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='12' cy='12' r='10'/%3E%3Cpath d='M12 8v4'/%3E%3Cpath d='M12 16h.01'/%3E%3C/svg%3E");
        }
        
        :root.dark-mode {
            /* ========================================
               DARK MODE COLOR SYSTEM
               All colors organized in one place
            ======================================== */
            
            /* Background Colors */
            --bg-primary: #1a1a1a;
            --bg-secondary: #2d2d2d;
            --bg-hover: #3a3a3a;
            --card-bg: #2d2d2d;
            
            /* Text Colors */
            --text-primary: #e9ecef;
            --text-secondary: #adb5bd;
            
            /* Border & Shadow */
            --border-color: #495057;
            --shadow: rgba(0, 0, 0, 0.3);
            
            /* Icon Colors - DARK MODE */
            --icon-primary: %23e9ecef;        /* Light gray for primary icons */
            --icon-secondary: %23adb5bd;      /* Medium gray for secondary icons */
            --icon-on-badge: %239fc5a3;       /* Type badge icon color (lighter green) */
            --icon-location: %23f5a3a5;       /* Location/area icon color (lighter red) */
            --icon-hover-light: %23ffffff;    /* White for hover states on colored backgrounds */
            
            /* Badge Colors */
            --badge-type-bg: rgba(78, 107, 82, 0.2);
            --badge-type-color: #9fc5a3;
            --badge-area-bg: rgba(214, 80, 82, 0.2);
            --badge-area-color: #f5a3a5;
            --badge-featured-bg: rgba(214, 80, 82, 0.9);
            --badge-featured-color: #ffffff;
            
            --icon-beer: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M17 11h1a3 3 0 0 1 0 6h-1'/%3E%3Cpath d='M9 12v6'/%3E%3Cpath d='M13 12v6'/%3E%3Cpath d='M14 7.5c-1 0-1.44.5-3 .5s-2-.5-3-.5-1.72.5-2.5.5a2.5 2.5 0 0 1 0-5c.78 0 1.5.5 2.5.5s2.22-.5 3.5-.5 2.5.5 3.5.5a2.5 2.5 0 0 1 0 5c-.78 0-1.5-.5-2.5-.5z'/%3E%3Cpath d='M5 8v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V8'/%3E%3C/svg%3E");
            
            --icon-spirits: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M8 2h8l.5 3h-9z'/%3E%3Cpath d='M7.5 5h9l1 12a2 2 0 0 1-2 2h-7a2 2 0 0 1-2-2z'/%3E%3Cpath d='M10 22v-3'/%3E%3Cpath d='M14 22v-3'/%3E%3C/svg%3E");
            
            --icon-cocktail: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M3 3l9 9v9'/%3E%3Cpath d='M21 3l-9 9'/%3E%3Cpath d='M3 3h18'/%3E%3Cpath d='M9 21h6'/%3E%3C/svg%3E");
            
            --icon-coffee: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M18 8h1a4 4 0 1 1 0 8h-1'/%3E%3Cpath d='M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z'/%3E%3Cpath d='M6 1v3'/%3E%3Cpath d='M10 1v3'/%3E%3Cpath d='M14 1v3'/%3E%3C/svg%3E");
            
            --icon-tea: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M18 8h1a4 4 0 1 1 0 8h-1'/%3E%3Cpath d='M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z'/%3E%3Cpath d='M6 1v2'/%3E%3Cpath d='M10 1v2'/%3E%3Cpath d='M14 1v2'/%3E%3Cpath d='M6 4v1'/%3E%3Cpath d='M10 4v1'/%3E%3Cpath d='M14 4v1'/%3E%3C/svg%3E");
            
            --icon-restaurant: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M3 2v7c0 1.1.9 2 2 2h0a2 2 0 0 0 2-2V2'/%3E%3Cpath d='M7 2v20'/%3E%3Cpath d='M21 15V2a5 5 0 0 0-5 5v8'/%3E%3Cpath d='M21 15v7'/%3E%3C/svg%3E");
            
            --icon-bakery: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M20 10c0-4.4-3.6-8-8-8s-8 3.6-8 8c0 .9.1 1.7.4 2.5L6 21h12l1.6-8.5c.3-.8.4-1.6.4-2.5z'/%3E%3Cpath d='M6 10h12'/%3E%3C/svg%3E");
            
            --icon-cheese: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m2 16 10 6V12L2 6z'/%3E%3Cpath d='m12 22 10-6V6l-10 6'/%3E%3Cpath d='M2 16V6l10-6 10 6v10'/%3E%3Ccircle cx='7' cy='13' r='1'/%3E%3Ccircle cx='17' cy='13' r='1'/%3E%3C/svg%3E");
            
            --icon-chocolate: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect width='18' height='18' x='3' y='3' rx='2'/%3E%3Cpath d='M3 9h18'/%3E%3Cpath d='M3 15h18'/%3E%3Cpath d='M9 3v18'/%3E%3Cpath d='M15 3v18'/%3E%3C/svg%3E");
            
            --icon-museum: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m3 21 18 0'/%3E%3Cpath d='M3 7v1a3 3 0 0 0 6 0V7'/%3E%3Cpath d='M9 21v-9'/%3E%3Cpath d='M15 7v1a3 3 0 0 0 6 0V7'/%3E%3Cpath d='M21 21v-9'/%3E%3Cpath d='M3 7h18L12 3z'/%3E%3C/svg%3E");
            
            --icon-art: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4'/%3E%3Cpolyline points='7 10 12 15 17 10'/%3E%3Cline x1='12' x2='12' y1='15' y2='3'/%3E%3C/svg%3E");
            
            --icon-gallery: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect width='18' height='18' x='3' y='3' rx='2' ry='2'/%3E%3Ccircle cx='9' cy='9' r='2'/%3E%3Cpath d='m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21'/%3E%3C/svg%3E");
            
            --icon-hiking: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='Ccircle cx='10' cy='4' r='2'/%3E%3Cpath d='M7 22V12l-2 3'/%3E%3Cpath d='M7 8v4l6 2 1 6'/%3E%3Cpath d='M14 22v-8'/%3E%3Cpath d='M19 12l-3-6'/%3E%3Cpath d='M19 22V9'/%3E%3C/svg%3E");


            
            --icon-cycling: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='5.5' cy='17.5' r='3.5'/%3E%3Ccircle cx='18.5' cy='17.5' r='3.5'/%3E%3Cpath d='M15 6a1 1 0 1 0 0-2 1 1 0 0 0 0 2z'/%3E%3Cpath d='m12 17.5-3.5-5.5L15 6'/%3E%3Cpath d='m12 6 3 5.5'/%3E%3C/svg%3E");
            
            
            --icon-activity: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='5.5' cy='17.5' r='3.5'/%3E%3Ccircle cx='18.5' cy='17.5' r='3.5'/%3E%3Cpath d='M15 6a1 1 0 1 0 0-2 1 1 0 0 0 0 2z'/%3E%3Cpath d='m12 17.5-3.5-5.5L15 6'/%3E%3Cpath d='m12 6 3 5.5'/%3E%3C/svg%3E");
            --icon-kayaking: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M6 19v-3'/%3E%3Cpath d='M10 19v-3'/%3E%3Cpath d='M14 19v-3'/%3E%3Cpath d='M18 19v-3'/%3E%3Cpath d='M8 11V9'/%3E%3Cpath d='M16 11V9'/%3E%3Cpath d='M12 11V9'/%3E%3Cpath d='M2 15h20'/%3E%3Cpath d='M2 7a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v1.1c0 .2 0 .3-.1.5L20.4 13H3.6L2.1 8.6c-.1-.2-.1-.3-.1-.5z'/%3E%3C/svg%3E");
            
            --icon-spa: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12 3a7 7 0 0 0-9 10h18a7 7 0 0 0-9-10z'/%3E%3Cpath d='M12 3v18'/%3E%3C/svg%3E");
            
            --icon-wellness: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.29 1.51 4.04 3 5.5l7 7z'/%3E%3C/svg%3E");
            
            --icon-shopping: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z'/%3E%3Cline x1='3' x2='21' y1='6' y2='6'/%3E%3Cpath d='M16 10a4 4 0 0 1-8 0'/%3E%3C/svg%3E");
            
            --icon-market: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M3 9 12 2l9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z'/%3E%3Cpolyline points='9 22 9 12 15 12 15 22'/%3E%3C/svg%3E");
            
            --icon-concert: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M9 18V5l12-2v13'/%3E%3Ccircle cx='6' cy='18' r='3'/%3E%3Ccircle cx='18' cy='16' r='3'/%3E%3C/svg%3E");
            
            --icon-theater: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M2 12a5 5 0 0 0 5 5 8 8 0 0 1 5 2 8 8 0 0 1 5-2 5 5 0 0 0 5-5V7h-5a8 8 0 0 0-5 2 8 8 0 0 0-5-2H2z'/%3E%3Cpath d='M6 11c1.5 0 3 .5 3 2-2 0-3 0-3-2z'/%3E%3Cpath d='M18 11c-1.5 0-3 .5-3 2 2 0 3 0 3-2z'/%3E%3C/svg%3E");
            
            --icon-cinema: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect width='18' height='18' x='3' y='3' rx='2'/%3E%3Cpath d='m16 10-4 4-4-4'/%3E%3C/svg%3E");
            
            --icon-festival: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M4 22h16'/%3E%3Cpath d='M6 18v-7'/%3E%3Cpath d='M10 18v-7'/%3E%3Cpath d='M14 18v-7'/%3E%3Cpath d='M18 18v-7'/%3E%3Cpath d='m4 11 2-2 2 2 2-2 2 2 2-2 2 2 2-2 2 2'/%3E%3Cpath d='M8 7V4c0-1.1.9-2 2-2h4a2 2 0 0 1 2 2v3'/%3E%3C/svg%3E");
            
            --icon-hotel: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M3 10h18V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2z'/%3E%3Cpath d='M21 14v8'/%3E%3Cpath d='M3 14v8'/%3E%3Cpath d='M3 14h18'/%3E%3C/svg%3E");
            
            --icon-lodging: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z'/%3E%3Cpolyline points='9 22 9 12 15 12 15 22'/%3E%3C/svg%3E");
            
            --icon-transport: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M19 17h2l.64-2.54c.24-.959.24-1.962 0-2.92l-1.07-4.27A3 3 0 0 0 17.66 5H4a2 2 0 0 0-2 2v10h2'/%3E%3Ccircle cx='6.5' cy='17.5' r='2.5'/%3E%3Ccircle cx='16.5' cy='17.5' r='2.5'/%3E%3C/svg%3E");
            
            --icon-train: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect width='16' height='16' x='4' y='3' rx='2'/%3E%3Cpath d='M4 11h16'/%3E%3Cpath d='M12 3v8'/%3E%3Cpath d='m8 19-2 3'/%3E%3Cpath d='m16 19 2 3'/%3E%3C/svg%3E");
            
            --icon-boat: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1 .6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1'/%3E%3Cpolyline points='7 4 2 9 7 14'/%3E%3Cpath d='M22 9 7 9 7 2 12 2z'/%3E%3C/svg%3E");
            
            --icon-scenic: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m8 2 1.88 1.88'/%3E%3Cpath d='M14.12 3.88 16 2'/%3E%3Cpath d='M9 7.13v-1a3.003 3.003 0 1 1 6 0v1'/%3E%3Cpath d='M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6'/%3E%3Cpath d='M12 20v-9'/%3E%3Cpath d='M6.53 9C4.6 8.8 3 7.1 3 5'/%3E%3Cpath d='M6 13H2'/%3E%3Cpath d='M3 21c0-2.1 1.7-3.9 3.8-4'/%3E%3Cpath d='M20.97 5c0 2.1-1.6 3.8-3.5 4'/%3E%3Cpath d='M22 13h-4'/%3E%3Cpath d='M17.2 17c2.1.1 3.8 1.9 3.8 4'/%3E%3C/svg%3E");
            
            --icon-viewpoint: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7z'/%3E%3Ccircle cx='12' cy='12' r='3'/%3E%3C/svg%3E");
            
            --icon-park: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12 22v-8.5'/%3E%3Cpath d='M7 12 3 8c-.6-.6-.9-1.3-.9-2 0-1.7 1.3-3 3-3 .7 0 1.4.3 2 .9l4 4 4-4c.6-.6 1.3-.9 2-.9 1.7 0 3 1.3 3 3 0 .7-.3 1.4-.9 2l-4 4'/%3E%3C/svg%3E");
            
            --icon-garden: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12 22c-4.97 0-9-4.03-9-9 0-2.5 1-4.75 2.63-6.41 1.32.87 3.14.7 4.24-.4a3 3 0 0 1 4.24 0c1.1 1.1 2.92 1.27 4.24.4C19.97 8.25 21 10.5 21 13c0 4.97-4.03 9-9 9z'/%3E%3Cpath d='M12 2v7'/%3E%3C/svg%3E");
            
            --icon-beach: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M17.28 9.05a5.5 5.5 0 1 0-10.56 0A5.5 5.5 0 1 0 12 17.66a5.5 5.5 0 1 0 5.28-8.6z'/%3E%3Cpath d='M12 17.66 12 22'/%3E%3C/svg%3E");
            
            --icon-history: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='12' cy='12' r='10'/%3E%3Cpolyline points='12 6 12 12 16 14'/%3E%3C/svg%3E");
            
            --icon-culture: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M22 20v-9H2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2z'/%3E%3Cpath d='M18 11V4H6v7'/%3E%3Cpath d='m9 9 1.5-1.5'/%3E%3Cpath d='m15 9-1.5-1.5'/%3E%3C/svg%3E");
            
            --icon-architecture: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M3 21h18'/%3E%3Cpath d='M6 21V7'/%3E%3Cpath d='M10 21V7'/%3E%3Cpath d='M14 21V7'/%3E%3Cpath d='M18 21V7'/%3E%3Cpath d='M3 7h18L12 2 3 7z'/%3E%3C/svg%3E");
            
            --icon-local: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0z'/%3E%3Ccircle cx='12' cy='10' r='3'/%3E%3C/svg%3E");
            
            --icon-tour: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='12' cy='12' r='10'/%3E%3Cpath d='M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20'/%3E%3Cpath d='M2 12h20'/%3E%3C/svg%3E");
            
            --icon-workshop: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z'/%3E%3C/svg%3E");
            
            --icon-class: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20'/%3E%3C/svg%3E");
            
            --icon-food: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M18 8h1a4 4 0 0 1 0 8h-1'/%3E%3Cpath d='M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z'/%3E%3Cline x1='6' x2='6' y1='1' y2='4'/%3E%3Cline x1='10' x2='10' y1='1' y2='4'/%3E%3Cline x1='14' x2='14' y1='1' y2='4'/%3E%3C/svg%3E");
            
            --icon-default: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='12' cy='12' r='10'/%3E%3Cpath d='M12 8v4'/%3E%3Cpath d='M12 16h.01'/%3E%3C/svg%3E");
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
            background: var(--bg-primary); 
            color: var(--text-primary);
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        /* SVG Icon Library */
        .icon-wine { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M8 2h8M12 2v20M7 2c0 4 1.5 8 5 10M17 2c0 4-1.5 8-5 10M12 12v0'/%3E%3Cellipse cx='12' cy='19' rx='3' ry='2'/%3E%3C/svg%3E"); }
        .icon-beer { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M17 11h1a3 3 0 0 1 0 6h-1M18 11V8a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v11a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-8'/%3E%3Cline x1='9' y1='11' x2='9' y2='17'/%3E%3Cline x1='13' y1='11' x2='13' y2='17'/%3E%3C/svg%3E"); }
        .icon-spirits { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M9 2h6l1 10a4 4 0 0 1-8 0L9 2z'/%3E%3Cline x1='12' y1='12' x2='12' y2='22'/%3E%3Cpath d='M8 22h8'/%3E%3C/svg%3E"); }
        .icon-cocktail { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M5 5l7 7v8M19 5l-7 7M5 5h14'/%3E%3Ccircle cx='12' cy='20' r='2'/%3E%3Cline x1='3' y1='3' x2='7' y2='7'/%3E%3C/svg%3E"); }
        .icon-coffee { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M17 8h1a4 4 0 1 1 0 8h-1'/%3E%3Cpath d='M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V8z'/%3E%3Cline x1='6' y1='1' x2='6' y2='4'/%3E%3Cline x1='10' y1='1' x2='10' y2='4'/%3E%3Cline x1='14' y1='1' x2='14' y2='4'/%3E%3C/svg%3E"); }
        .icon-tea { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M17 8h1a4 4 0 1 1 0 8h-1'/%3E%3Cpath d='M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V8z'/%3E%3Cpath d='M6 1v3M10 1v3M14 1v3' stroke-dasharray='1,2'/%3E%3C/svg%3E"); }
        .icon-restaurant { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M3 2v7c0 1.1.9 2 2 2h0a2 2 0 0 0 2-2V2M7 2v20M21 15V2v0a5 5 0 0 0-5 5v8'/%3E%3Cline x1='21' y1='15' x2='21' y2='22'/%3E%3C/svg%3E"); }
        .icon-bakery { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cellipse cx='12' cy='11' rx='7' ry='4'/%3E%3Cpath d='M12 7c-3.5 0-6 1.5-6 4v8c0 1 1.5 2 6 2s6-1 6-2v-8c0-2.5-2.5-4-6-4z'/%3E%3Cline x1='8' y1='14' x2='8' y2='14.01'/%3E%3Cline x1='12' y1='14' x2='12' y2='14.01'/%3E%3Cline x1='16' y1='14' x2='16' y2='14.01'/%3E%3C/svg%3E"); }
        .icon-cheese { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M2.4 10L12 3l9.6 7v8H2.4v-8z'/%3E%3Ccircle cx='8' cy='14' r='1.5'/%3E%3Ccircle cx='14' cy='13' r='1'/%3E%3Ccircle cx='11' cy='16' r='1'/%3E%3C/svg%3E"); }
        .icon-chocolate { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Crect x='4' y='4' width='16' height='16' rx='2'/%3E%3Cline x1='4' y1='12' x2='20' y2='12'/%3E%3Cline x1='12' y1='4' x2='12' y2='20'/%3E%3Cline x1='8' y1='4' x2='8' y2='12'/%3E%3Cline x1='16' y1='4' x2='16' y2='12'/%3E%3Cline x1='8' y1='12' x2='8' y2='20'/%3E%3Cline x1='16' y1='12' x2='16' y2='20'/%3E%3C/svg%3E"); }
        .icon-museum { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M3 21h18M4 21V10l8-7 8 7v11'/%3E%3Cline x1='8' y1='10' x2='8' y2='21'/%3E%3Cline x1='12' y1='10' x2='12' y2='21'/%3E%3Cline x1='16' y1='10' x2='16' y2='21'/%3E%3C/svg%3E"); }
        .icon-art { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Crect x='3' y='3' width='18' height='18' rx='2'/%3E%3Ccircle cx='8.5' cy='8.5' r='1.5'/%3E%3Cpath d='M21 15l-5-5L5 21'/%3E%3C/svg%3E"); }
        .icon-gallery { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Crect x='2' y='6' width='20' height='14' rx='2'/%3E%3Cpath d='M2 12h20M7 6V4a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2'/%3E%3Ccircle cx='9' cy='14' r='1'/%3E%3Cpath d='M2 20l4-4 4 4 4-6 6 6'/%3E%3C/svg%3E"); }
        .icon-hiking { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='Ccircle cx='10' cy='4' r='2'/%3E%3Cpath d='M7 22V12l-2 3'/%3E%3Cpath d='M7 8v4l6 2 1 6'/%3E%3Cpath d='M14 22v-8'/%3E%3Cpath d='M19 12l-3-6'/%3E%3Cpath d='M19 22V9'/%3E%3C/svg%3E"); }
        .icon-cycling { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Ccircle cx='5.5' cy='17.5' r='3.5'/%3E%3Ccircle cx='18.5' cy='17.5' r='3.5'/%3E%3Cpath d='M12 5l3 7m-3-7l-3 7m3-7v0'/%3E%3Cpath d='M9 12L5.5 17.5M15 12l3.5 5.5'/%3E%3Ccircle cx='13' cy='4' r='1'/%3E%3C/svg%3E"); }
        .icon-activity { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Ccircle cx='5.5' cy='17.5' r='3.5'/%3E%3Ccircle cx='18.5' cy='17.5' r='3.5'/%3E%3Cpath d='M12 5l3 7m-3-7l-3 7m3-7v0'/%3E%3Cpath d='M9 12L5.5 17.5M15 12l3.5 5.5'/%3E%3Ccircle cx='13' cy='4' r='1'/%3E%3C/svg%3E"); }
        .icon-kayaking { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M3 18h18'/%3E%3Cpath d='M2 12l1.5 6h17l1.5-6-10-6-10 6z'/%3E%3Ccircle cx='12' cy='7' r='1.5'/%3E%3C/svg%3E"); }
        .icon-spa { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M12 2C6.5 8 3 12 3 17a9 9 0 0 0 18 0c0-5-3.5-9-9-15z'/%3E%3Cpath d='M12 2v20'/%3E%3C/svg%3E"); }
        .icon-wellness { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z'/%3E%3C/svg%3E"); }
        .icon-shopping { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z'/%3E%3Cline x1='3' y1='6' x2='21' y2='6'/%3E%3Cpath d='M16 10a4 4 0 0 1-8 0'/%3E%3C/svg%3E"); }
        .icon-market { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z'/%3E%3Cpolyline points='9 22 9 12 15 12 15 22'/%3E%3C/svg%3E"); }
        .icon-concert { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M9 18V5l12-2v13'/%3E%3Ccircle cx='6' cy='18' r='3'/%3E%3Ccircle cx='18' cy='16' r='3'/%3E%3C/svg%3E"); }
        .icon-theater { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M7 2v20M17 2v20M2 12h20M2 7h5M2 17h5M17 7h5M17 17h5'/%3E%3C/svg%3E"); }
        .icon-cinema { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Crect x='2' y='7' width='20' height='15' rx='2'/%3E%3Cpolyline points='7 2 12 7 17 2 22 7'/%3E%3C/svg%3E"); }
        .icon-festival { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M4 12l8-8 8 8M4 22l8-8 8 8M12 4v16'/%3E%3Ccircle cx='12' cy='2' r='1'/%3E%3C/svg%3E"); }
        .icon-hotel { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Crect x='3' y='4' width='18' height='18' rx='2'/%3E%3Cpath d='M7 4v18M17 4v18M3 10h4M17 10h4M3 14h4M17 14h4M3 18h4M17 18h4'/%3E%3C/svg%3E"); }
        .icon-lodging { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z'/%3E%3Cpath d='M9 22V12h6v10'/%3E%3C/svg%3E"); }
        .icon-transport { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Crect x='1' y='3' width='15' height='13' rx='2'/%3E%3Cpath d='M16 8h5l3 3v5h-2.5'/%3E%3Ccircle cx='5.5' cy='18.5' r='2.5'/%3E%3Ccircle cx='18.5' cy='18.5' r='2.5'/%3E%3C/svg%3E"); }
        .icon-train { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Crect x='4' y='4' width='16' height='16' rx='2'/%3E%3Cpath d='M4 11h16M9 15h6M9 19l-2 2M15 19l2 2M12 4v3'/%3E%3C/svg%3E"); }
        .icon-boat { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M2 20a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v0M2 20l8-8v-6h4v6l8 8M12 2v4'/%3E%3C/svg%3E"); }
        .icon-scenic { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M3 18l5-5 4 4 5-7 4 5v3H3v-0z'/%3E%3Ccircle cx='18' cy='8' r='2'/%3E%3Cpath d='M21 18H3'/%3E%3C/svg%3E"); }
        .icon-viewpoint { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Ccircle cx='12' cy='12' r='10'/%3E%3Ccircle cx='12' cy='12' r='4'/%3E%3Cline x1='21.17' y1='8' x2='12' y2='12'/%3E%3Cline x1='3.95' y1='6.06' x2='12' y2='12'/%3E%3Cline x1='10.88' y1='21.94' x2='12' y2='12'/%3E%3C/svg%3E"); }
        .icon-park { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M12 2L7 12h10L12 2z'/%3E%3Cpath d='M5 14L2 22h20l-3-8H5z'/%3E%3Cline x1='12' y1='22' x2='12' y2='12'/%3E%3C/svg%3E"); }
        .icon-garden { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M12 22v-8m0 0c-3-2-7-2-7-8 0 0 3 0 7 4m0 4c3-2 7-2 7-8 0 0-3 0-7 4'/%3E%3Ccircle cx='12' cy='2' r='1'/%3E%3C/svg%3E"); }
        .icon-beach { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M12 3L7 12h10L12 3z'/%3E%3Cpath d='M7 12L2 22h20l-5-10'/%3E%3Cline x1='12' y1='3' x2='12' y2='12'/%3E%3C/svg%3E"); }
        .icon-history { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Ccircle cx='12' cy='12' r='10'/%3E%3Cpolyline points='12 6 12 12 16 14'/%3E%3C/svg%3E"); }
        .icon-culture { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M2 3h20v18H2z'/%3E%3Cpath d='M2 9h20M2 15h20M9 3v18M15 3v18'/%3E%3C/svg%3E"); }
        .icon-architecture { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M3 21h18M6 21V7l6-4 6 4v14'/%3E%3Cline x1='9' y1='9' x2='9' y2='21'/%3E%3Cline x1='15' y1='9' x2='15' y2='21'/%3E%3C/svg%3E"); }
        .icon-local { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z'/%3E%3Ccircle cx='12' cy='10' r='3'/%3E%3C/svg%3E"); }
        .icon-tour { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Ccircle cx='12' cy='12' r='10'/%3E%3Cpath d='M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20'/%3E%3Cpath d='M2 12h20'/%3E%3C/svg%3E"); }
        .icon-workshop { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z'/%3E%3C/svg%3E"); }
        .icon-class { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M4 19.5A2.5 2.5 0 0 1 6.5 17H20'/%3E%3Cpath d='M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z'/%3E%3C/svg%3E"); }
        .icon-default { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Ccircle cx='12' cy='12' r='10'/%3E%3Cline x1='12' y1='8' x2='12' y2='12'/%3E%3Cline x1='12' y1='16' x2='12.01' y2='16'/%3E%3C/svg%3E"); }

        /* Badge Styles */
        .icon-default { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Ccircle cx='12' cy='12' r='10'/%3E%3Cline x1='12' y1='8' x2='12' y2='12'/%3E%3Cline x1='12' y1='16' x2='12.01' y2='16'/%3E%3C/svg%3E"); }
        
        /* ========================================
           ICON COLOR SYSTEM
           Icons adapt automatically to theme
        ======================================== */
        
        /* Light Mode - Make badge type icons match the badge color (green) */
        .badge-type::before {
            /* Convert black SVG icons to green (#4E6B52) */
            filter: brightness(0) saturate(100%) invert(38%) sepia(15%) saturate(879%) hue-rotate(94deg) brightness(95%) contrast(89%);
        }
        
        /* Light Mode - Filter buttons should also have green icons */
        .type-filter-btn::before {
            filter: brightness(0) saturate(100%) invert(38%) sepia(15%) saturate(879%) hue-rotate(94deg) brightness(95%) contrast(89%);
        }
        
        /* Light Mode - Hover state for badges turns icons white */
        .badge-type:hover::before,
        .type-filter-btn:hover::before,
        .type-filter-btn.active::before {
            filter: brightness(0) invert(1); /* White icons on colored background */
        }
        
        /* Dark Mode - Make all SVG icons light gray */
        :root.dark-mode .badge-type::before,
        :root.dark-mode .type-filter-btn::before {
            filter: brightness(0) invert(0.9); /* Light gray icons in dark mode */
        }
        
        /* Dark Mode - Hover states turn white */
        :root.dark-mode .badge-type:hover::before,
        :root.dark-mode .type-filter-btn:hover::before,
        :root.dark-mode .type-filter-btn.active::before {
            filter: brightness(0) invert(1); /* White on hover */
        }
        
        /* Nav items in dark mode */
        :root.dark-mode .nav-item svg {
            stroke: var(--text-primary);
        }
        
        /* Card info icons */
        :root.dark-mode .card-info-icon {
            filter: brightness(0) invert(0.9);
        }
        
        .header { background: #1a1a1a; color: white; padding-bottom: 0; border-bottom: 3px solid #4E6B52; transition: all 0.3s; }
        #previewTab.active ~ .header,
        body.preview-mode .header { display: none; }
        .header-content { max-width: 1400px; margin: 0 auto; padding: 30px 20px 20px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 20px; }
        .header h1 { font-size: 28px; margin-bottom: 10px; }
        .header p { opacity: 0.9; font-size: 16px; }
        .header-buttons { display: flex; gap: 10px; flex-wrap: wrap; }
        
        .tabs { max-width: 1400px; margin: 0 auto; display: flex; gap: 4px; padding: 0 20px; }
        .tab-btn { background: transparent; border: none; color: rgba(255,255,255,0.6); padding: 15px 30px; cursor: pointer; font-size: 14px; font-weight: 600; border-top-left-radius: 6px; border-top-right-radius: 6px; transition: all 0.3s; border-bottom: 3px solid transparent; display: flex; align-items: center; justify-content: center; }
        .tab-btn svg { stroke: rgba(255,255,255,0.6); transition: stroke 0.3s; }
        .tab-btn:hover { color: white; }
        .tab-btn:hover svg { stroke: white; }
        .tab-btn.active { color: white; background: rgba(78,107,82,0.3); border-bottom-color: #4E6B52; box-shadow: 0 -2px 8px rgba(78,107,82,0.2); }
        .tab-btn.active svg { stroke: white; }
        
        .btn { padding: 12px 24px; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; }
        .btn-success { background: #E3795C; color: white; }
        .btn-success:hover { background: #D65052; transform: translateY(-2px); }
        .btn-primary { background: #4E6B52; color: white; }
        .btn-primary:hover { background: #3d5440; }
        .btn-secondary { background: #6b7280; color: white; }
        .btn-secondary:hover { background: #4b5563; }
        
        .stats { max-width: 1400px; margin: 30px auto; padding: 0 20px; display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; }
        .stat-card { background: var(--card-bg); padding: 25px; border-radius: 12px; box-shadow: 0 2px 8px var(--shadow); border-left: 4px solid #4E6B52; }
        .stat-card h3 { font-size: 14px; color: var(--text-secondary); margin-bottom: 10px; }
        .stat-card p { font-size: 32px; font-weight: 700; color: #4E6B52; }
        
        .container { max-width: 1400px; margin: 0 auto; padding: 30px 20px; }
        .section-title { font-size: 24px; margin-bottom: 25px; color: var(--text-primary); }
        
        .filter-bar { background: var(--card-bg); padding: 20px; border-radius: 12px; margin-bottom: 25px; box-shadow: 0 2px 8px var(--shadow); }
        .filter-bar input { width: 100%; padding: 12px 16px; border: 2px solid var(--border-color); border-radius: 8px; font-size: 14px; }
        .filter-bar input:focus { outline: none; border-color: #4E6B52; }
        
        .listings-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        .listing-card { background: var(--card-bg); border: 1px solid var(--border-color); border-radius: 12px; overflow: hidden; transition: all 0.3s ease; position: relative; box-shadow: 0 2px 8px var(--shadow); display: flex; flex-direction: column; }
        .listing-card:hover { box-shadow: 0 8px 20px var(--shadow); transform: translateY(-4px); }
        
        .listing-image { width: 100%; height: 180px; object-fit: cover; }
        .listing-content { padding: 20px; display: flex; flex-direction: column; flex: 1; }
        .listing-content h3 { font-size: 18px; margin-bottom: 8px; color: var(--text-primary); }
        
        .listing-meta { display: flex; gap: 10px; margin-bottom: 12px; flex-wrap: wrap; }
        .badge { padding: 4px 10px; border-radius: 6px; font-size: 12px; font-weight: 600; }
        .badge-type { background: var(--badge-type-bg); color: var(--badge-type-color); }
        .badge-area { background: var(--badge-area-bg); color: var(--badge-area-color); }
        
        .listing-desc { font-size: 14px; color: var(--text-secondary); line-height: 1.5; margin-bottom: 12px; }
        .listing-amenities { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 12px; }
        .amenity { padding: 3px 8px; background: var(--bg-hover); border-radius: 4px; font-size: 11px; color: var(--text-secondary); border: 1px solid var(--border-color); }
        
        .listing-contact { font-size: 13px; color: var(--text-secondary); margin-bottom: 15px; }
        .listing-actions { display: flex; gap: 10px; padding-top: 15px; border-top: 1px solid var(--border-color); margin-top: auto; }
        .btn-edit { background: #4E6B52; color: white; padding: 8px 16px; border: none; border-radius: 6px; font-size: 12px; font-weight: 600; cursor: pointer; flex: 1; }
        .btn-edit:hover { background: #3d5440; }
        .btn-delete { background: #E3795C; color: white; padding: 8px 16px; border: none; border-radius: 6px; font-size: 12px; font-weight: 600; cursor: pointer; }
        .btn-delete:hover { background: #D65052; }
        
        .featured-badge { position: absolute; top: 10px; right: 10px; background: var(--badge-featured-bg); color: var(--badge-featured-color); padding: 4px 10px; border-radius: 6px; font-size: 11px; font-weight: 700; z-index: 10; }
        
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(62,53,53,0.5); z-index: 1000; overflow-y: auto; }
        .modal.active { display: flex; align-items: center; justify-content: center; padding: 20px; }
        .modal-content { background: var(--card-bg); border-radius: 12px; padding: 30px; max-width: 700px; width: 100%; max-height: 90vh; overflow-y: auto; box-shadow: 0 20px 60px var(--shadow); }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
        .modal-header h2 { font-size: 24px; color: var(--text-primary); }
        .close-modal { background: none; border: none; font-size: 28px; cursor: pointer; color: var(--text-secondary); padding: 0; width: 32px; height: 32px; }
        .close-modal:hover { color: var(--text-primary); }
        
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-primary); font-size: 14px; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; font-size: 14px; font-family: inherit; transition: border-color 0.3s ease, background-color 0.3s ease; background: var(--bg-primary); color: var(--text-primary); }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus { outline: none; border-color: #4E6B52; }
        .form-group textarea { resize: vertical; min-height: 100px; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        
        .checkbox-group { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 8px; }
        .checkbox-item { display: flex; align-items: center; gap: 6px; }
        .checkbox-item input[type="checkbox"] { width: auto; }
        
        .modal-actions { display: flex; gap: 10px; justify-content: flex-end; margin-top: 30px; }
        
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        
        .preview-container { width: 100%; margin: 0; padding: 0; transition: background-color 0.3s, color 0.3s; }
        
        .preview-controls {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: none;
            gap: 10px;
            align-items: center;
        }
        
        #previewTab.active .preview-controls {
            display: flex;
        }
        
        .back-to-admin {
            background: #4E6B52;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transition: all 0.3s;
        }
        
        .back-to-admin:hover {
            background: #3d5440;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        
        .preview-dark-toggle {
            background: #6b7280;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transition: all 0.3s;
            width: 44px;
            height: 44px;
        }
        
        .preview-dark-toggle:hover {
            background: #4b5563;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        
        .preview-dark-toggle svg {
            width: 18px;
            height: 18px;
        }
        .back-to-admin svg {
            width: 18px;
            height: 18px;
        }
        :root.dark-mode body .back-to-admin {
            background: #4E6B52;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }
        :root.dark-mode body .back-to-admin:hover {
            background: #5a7d5f;
        }
        
        .preview-header { text-align: left; margin-bottom: 40px; padding: 30px 30px 0 0; transition: color 0.3s; }
        .preview-header h1 { font-size: 32px; color: var(--text-primary); margin-bottom: 10px; transition: color 0.3s; }
        .preview-header p { font-size: 18px; color: var(--text-secondary); transition: color 0.3s; }
        
        /* Dark Mode Toggle Switch */
        .theme-toggle-container {
            padding: 15px 20px;
            border-top: 1px solid var(--border-color);
            background: var(--card-bg);
            flex-shrink: 0;
            margin-top: auto;
        }
        .theme-toggle-wrapper {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
        }
        .theme-toggle-label {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .theme-toggle-label svg {
            width: 18px;
            height: 18px;
        }
        .theme-switch {
            position: relative;
            display: inline-block;
            width: 48px;
            height: 26px;
            flex-shrink: 0;
        }
        .theme-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .theme-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #e5e7eb;
            transition: .3s;
            border-radius: 26px;
        }
        .theme-slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .3s;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        input:checked + .theme-slider {
            background-color: #4E6B52;
        }
        input:checked + .theme-slider:before {
            transform: translateX(22px);
        }
        .theme-slider:hover {
            background-color: #d1d5db;
        }
        input:checked + .theme-slider:hover {
            background-color: #3d5441;
        }
        
        /* Dark mode adjustments for toggle */
        :root.dark-mode body .theme-toggle-container {
            background: #242424;
            border-top-color: #404040;
        }
        :root.dark-mode body .theme-toggle-label {
            color: #ffffff;
        }
        :root.dark-mode body .theme-slider {
            background-color: #404040;
        }
        :root.dark-mode body .theme-slider:hover {
            background-color: #4a4a4a;
        }
        
        /* Dark Mode Styles */
        :root.dark-mode body .preview-container { background: #1a1a1a; }
        :root.dark-mode body .preview-header h1 { color: #ffffff; }
        :root.dark-mode body .preview-header p { color: #9ca3af; }
        
        :root.dark-mode body .preview-sidebar { border-right: 1px solid #404040; }
        :root.dark-mode body .preview-filters { background: #2d2d2d; border-right: 1px solid #404040; }
        :root.dark-mode body .preview-filters h3 { background: #242424; color: #ffffff; border-bottom: 1px solid #404040; }
        
        :root.dark-mode body .filter-section.search-section { background: #242424; border-bottom: 2px solid #404040; }
        :root.dark-mode body .preview-search label { color: #ffffff; }
        :root.dark-mode body .preview-search input { 
            background: #1a1a1a; 
            border-color: #404040; 
            color: #ffffff;
        }
        :root.dark-mode body .preview-search input:focus { 
            border-color: #4E6B52; 
            background: #242424;
            box-shadow: 0 0 0 3px rgba(78, 107, 82, 0.2);
        }
        :root.dark-mode body .preview-search input::placeholder { color: var(--text-secondary); }
        
        :root.dark-mode body .type-filter-btn {
            background: #242424;
            border-color: #404040;
            color: #9ca3af;
        }
        :root.dark-mode body .type-filter-btn svg {
            stroke: #9ca3af;
        }
        :root.dark-mode body .type-filter-btn:hover {
            background: #2d2d2d;
            border-color: #4E6B52;
            color: #ffffff;
        }
        :root.dark-mode body .type-filter-btn:hover svg {
            stroke: #4E6B52;
        }
        :root.dark-mode body .type-filter-btn.active {
            background: #4E6B52;
            border-color: #4E6B52;
            color: white;
        }
        :root.dark-mode body .type-filter-btn.active svg {
            stroke: white;
        }
        
        :root.dark-mode body .preview-filter-group label { color: #9ca3af; }
        :root.dark-mode body .preview-filter-group select {
            background-color: #242424;
            border-color: #404040;
            color: #ffffff;
        }
        :root.dark-mode body .preview-filter-group select:hover,
        :root.dark-mode body .preview-filter-group select:focus {
            background-color: #2d2d2d;
            border-color: #4E6B52;
        }
        
        :root.dark-mode body .btn-secondary {
            background: #404040;
            color: #ffffff;
            border-color: #404040;
        }
        :root.dark-mode body .btn-secondary:hover {
            background: #4a4a4a;
        }
        
        :root.dark-mode body .preview-results { color: #9ca3af; }
        
        :root.dark-mode body .flip-card-front {
            background: #242424;
            border: 1px solid #404040;
        }
        :root.dark-mode body .flip-card:hover .flip-card-front {
            border-color: #4E6B52;
            box-shadow: 0 12px 24px rgba(0,0,0,0.3);
        }
        :root.dark-mode body .flip-card-front h3 { color: #ffffff !important; }
        :root.dark-mode body .flip-card-front p { color: #9ca3af !important; }
        
        :root.dark-mode body .flip-card-back {
            background: #2d2d2d;
            border: 1px solid #404040;
        }
        :root.dark-mode body .flip-card:hover .flip-card-back {
            box-shadow: 0 12px 24px rgba(0,0,0,0.3);
        }
        :root.dark-mode body .flip-card-back h3 { color: #ffffff !important; }
        :root.dark-mode body .flip-card-back p,
        :root.dark-mode body .flip-card-back span { color: #9ca3af !important; }
        :root.dark-mode body .flip-card-back strong { color: #ffffff !important; }
        
        :root.dark-mode body .filter-content::-webkit-scrollbar-thumb { background: #4a4a4a; }
        :root.dark-mode body .filter-content::-webkit-scrollbar-thumb:hover { background: #4b5563; }
        
        
        /* Apply icons from centralized library */
        .badge-type.icon-wine::before { background-image: var(--icon-wine); }
        .badge-type.icon-beer::before { background-image: var(--icon-beer); }
        .badge-type.icon-spirits::before { background-image: var(--icon-spirits); }
        .badge-type.icon-cocktail::before { background-image: var(--icon-cocktail); }
        .badge-type.icon-coffee::before { background-image: var(--icon-coffee); }
        .badge-type.icon-tea::before { background-image: var(--icon-tea); }
        .badge-type.icon-restaurant::before { background-image: var(--icon-restaurant); }
        .badge-type.icon-bakery::before { background-image: var(--icon-bakery); }
        .badge-type.icon-cheese::before { background-image: var(--icon-cheese); }
        .badge-type.icon-chocolate::before { background-image: var(--icon-chocolate); }
        .badge-type.icon-museum::before { background-image: var(--icon-museum); }
        .badge-type.icon-art::before { background-image: var(--icon-art); }
        .badge-type.icon-gallery::before { background-image: var(--icon-gallery); }
        .badge-type.icon-hiking::before { background-image: var(--icon-hiking); }
        .badge-type.icon-cycling::before { background-image: var(--icon-cycling); }
        .badge-type.icon-activity::before { background-image: var(--icon-activity); }
        .badge-type.icon-kayaking::before { background-image: var(--icon-kayaking); }
        .badge-type.icon-spa::before { background-image: var(--icon-spa); }
        .badge-type.icon-wellness::before { background-image: var(--icon-wellness); }
        .badge-type.icon-shopping::before { background-image: var(--icon-shopping); }
        .badge-type.icon-market::before { background-image: var(--icon-market); }
        .badge-type.icon-concert::before { background-image: var(--icon-concert); }
        .badge-type.icon-theater::before { background-image: var(--icon-theater); }
        .badge-type.icon-cinema::before { background-image: var(--icon-cinema); }
        .badge-type.icon-festival::before { background-image: var(--icon-festival); }
        .badge-type.icon-hotel::before { background-image: var(--icon-hotel); }
        .badge-type.icon-lodging::before { background-image: var(--icon-lodging); }
        .badge-type.icon-transport::before { background-image: var(--icon-transport); }
        .badge-type.icon-train::before { background-image: var(--icon-train); }
        .badge-type.icon-boat::before { background-image: var(--icon-boat); }
        .badge-type.icon-scenic::before { background-image: var(--icon-scenic); }
        .badge-type.icon-viewpoint::before { background-image: var(--icon-viewpoint); }
        .badge-type.icon-park::before { background-image: var(--icon-park); }
        .badge-type.icon-garden::before { background-image: var(--icon-garden); }
        .badge-type.icon-beach::before { background-image: var(--icon-beach); }
        .badge-type.icon-history::before { background-image: var(--icon-history); }
        .badge-type.icon-culture::before { background-image: var(--icon-culture); }
        .badge-type.icon-architecture::before { background-image: var(--icon-architecture); }
        .badge-type.icon-local::before { background-image: var(--icon-local); }
        .badge-type.icon-tour::before { background-image: var(--icon-tour); }
        .badge-type.icon-workshop::before { background-image: var(--icon-workshop); }
        .badge-type.icon-class::before { background-image: var(--icon-class); }
        .badge-type.icon-food::before { background-image: var(--icon-food); }
        .badge-type.icon-default::before { background-image: var(--icon-default); }
        
        /* Filter buttons use same icons */
        .type-filter-btn[data-type="Wine"]::before,
        .type-filter-btn[data-type="Winery"]::before { background-image: var(--icon-wine); }
        .type-filter-btn[data-type="Beer"]::before,
        .type-filter-btn[data-type="Brewery"]::before { background-image: var(--icon-beer); }
        .type-filter-btn[data-type="Spirits"]::before,
        .type-filter-btn[data-type="Distillery"]::before { background-image: var(--icon-spirits); }
        .type-filter-btn[data-type="Cocktails"]::before { background-image: var(--icon-cocktail); }
        .type-filter-btn[data-type="Coffee"]::before { background-image: var(--icon-coffee); }
        .type-filter-btn[data-type="Restaurant"]::before { background-image: var(--icon-restaurant); }
        .type-filter-btn[data-type="Bakery"]::before { background-image: var(--icon-bakery); }
        .type-filter-btn[data-type="Museum"]::before { background-image: var(--icon-museum); }
        .type-filter-btn[data-type="Hiking"]::before { background-image: var(--icon-hiking); }
        .type-filter-btn[data-type="Activity"]::before,
        .type-filter-btn[data-type="Activities"]::before { background-image: var(--icon-activity); }
        .type-filter-btn[data-type="Shopping"]::before { background-image: var(--icon-shopping); }
        .type-filter-btn[data-type="Hotel"]::before { background-image: var(--icon-hotel); }
        .type-filter-btn[data-type="Lodging"]::before { background-image: var(--icon-lodging); }
        
        /* Dark mode - icons remain the same (currentColor adapts) */
        
        /* Hover states - icons turn white */
        .badge-type {
            background: #f0f4f1;
            color: #4E6B52;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            position: relative;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .badge-type::before {
            content: '';
            width: 14px;
            height: 14px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            display: inline-block;
            flex-shrink: 0;
        }
        .badge-type:hover {
            background-color: #4E6B52;
            color: white;
            transform: scale(1.05);
        }
        .badge-area {
            background: #fef5f3;
            color: #D65052;
            padding: 3px 6px 3px 22px;
            border-radius: 5px;
            font-size: 11px;
            font-weight: 600;
            position: relative;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%23D65052' stroke-width='2'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M15 10.5a3 3 0 11-6 0 3 3 0 016 0z' /%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z' /%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: 5px center;
            background-size: 12px 12px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .badge-area:hover {
            background-color: #D65052;
            color: white;
            transform: scale(1.05);
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%23ffffff' stroke-width='2'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M15 10.5a3 3 0 11-6 0 3 3 0 016 0z' /%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z' /%3E%3C/svg%3E");
        }
        :root.dark-mode body .badge-type {
            background-color: rgba(78, 107, 82, 0.2);
            color: #82b894;
        }
        :root.dark-mode body .badge-type:hover {
            background-color: #4E6B52;
            color: white;
        }
        :root.dark-mode body .badge-area {
            background-color: rgba(214, 80, 82, 0.2);
            color: #f09090;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%23f09090' stroke-width='2'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M15 10.5a3 3 0 11-6 0 3 3 0 016 0z' /%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z' /%3E%3C/svg%3E");
        }
        :root.dark-mode body .badge-area:hover {
            background-color: #D65052;
            color: white;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%23ffffff' stroke-width='2'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M15 10.5a3 3 0 11-6 0 3 3 0 016 0z' /%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z' /%3E%3C/svg%3E");
        }
        
        /* Card Info Icons */
        .card-info-item {
            display: flex;
            align-items: flex-start;
            gap: 8px;
            margin-bottom: 10px;
            transition: all 0.2s;
        }
        a.card-info-item:hover {
            opacity: 0.8;
        }
        a.card-info-item:hover .card-info-icon {
            background: #4E6B52;
        }
        a.card-info-item:hover .card-info-icon svg {
            stroke: white;
        }
        .card-info-icon {
            width: 32px;
            height: 32px;
            flex-shrink: 0;
            background: #f3f4f6;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        .card-info-icon svg {
            width: 18px;
            height: 18px;
            stroke: #6b7280;
            transition: all 0.3s;
        }
        .card-info-text {
            flex: 1;
            font-size: 13px;
            line-height: 1.4;
            padding-top: 6px;
        }
        
        :root.dark-mode body .card-info-icon {
            background: #404040;
        }
        :root.dark-mode body .card-info-icon svg {
            stroke: #9ca3af;
        }
        :root.dark-mode body a.card-info-item:hover .card-info-icon {
            background: #4E6B52;
        }
        :root.dark-mode body a.card-info-item:hover .card-info-icon svg {
            stroke: white;
        }
        
        .preview-content-wrapper { display: flex; gap: 0; align-items: stretch; min-height: 100vh; }
        
        .preview-sidebar { width: 280px; flex-shrink: 0; position: sticky; top: 0; height: 100vh; left: 0; align-self: flex-start; }
        
        .preview-filters { background: var(--bg-secondary); padding: 0; border-radius: 0; box-shadow: none; border-right: 1px solid var(--border-color); height: 100%; display: flex; flex-direction: column; }
        .preview-filters h3 { font-size: 18px; color: var(--text-primary); margin-bottom: 0; padding: 20px 20px 15px; border-bottom: 1px solid var(--border-color); background: var(--card-bg); flex-shrink: 0; }
        
        .filter-content { flex: 1; overflow-y: auto; padding: 0; min-height: 0; }
        .filter-content::-webkit-scrollbar { width: 6px; }
        .filter-content::-webkit-scrollbar-track { background: transparent; }
        .filter-content::-webkit-scrollbar-thumb { background: #d1d5db; border-radius: 3px; }
        .filter-content::-webkit-scrollbar-thumb:hover { background: #9ca3af; }
        
        :root.dark-mode .filter-content::-webkit-scrollbar-thumb { background: #4a4a4a; }
        :root.dark-mode .filter-content::-webkit-scrollbar-thumb:hover { background: #5a5a5a; }
        
        .filter-section { padding: 15px 20px; }
        .filter-section.search-section { 
            background: var(--card-bg); 
            border-bottom: 2px solid var(--border-color); 
            padding: 20px;
        }
        
        .preview-search { margin-bottom: 0; }
        .preview-search label { 
            display: block; 
            font-size: 13px; 
            font-weight: 600; 
            color: var(--text-primary); 
            margin-bottom: 8px; 
        }
        .preview-search input { 
            width: 100%; 
            padding: 12px 16px; 
            border: 2px solid var(--border-color); 
            border-radius: 10px; 
            font-size: 14px; 
            transition: all 0.2s; 
            background: var(--bg-hover); 
        }
        .preview-search input:focus { 
            outline: none; 
            border-color: #4E6B52; 
            background: var(--card-bg); 
            box-shadow: 0 0 0 3px rgba(78, 107, 82, 0.1);
        }
        .preview-search input::placeholder {
            color: #9ca3af;
        }
        
        .type-quick-filters { display: flex; flex-direction: column; gap: 6px; margin-bottom: 0; }
        .type-filter-btn { 
            width: 100%;
            padding: 10px 14px; 
            border: 1px solid var(--border-color); 
            border-radius: 8px; 
            background: var(--card-bg); 
            color: var(--text-secondary); 
            font-size: 13px; 
            font-weight: 500;
            cursor: pointer; 
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 10px;
            text-align: left;
        }
        .type-filter-btn svg {
            display: none; /* Hide inline SVGs, using ::before now */
        }
        .type-filter-btn::before {
            content: '';
            width: 16px;
            height: 16px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            display: inline-block;
            flex-shrink: 0;
        }
        .type-filter-btn:hover { 
            background: var(--bg-hover); 
            border-color: #4E6B52;
            color: var(--text-primary);
        }
        .type-filter-btn.active { 
            background: #4E6B52; 
            border-color: #4E6B52; 
            color: white; 
        }
        
        /* Dark mode icon filters */
        :root.dark-mode body .type-filter-btn::before {
            filter: brightness(0) invert(1);
        }
        :root.dark-mode body .type-filter-btn:hover::before {
            filter: brightness(0) saturate(100%) invert(46%) sepia(14%) saturate(963%) hue-rotate(94deg) brightness(92%) contrast(88%);
        }
        :root.dark-mode body .type-filter-btn.active::before {
            filter: brightness(0) invert(1);
        }
        
        .preview-search { margin-bottom: 20px; }
        .preview-search label { display: block; font-size: 12px; font-weight: 600; color: var(--text-secondary); margin-bottom: 8px; }
        .preview-search input { width: 100%; padding: 12px 16px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 14px; transition: border-color 0.2s; background: var(--bg-hover); }
        .preview-search input:focus { outline: none; border-color: #4E6B52; background: var(--card-bg); }
        
        .preview-filter-group { display: flex; flex-direction: column; gap: 6px; margin-bottom: 12px; }
        .preview-filter-group label { font-size: 12px; font-weight: 600; color: var(--text-secondary); }
        .preview-filter-group select { width: 100%; padding: 9px 12px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 13px; background: var(--bg-hover); cursor: pointer; transition: all 0.2s; color: var(--text-primary); appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%236b7280' d='M6 9L1 4h10z'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 12px center; padding-right: 32px; }
        .preview-filter-group select:hover { border-color: #cbd5e1; background: var(--card-bg); }
        .preview-filter-group select:focus { outline: none; border-color: #4E6B52; background: var(--card-bg); }
        
        .preview-filters .btn { width: 100%; padding: 9px 16px; whitespace: nowrap; font-size: 13px; margin-top: 8px; }
        
        .preview-main { flex: 1; min-width: 0; padding: 0 30px 30px 30px; }
        .preview-results { margin-bottom: 20px; font-size: 14px; color: var(--text-secondary); font-weight: 500; }
        
        @media (max-width: 968px) {
            .preview-content-wrapper { flex-direction: column; }
            .preview-sidebar { width: 100%; position: static; }
        }
        
        .data-container { max-width: 1600px; margin: 0 auto; padding: 30px 20px; }
        .data-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; flex-wrap: wrap; gap: 15px; }
        .data-header h2 { font-size: 24px; color: var(--text-primary); }
        .data-actions { display: flex; gap: 10px; }
        .table-wrapper { background: var(--card-bg); border-radius: 12px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.08); overflow-x: auto; }
        .data-table { width: 100%; border-collapse: collapse; }
        .data-table thead { background: #1a1a1a; color: white; }
        .data-table th { padding: 14px 12px; text-align: left; font-size: 13px; font-weight: 600; white-space: nowrap; }
        .data-table tbody tr { border-bottom: 1px solid var(--border-color); transition: background 0.2s; }
        .data-table tbody tr:hover { background: var(--bg-hover); }
        .data-table td { padding: 12px; font-size: 13px; color: var(--text-primary); }
        .data-table td input, .data-table td textarea { width: 100%; padding: 6px 8px; border: 1px solid var(--border-color); border-radius: 4px; font-size: 13px; background: var(--bg-primary); color: var(--text-primary); }
        .data-table td input:focus, .data-table td textarea:focus { outline: none; border-color: #4E6B52; }
        .data-table td textarea { min-height: 60px; resize: vertical; }
        .data-table .cell-id { color: var(--text-secondary); font-weight: 600; }
        .data-table .cell-name { font-weight: 600; min-width: 150px; }
        .data-table .cell-type, .data-table .cell-area { min-width: 120px; }
        .data-table .cell-description { min-width: 250px; max-width: 350px; }
        .data-table .cell-image { min-width: 200px; }
        .data-table .cell-image input { font-size: 11px; }
        .data-table .cell-website { min-width: 250px; }
        .data-table .cell-phone { min-width: 140px; }
        .data-table .cell-address { min-width: 250px; }
        .data-table .cell-amenities { min-width: 200px; max-width: 300px; font-size: 12px; }
        .data-table .cell-amenities textarea { min-height: 50px; }
        .data-table .cell-featured { text-align: center; }
        .data-table .cell-actions { white-space: nowrap; }
        .data-table .btn-table-save { background: #4E6B52; color: white; padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; cursor: pointer; margin-right: 5px; }
        .data-table .btn-table-save:hover { background: #3d5440; }
        .data-table .btn-table-delete { background: #E3795C; color: white; padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; cursor: pointer; }
        .data-table .btn-table-delete:hover { background: #D65052; }
        
        .preview-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        
        .flip-card { perspective: 1000px; height: 400px; cursor: pointer; transition: transform 0.3s ease, box-shadow 0.3s ease, z-index 0s, position 0s, top 0s, left 0s, width 0s, height 0s; position: relative; }
        .flip-card:hover { transform: translateY(-8px); }
        .flip-card.flipped { 
            position: fixed;
            top: 5vh;
            left: 5vw;
            width: 90vw;
            height: 90vh;
            z-index: 1000;
            transform: none;
            transition: all 0.3s ease;
        }
        .flip-card-inner { position: relative; width: 100%; height: 100%; transition: transform 0.6s; transform-style: preserve-3d; }
        .flip-card.flipped .flip-card-inner { transform: rotateY(180deg); }
        .flip-card-front, .flip-card-back { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.1); transition: box-shadow 0.3s ease; }
        .flip-card:hover .flip-card-front, .flip-card:hover .flip-card-back { box-shadow: 0 12px 24px rgba(0,0,0,0.15); }
        .flip-card.flipped .flip-card-front, .flip-card.flipped .flip-card-back { box-shadow: 0 20px 40px rgba(0,0,0,0.3); }
        .flip-card-front { background: var(--card-bg); }
        .flip-card-back { background: var(--card-bg); transform: rotateY(180deg); padding: 30px; display: flex; flex-direction: column; overflow-y: auto; }
        
        /* Overlay behind flipped card */
        .flip-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 999;
            backdrop-filter: blur(4px);
        }
        .flip-overlay.active {
            display: block;
        }
        
        /* Back side image gallery */
        .flip-back-images {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .flip-back-image {
            flex: 1;
            height: 250px;
            border-radius: 8px;
            object-fit: cover;
        }
        
        /* Tags container on flip side */
        .flip-tags-container { margin: 15px 0; padding: 15px 0; border-top: 1px solid var(--border-color); border-bottom: 1px solid var(--border-color); }
        .flip-tags-title { font-size: 12px; font-weight: 600; color: var(--text-secondary); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px; }
        .flip-tags-list { display: flex; flex-wrap: wrap; gap: 6px; }
        
        /* Close button for flipped card */
        .flip-close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            background: rgba(0, 0, 0, 0.5);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            transition: background 0.3s;
        }
        .flip-close-btn:hover {
            background: rgba(0, 0, 0, 0.8);
        }
        
        .code-container { max-width: 1400px; margin: 0 auto; padding: 30px 20px; }
        .code-section { background: var(--card-bg); border-radius: 12px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .code-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .code-header h3 { font-size: 18px; color: var(--text-primary); }
        .btn-copy { padding: 8px 16px; font-size: 12px; }
        .code-section textarea { width: 100%; min-height: 200px; max-height: 400px; padding: 15px; border: 2px solid var(--border-color); border-radius: 8px; font-family: 'Courier New', monospace; font-size: 12px; resize: vertical; background: var(--bg-hover); color: var(--text-primary); }
        
        /* Deploy Tab Styles */
        .deploy-header { margin-bottom: 40px; }
        .deploy-header h2 { font-size: 28px; color: var(--text-primary); margin-bottom: 8px; }
        .deploy-steps { max-width: 900px; margin: 0 auto; }
        .deploy-step { display: flex; gap: 20px; margin-bottom: 35px; align-items: flex-start; }
        .deploy-step-number { 
            width: 48px; 
            height: 48px; 
            background: linear-gradient(135deg, #4E6B52 0%, #3d5440 100%);
            color: white; 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-size: 20px; 
            font-weight: 700;
            flex-shrink: 0;
            box-shadow: 0 4px 12px rgba(78, 107, 82, 0.3);
        }
        .deploy-step-content { flex: 1; }
        .deploy-step-content h3 { 
            font-size: 20px; 
            color: var(--text-primary); 
            margin-bottom: 12px;
            font-weight: 600;
        }
        .deploy-step-content p { 
            font-size: 15px; 
            color: var(--text-secondary); 
            line-height: 1.6; 
            margin-bottom: 12px;
        }
        .deploy-step-content ul { 
            margin: 12px 0; 
            padding-left: 20px;
        }
        .deploy-step-content li { 
            font-size: 14px; 
            color: var(--text-secondary); 
            line-height: 1.7; 
            margin-bottom: 8px;
        }
        .deploy-step-content strong {
            color: var(--text-primary);
            font-weight: 600;
        }
        .deploy-tips {
            background: var(--card-bg);
            border: 2px solid #4E6B52;
            border-radius: 12px;
            padding: 25px;
            margin-top: 40px;
            box-shadow: 0 4px 16px rgba(78, 107, 82, 0.1);
        }
        .deploy-tip-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            color: #4E6B52;
        }
        .deploy-tip-header h3 {
            font-size: 20px;
            margin: 0;
            font-weight: 600;
        }
        .deploy-tips ul {
            margin: 0;
            padding-left: 20px;
        }
        .deploy-tips li {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.8;
            margin-bottom: 12px;
        }
        .deploy-note {
            background: rgba(78, 107, 82, 0.1);
            border-left: 4px solid #4E6B52;
            border-radius: 8px;
            padding: 20px;
            margin-top: 30px;
            display: flex;
            align-items: flex-start;
            gap: 12px;
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.6;
        }
        .deploy-note strong {
            color: var(--text-primary);
        }
        
        :root.dark-mode .deploy-step-number {
            background: linear-gradient(135deg, #5a7d5f 0%, #4E6B52 100%);
        }
        :root.dark-mode .deploy-tips {
            border-color: #5a7d5f;
            background: #2a2a2a;
        }
        :root.dark-mode .deploy-tip-header {
            color: #6b9270;
        }
        :root.dark-mode .deploy-note {
            background: rgba(78, 107, 82, 0.15);
            border-left-color: #5a7d5f;
        }
        
        @media (max-width: 768px) {
            .form-row { grid-template-columns: 1fr; }
            .header-content { flex-direction: column; align-items: flex-start; }
            .tabs { overflow-x: auto; }
            .deploy-step { flex-direction: column; }
            .deploy-step-number { margin-bottom: 10px; }
        }
        
    </style>
</head>
<body>
    <!-- Google OAuth Login Overlay -->
    <div id="loginOverlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, #4E6B52 0%, #3a5240 100%); display: flex; align-items: center; justify-content: center; z-index: 10000;">
        <div style="background: white; padding: 40px; border-radius: 12px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); max-width: 400px; width: 90%;">
            <div style="text-align: center; margin-bottom: 30px;">
                <h2 style="color: #4E6B52; margin: 0 0 10px 0; font-size: 28px; display: flex; align-items: center; justify-content: center; gap: 8px;">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                        <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                    </svg>
                    Admin Login
                </h2>
                <p style="color: #6c757d; margin: 0; font-size: 14px;">Sign in with your Google account to access the admin panel</p>
            </div>
            
            <div id="g_id_onload" style="display: flex; justify-content: center; margin-bottom: 20px; min-height: 50px; align-items: center;"></div>
            
            <!-- Fallback manual button if Google's button doesn't load -->
            <div id="fallbackButtonContainer" style="display: none; margin-bottom: 20px;">
                <button onclick="triggerGoogleSignIn()" 
                        style="width: 100%; background: #4285f4; color: white; border: none; padding: 12px 24px; border-radius: 6px; font-size: 16px; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; transition: background 0.2s;"
                        onmouseover="this.style.background='#357ae8'" onmouseout="this.style.background='#4285f4'">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/>
                        <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/>
                        <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"/>
                        <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/>
                    </svg>
                    Sign in with Google
                </button>
            </div>
            
            <div id="loadingMessage" style="color: #6c757d; padding: 20px; text-align: center;">
                Loading sign-in button...
            </div>
            
            <!-- Always show a manual sign-in button as backup -->
            <div style="margin-top: 15px; margin-bottom: 20px;">
                <button onclick="triggerGoogleSignIn()" 
                        style="width: 100%; background: #4285f4; color: white; border: none; padding: 12px 24px; border-radius: 6px; font-size: 16px; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; transition: background 0.2s;"
                        onmouseover="this.style.background='#357ae8'" onmouseout="this.style.background='#4285f4'">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/>
                        <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/>
                        <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"/>
                        <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/>
                    </svg>
                    Sign in with Google (Backup)
                </button>
            </div>
            
            <div id="loginError" style="display: none; background: #f8d7da; color: #721c24; padding: 12px; border-radius: 6px; font-size: 14px; text-align: center; margin-bottom: 20px;">
                <span id="loginErrorText"></span>
            </div>
            
            <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #dee2e6; text-align: center;">
                <p style="color: #6c757d; font-size: 12px; margin: 0;">
                    <strong> Secure Authentication:</strong> Only authorized Google accounts can access this panel.<br>
                    <small style="color: #999;">Contact the administrator to request access.</small>
                </p>
            </div>
            
            <!-- Diagnostic/Test Section -->
            <div id="diagnosticSection" style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 6px; border: 1px solid #dee2e6; display: none;">
                <details style="cursor: pointer;">
                    <summary style="font-weight: 600; color: #4E6B52; margin-bottom: 10px;"> Diagnostic Information (Click to expand)</summary>
                    <div style="margin-top: 10px; font-family: monospace; font-size: 12px; text-align: left; background: white; padding: 10px; border-radius: 4px; overflow-x: auto;">
                        <div><strong>Current Domain:</strong> <span id="diagOrigin">-</span></div>
                        <div><strong>Client ID:</strong> <span id="diagClientId">-</span></div>
                        <div><strong>Google Script Loaded:</strong> <span id="diagGoogleLoaded">-</span></div>
                        <div><strong>Button Container:</strong> <span id="diagContainer">-</span></div>
                        <div><strong>Status:</strong> <span id="diagStatus">-</span></div>
                        <div style="margin-top: 10px;">
                            <button onclick="testGoogleSignIn()" style="background: #4285f4; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-size: 12px;">
                                Test Google Sign-In
                            </button>
                            <button onclick="checkOAuthConfig()" style="background: #34a853; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-size: 12px; margin-left: 8px;">
                                Check Configuration
                            </button>
                        </div>
                    </div>
                </details>
            </div>
        </div>
    </div>
    
    <div class="header">
        <div class="header-content">
            <div>
                <h1>Adventure Directory Admin</h1>
                <p>Manage listings with full CRUD operations</p>
            </div>
            <div class="header-buttons">
                <button class="btn btn-secondary" onclick="logout()" style="background: #dc3545; border-color: #dc3545;">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 6px;">
                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                        <polyline points="16 17 21 12 16 7"></polyline>
                        <line x1="21" y1="12" x2="9" y2="12"></line>
                    </svg>
                    Logout
                </button>
                <button class="btn btn-secondary" onclick="toggleDarkMode()" id="darkModeToggle">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 6px;">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    Dark Mode
                </button>
                <button class="btn btn-success" onclick="openAddModal()">+ Add New Listing</button>
            </div>
        </div>
        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('admin')">Admin</button>
            <button class="tab-btn" onclick="switchTab('data')">Data Table</button>
<<<<<<< HEAD
=======
            <button class="tab-btn" onclick="switchTab('settings')">Settings</button>
>>>>>>> a97840a205826fe60553800d5e750c1313343f6d
            <button class="tab-btn" onclick="switchTab('code')">Code</button>
            <button class="tab-btn" onclick="switchTab('preview')">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" style="width: 16px; height: 16px; margin-right: 6px;">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25" />
                </svg>
                Preview
            </button>
<<<<<<< HEAD
            <button class="tab-btn" onclick="switchTab('deploy')">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" style="width: 16px; height: 16px; margin-right: 6px;">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 16.5V9.75m0 0l3 3m-3-3l-3 3M6.75 19.5a4.5 4.5 0 01-1.41-8.775 5.25 5.25 0 0110.233-2.33 3 3 0 013.758 3.848A3.752 3.752 0 0118 19.5H6.75z" />
                </svg>
                Deploy
=======
            <button class="tab-btn" onclick="switchTab('learn')">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" style="width: 16px; height: 16px; margin-right: 6px;">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" />
                </svg>
                Learn
>>>>>>> a97840a205826fe60553800d5e750c1313343f6d
            </button>
        </div>
    </div>
    
    <div id="adminTab" class="tab-content active">
        <div class="stats">
            <div class="stat-card">
                <h3>Total Listings</h3>
                <p id="totalListings">15</p>
            </div>
            <div class="stat-card">
                <h3>Featured</h3>
                <p id="featuredCount">5</p>
            </div>
            <div class="stat-card">
                <h3>Areas Covered</h3>
                <p id="areasCount">6</p>
            </div>
            <div class="stat-card">
                <h3>Types</h3>
                <p id="typesCount">8</p>
            </div>
        </div>
        
        <!-- Google Sheets Status Section -->
        <div class="google-sheets-status-section" style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); padding: 20px; margin: 20px 0; border-radius: 8px; border-left: 4px solid #34a853; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
                <div>
                    <h3 style="margin: 0 0 5px 0; color: #34a853; display: flex; align-items: center; gap: 8px;">
                        <span></span> Google Sheets Integration
                    </h3>
                    <p style="margin: 0; color: #666; font-size: 14px;">All changes sync to your Google Sheet. Make sure your Apps Script is configured to accept JSON POST requests.</p>
                </div>
                <div id="sheetsStatusBadge" style="padding: 6px 12px; background: #34a853; color: white; border-radius: 20px; font-size: 12px; font-weight: 600; display: flex; align-items: center; gap: 6px;">
                    <span id="sheetsStatusIcon"></span>
                    <span id="sheetsStatusText">Connected</span>
                </div>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px; background: white; padding: 15px; border-radius: 6px;">
                <div>
                    <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #333;">Apps Script URL:</label>
                    <input type="text" id="sheetsScriptUrl" value="https://script.google.com/macros/s/AKfycbwNH8P5P8iorzRTTx3FpVbYPFNBo1qUWIU630v7ymLJWypvJpSEfPZC5nfxJpjjwjF-Jg/exec" readonly
                           style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-family: monospace; font-size: 11px; background: #f8f9fa; cursor: text;"
                           onclick="this.select();">
                    <small style="color: #666;">Click to copy</small>
                </div>
                
                <div>
                    <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #333;">Last Sync:</label>
                    <div id="lastSyncTime" style="padding: 8px; border: 1px solid #ddd; border-radius: 4px; background: #f8f9fa; color: #666;">
                        Loading...
                    </div>
                </div>
            </div>
            
            <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                <button onclick="reloadFromSheets()" 
                        style="background: #4285f4; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; font-weight: 600; display: flex; align-items: center; gap: 6px;">
                    <span></span> Reload from Google Sheets
                </button>
                <button onclick="saveAllToSheets()"
                        style="background: #34a853; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; font-weight: 600; display: flex; align-items: center; gap: 6px;">
                    <span></span> Save All to Google Sheets
                </button>
<<<<<<< HEAD
                <button onclick="downloadJSON()"
                        style="background: #4E6B52; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; font-weight: 600; display: flex; align-items: center; gap: 6px;">
                    <span></span> Download JSON Backup
=======
                <button onclick="downloadCSV()"
                        style="background: #4E6B52; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; font-weight: 600; display: flex; align-items: center; gap: 6px;">
                    <span></span> Download CSV Backup
>>>>>>> a97840a205826fe60553800d5e750c1313343f6d
                </button>
                <div id="sheetsActionStatus" style="margin-left: auto; font-weight: 600; color: #34a853;"></div>
            </div>
        </div>
        
        <div class="preview-container">
            <div class="preview-content-wrapper">
                <aside class="preview-sidebar">
                    <div class="preview-filters">
                        <h3>Filters</h3>
                        
                        <div class="filter-content">
                            <div class="filter-section search-section">
                                <div class="preview-search">
                                    <label>Search Listings</label>
                                    <input type="text" id="adminSearchInput" placeholder="Search by name, type, area, or description..." onkeyup="filterListings()" />
                                </div>
                            </div>
                            
                            <div class="filter-section">
                                <div class="type-quick-filters">
                                    <button class="type-filter-btn active" data-type="" onclick="filterAdminByType('')">
                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
                                        </svg>
                                        All Types
                                    </button>
                                    <button class="type-filter-btn" data-type="Brewery" onclick="filterAdminByType('Brewery')">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M6 18h12v2H6zm1-14h10l1 10H6z"/>
                                            <path d="M9 6v8m3-8v8m3-8v8"/>
                                        </svg>
                                        Brewery
                                    </button>
                                    <button class="type-filter-btn" data-type="Winery" onclick="filterAdminByType('Winery')">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M8 2v7c0 4 2 7 4 7s4-3 4-7V2"/>
                                            <path d="M6 8h12"/>
                                            <path d="M12 16v6"/>
                                            <circle cx="12" cy="22" r="1"/>
                                        </svg>
                                        Winery
                                    </button>
                                    <button class="type-filter-btn" data-type="Hiking" onclick="filterAdminByType('Hiking')">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M6 20h4c1 0 2-1 2-2V8c0-1-1-2-2-2H6c-1 0-2 1-2 2v10c0 1 1 2 2 2z"/>
                                            <path d="M14 20h4c1 0 2-1 2-2V8c0-1-1-2-2-2h-4c-1 0-2 1-2 2v10c0 1 1 2 2 2z"/>
                                            <path d="M6 8h4m8 0h4M10 2v4m4-4v4"/>
                                        </svg>
                                        Hiking
                                    </button>
                                    <button class="type-filter-btn" data-type="Restaurant" onclick="filterAdminByType('Restaurant')">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M3 2v7c0 1.1.9 2 2 2h0v11h2V11h0c1.1 0 2-.9 2-2V2M17 2v11h2V2M15 8h6M17 22v-9"/>
                                        </svg>
                                        Restaurant
                                    </button>
                                    <button class="type-filter-btn" data-type="Lodging" onclick="filterAdminByType('Lodging')">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/>
                                            <path d="M9 22V12h6v10"/>
                                        </svg>
                                        Lodging
                                    </button>
                                    <button class="type-filter-btn" data-type="Activity" onclick="filterAdminByType('Activity')">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <circle cx="12" cy="5" r="2"/>
                                            <path d="M10 22v-8m0 0l-2-2m2 2l2-2"/>
                                            <path d="M7 12l3-3 3 1 4-4"/>
                                            <path d="M17 8l2 2"/>
                                        </svg>
                                        Activity
                                    </button>
                                </div>
                            </div>
                            
                            <div class="filter-section">
                                <div class="preview-filter-group">
                                    <label>Area</label>
                                    <select id="adminAreaFilter" onchange="filterListings()">
                                        <option value="">All Areas</option>
                                    </select>
                                </div>
                                
                                <div class="preview-filter-group">
                                    <label>Amenities</label>
                                    <select id="adminAmenityFilter" onchange="filterListings()">
                                        <option value="">All Amenities</option>
                                    </select>
                                </div>
                                
                                <button class="btn btn-secondary" onclick="clearAdminFilters()">Clear Filters</button>
                            </div>
                        </div>
                    </div>
                </aside>
                
                <main class="preview-main">
                    <h2 class="section-title">All Listings</h2>
                    <div id="listingsGrid" class="listings-grid"></div>
                </main>
            </div>
        </div>
    </div>
    
    <div id="previewTab" class="tab-content">
        <div class="preview-controls">
            <button class="back-to-admin" onclick="switchTab('admin')">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18" />
                </svg>
                Back to Admin
            </button>
            <button class="preview-dark-toggle" onclick="toggleDarkMode()" id="previewDarkToggle">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                </svg>
            </button>
        </div>
        <div class="preview-container">
            <div class="preview-content-wrapper">
                <aside class="preview-sidebar">
                    <div class="preview-filters">
                        <h3>Filters</h3>
                        
                        <div class="filter-content">
                            <div class="filter-section search-section">
                                <div class="preview-search">
                                    <label>Search Listings</label>
                                    <input type="text" id="previewSearchInput" placeholder="Search by name, type, area, or description..." onkeyup="filterPreview()" />
                                </div>
                            </div>
                            
                            <div class="filter-section">
                                <div class="type-quick-filters">
                                    <button class="type-filter-btn active" data-type="">
                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
                                        </svg>
                                        All Types
                                    </button>
                                    <button class="type-filter-btn" data-type="Brewery">
                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z" />
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 13.5a3 3 0 100-6 3 3 0 000 6z" />
                                        </svg>
                                        Brewery
                                    </button>
                                    <button class="type-filter-btn" data-type="Winery">
                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25z" />
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6l4 2" />
                                        </svg>
                                        Winery
                                    </button>
                                    <button class="type-filter-btn" data-type="Hiking">
                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75z" />
                                        </svg>
                                        Hiking
                                    </button>
                                    <button class="type-filter-btn" data-type="Restaurant">
                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                                        </svg>
                                        Restaurant
                                    </button>
                                    <button class="type-filter-btn" data-type="Lodging">
                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" />
                                        </svg>
                                        Lodging
                                    </button>
                                    <button class="type-filter-btn" data-type="Activity">
                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.894 20.567L16.5 21.75l-.394-1.183a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 001.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 001.423 1.423l1.183.394-1.183.394a2.25 2.25 0 00-1.423 1.423z" />
                                        </svg>
                                        Activity
                                    </button>
                                </div>
                            </div>
                            
                            <div class="filter-section">
                                <div class="preview-filter-group">
                                    <label>Area</label>
                                    <select id="previewAreaFilter" onchange="filterPreview()">
                                        <option value="">All Areas</option>
                                    </select>
                                </div>
                                
                                <div class="preview-filter-group">
                                    <label>Amenities</label>
                                    <select id="previewAmenityFilter" onchange="filterPreview()">
                                        <option value="">All Amenities</option>
                                    </select>
                                </div>
                                
                                <button class="btn btn-secondary" onclick="clearPreviewFilters()">Clear Filters</button>
                            </div>
                        </div>
                        
                        <div class="theme-toggle-container">
                            <div class="theme-toggle-wrapper">
                                <label class="theme-toggle-label">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z" />
                                    </svg>
                                    Dark Mode
                                </label>
                                <label class="theme-switch">
                                    <input type="checkbox" id="darkModeToggle" onchange="toggleDarkMode()">
                                    <span class="theme-slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </aside>
                
                <main class="preview-main">
                    <div class="preview-header">
                        <h1>Explore Nelson County Adventures</h1>
                        <p>Discover breweries, wineries, hiking trails, and outdoor activities</p>
                    </div>
                    
                    <div class="preview-results">
                        <span id="previewResultsCount">Showing 15 listings</span>
                    </div>
                    
                    <div id="previewGrid" class="preview-grid"></div>
                    
                    <!-- Overlay for flipped cards -->
                    <div id="flipOverlay" class="flip-overlay" onclick="closeAllFlippedCards()"></div>
                </main>
            </div>
        </div>
    </div>
    
    <div id="dataTab" class="tab-content">
        <div class="data-container">
            <div class="data-header">
                <h2>Data Table</h2>
                <div class="data-actions">
                    <input type="file" id="csvUpload" accept=".csv" style="display: none;" onchange="handleCSVUpload(event)" />
                    <button class="btn btn-primary" onclick="document.getElementById('csvUpload').click()">Upload CSV</button>
                    <button class="btn btn-success" onclick="downloadCSV()">Download CSV</button>
                    <button class="btn btn-success" onclick="saveTableChanges()" style="background: #4E6B52;">Update Table</button>
                </div>
            </div>
            <div class="table-wrapper">
                <table id="dataTable" class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Name</th>
                            <th>Type</th>
                            <th>Area</th>
                            <th>Description</th>
                            <th>Image 1</th>
                            <th>Image 2</th>
                            <th>Website</th>
                            <th>Phone</th>
                            <th>Address</th>
                            <th>Amenities</th>
                            <th>Featured</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="dataTableBody">
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
<<<<<<< HEAD
=======
    <div id="settingsTab" class="tab-content">
        <div class="settings-container" style="max-width: 1200px; margin: 0 auto; padding: 20px;">
            <div style="margin-bottom: 30px;">
                <h2 style="margin: 0 0 10px 0; color: #212529;">Field Configuration</h2>
                <p style="color: #6c757d; margin: 0;">Manage the options available in the Add/Edit listing form. Changes are saved automatically.</p>
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px;">
                <!-- Types Section -->
                <div class="settings-card" style="background: white; border: 1px solid #dee2e6; border-radius: 8px; padding: 20px;">
                    <h3 style="margin: 0 0 15px 0; color: #212529; font-size: 18px;">Types</h3>
                    <p style="color: #6c757d; font-size: 14px; margin: 0 0 15px 0;">Options for the "Type" dropdown in the listing form</p>
                    <div id="typesList" style="margin-bottom: 15px; max-height: 300px; overflow-y: auto;">
                        <!-- Types will be rendered here -->
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <input type="text" id="newTypeInput" placeholder="Add new type..." style="flex: 1; padding: 8px; border: 1px solid #dee2e6; border-radius: 4px;" onkeypress="if(event.key==='Enter') addType()" />
                        <button onclick="addType()" class="btn btn-success" style="padding: 8px 16px;">Add</button>
                    </div>
                </div>
                
                <!-- Areas Section -->
                <div class="settings-card" style="background: white; border: 1px solid #dee2e6; border-radius: 8px; padding: 20px;">
                    <h3 style="margin: 0 0 15px 0; color: #212529; font-size: 18px;">Areas</h3>
                    <p style="color: #6c757d; font-size: 14px; margin: 0 0 15px 0;">Options for the "Area" dropdown in the listing form</p>
                    <div id="areasList" style="margin-bottom: 15px; max-height: 300px; overflow-y: auto;">
                        <!-- Areas will be rendered here -->
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <input type="text" id="newAreaInput" placeholder="Add new area..." style="flex: 1; padding: 8px; border: 1px solid #dee2e6; border-radius: 4px;" onkeypress="if(event.key==='Enter') addArea()" />
                        <button onclick="addArea()" class="btn btn-success" style="padding: 8px 16px;">Add</button>
                    </div>
                </div>
                
                <!-- Amenities Section -->
                <div class="settings-card" style="background: white; border: 1px solid #dee2e6; border-radius: 8px; padding: 20px; grid-column: 1 / -1;">
                    <h3 style="margin: 0 0 15px 0; color: #212529; font-size: 18px;">Amenities</h3>
                    <p style="color: #6c757d; font-size: 14px; margin: 0 0 15px 0;">Options for the "Amenities" checkboxes in the listing form</p>
                    <div id="amenitiesList" style="margin-bottom: 15px; max-height: 300px; overflow-y: auto; display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px;">
                        <!-- Amenities will be rendered here -->
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <input type="text" id="newAmenityInput" placeholder="Add new amenity..." style="flex: 1; padding: 8px; border: 1px solid #dee2e6; border-radius: 4px;" onkeypress="if(event.key==='Enter') addAmenity()" />
                        <button onclick="addAmenity()" class="btn btn-success" style="padding: 8px 16px;">Add</button>
                    </div>
                </div>
            </div>
            
            <div style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #4E6B52;">
                <p style="margin: 0; color: #6c757d;">
                    <strong>Note:</strong> Changes are saved automatically. The form dropdowns and checkboxes will update immediately after you add or remove items.
                </p>
            </div>
        </div>
    </div>
    
>>>>>>> a97840a205826fe60553800d5e750c1313343f6d
    <div id="codeTab" class="tab-content">
        <div class="code-container">
            <div class="code-section">
                <div class="code-header">
                    <h3>Embed Code</h3>
                    <button class="btn btn-secondary btn-copy" onclick="copyCode('embed')">Copy</button>
                </div>
                <textarea id="embedCode" readonly></textarea>
            </div>
            
            <div class="code-section">
                <div class="code-header">
                    <h3>JSON Data</h3>
                    <button class="btn btn-secondary btn-copy" onclick="copyCode('json')">Copy</button>
                </div>
                <textarea id="jsonCode" readonly></textarea>
            </div>
            
            <div class="code-section">
                <div class="code-header">
                    <h3>CSS Styles</h3>
                    <button class="btn btn-secondary btn-copy" onclick="copyCode('css')">Copy</button>
                </div>
                <textarea id="cssCode" readonly></textarea>
            </div>
            
            <div class="code-section">
                <div class="code-header">
                    <h3>JavaScript</h3>
                    <button class="btn btn-secondary btn-copy" onclick="copyCode('js')">Copy</button>
                </div>
                <textarea id="jsCode" readonly></textarea>
            </div>
        </div>
    </div>
    
<<<<<<< HEAD
    <div id="deployTab" class="tab-content">
        <div class="data-container">
            <div class="deploy-header">
                <h2>Deploy to Squarespace</h2>
                <p style="color: var(--text-secondary); margin-top: 10px;">Follow these simple steps to add your adventure directory to your Squarespace website</p>
            </div>
            
            <div class="deploy-steps">
                <div class="deploy-step">
                    <div class="deploy-step-number">1</div>
                    <div class="deploy-step-content">
                        <h3>Create a Code Block</h3>
                        <p>In your Squarespace page editor, add a <strong>Code Block</strong> where you want the directory to appear:</p>
                        <ul>
                            <li>Click the <strong>+</strong> button to add a new block</li>
                            <li>Search for "Code" and select the <strong>Code</strong> block</li>
                            <li>This is where you'll paste your embed code</li>
                        </ul>
=======
    <div id="learnTab" class="tab-content">
        <div class="data-container" style="max-width: 1000px; margin: 0 auto;">
            <div class="deploy-header">
                <h2>How the System Works</h2>
                <p style="color: var(--text-secondary); margin-top: 10px;">Understanding the complete workflow from Admin Panel to Google Sheets to Framer CMS</p>
            </div>
            
            <!-- System Overview -->
            <div style="background: linear-gradient(135deg, #4E6B52 0%, #3d5540 100%); color: white; padding: 30px; border-radius: 12px; margin-bottom: 40px;">
                <h2 style="color: white; margin: 0 0 15px 0; font-size: 28px;">System Architecture Overview</h2>
                <p style="color: rgba(255,255,255,0.9); margin: 0; line-height: 1.8; font-size: 16px;">
                    This system connects <strong>4 main components</strong> to create a seamless content management workflow:
                    <strong>Admin Panel</strong>  <strong>Google Sheets</strong>  <strong>Framer CMS</strong>  <strong>Live Website</strong>
                </p>
            </div>
            
            <!-- Workflow Diagram Section -->
            <div class="deploy-steps">
                <div class="deploy-step">
                    <div class="deploy-step-number" style="background: linear-gradient(135deg, #4E6B52 0%, #3d5540 100%);">1</div>
                    <div class="deploy-step-content">
                        <h3>Admin Panel (This Interface)</h3>
                        <p><strong>What it is:</strong> Your local content management system where you create and edit listings.</p>
                        <ul>
                            <li><strong>Add/Edit Listings:</strong> Use the Admin tab to create new listings or modify existing ones</li>
                            <li><strong>Bulk Editing:</strong> Use the Data Table tab for spreadsheet-style editing</li>
                            <li><strong>Field Configuration:</strong> Use the Settings tab to customize Types, Areas, and Amenities</li>
                            <li><strong>Local Storage:</strong> Changes are saved in your browser's local storage (not synced yet)</li>
                        </ul>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #4E6B52;">
                            <strong> Key Point:</strong> This is where you do all your content work. Changes here are local until you sync to Google Sheets.
                        </div>
>>>>>>> a97840a205826fe60553800d5e750c1313343f6d
                    </div>
                </div>
                
                <div class="deploy-step">
<<<<<<< HEAD
                    <div class="deploy-step-number">2</div>
                    <div class="deploy-step-content">
                        <h3>Copy the Embed Code</h3>
                        <p>Go to the <strong>Code</strong> tab above and copy the full <strong>Embed Code</strong>. This includes:</p>
                        <ul>
                            <li>All HTML structure for your listings</li>
                            <li>Complete CSS styling (light & dark mode)</li>
                            <li>Interactive JavaScript functionality</li>
                            <li>Your data embedded in JSON format</li>
                        </ul>
                        <button class="btn btn-primary" onclick="switchTab('code')" style="margin-top: 12px;">
                            Go to Code Tab 
                        </button>
=======
                    <div class="deploy-step-number" style="background: linear-gradient(135deg, #34a853 0%, #2d8f47 100%);">2</div>
                    <div class="deploy-step-content">
                        <h3>Google Sheets (Data Storage)</h3>
                        <p><strong>What it is:</strong> Your centralized database hosted in Google Sheets, accessible via Google Apps Script.</p>
                        <ul>
                            <li><strong>Sync Button:</strong> Click "Save All to Google Sheets" to upload your local changes</li>
                            <li><strong>Auto-Sync:</strong> The system automatically loads data from Sheets when you open the admin panel</li>
                            <li><strong>Google Apps Script:</strong> Acts as an API bridge between this admin panel and your Google Sheet</li>
                            <li><strong>Backup:</strong> Always download a CSV backup before syncing to avoid data loss</li>
                        </ul>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #34a853;">
                            <strong> Key Point:</strong> Google Sheets is your "source of truth" - it's where Framer CMS will pull data from.
                        </div>
                        <div style="background: #fff3cd; padding: 12px; border-radius: 8px; margin-top: 12px; border-left: 4px solid #ffc107;">
                            <strong> Important:</strong> Make sure your Google Apps Script is deployed with "Anyone" access and reads from <code>e.postData.contents</code> for CORS to work properly.
                        </div>
>>>>>>> a97840a205826fe60553800d5e750c1313343f6d
                    </div>
                </div>
                
                <div class="deploy-step">
<<<<<<< HEAD
                    <div class="deploy-step-number">3</div>
                    <div class="deploy-step-content">
                        <h3>Paste into Code Block</h3>
                        <p>Back in Squarespace, paste the embed code into the Code Block:</p>
                        <ul>
                            <li>Click inside the Code Block</li>
                            <li>Set the display mode to <strong>HTML</strong></li>
                            <li>Paste the entire embed code you copied</li>
                            <li>Click <strong>Apply</strong></li>
                        </ul>
=======
                    <div class="deploy-step-number" style="background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);">3</div>
                    <div class="deploy-step-content">
                        <h3>Framer CMS Integration</h3>
                        <p><strong>What it is:</strong> Framer's CMS system that connects to your Google Sheet to display listings on your website.</p>
                        <ul>
                            <li><strong>CMS Collection:</strong> Set up a CMS collection in Framer that pulls from your Google Sheet</li>
                            <li><strong>Auto-Refresh:</strong> Framer periodically checks your Google Sheet for updates</li>
                            <li><strong>Real-time Updates:</strong> When you sync from Admin Panel  Google Sheets, Framer will see the changes</li>
                            <li><strong>No Code Deployment:</strong> Unlike Squarespace, you don't need to replace code blocks</li>
                        </ul>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #6366f1;">
                            <strong> Key Point:</strong> Once configured, Framer automatically displays whatever is in your Google Sheet - no manual code updates needed!
                        </div>
                        <div style="background: #e0e7ff; padding: 15px; border-radius: 8px; margin-top: 15px;">
                            <h4 style="margin: 0 0 10px 0; color: #4f46e5;">Setting Up Framer CMS:</h4>
                            <ol style="margin: 0; padding-left: 20px;">
                                <li>In Framer, go to <strong>CMS</strong>  <strong>Add Collection</strong></li>
                                <li>Choose <strong>"Google Sheets"</strong> as your data source</li>
                                <li>Connect to your Google Sheet (the same one connected to Apps Script)</li>
                                <li>Map the columns to CMS fields (Name, Type, Area, Description, etc.)</li>
                                <li>Design your listing cards using the CMS data</li>
                            </ol>
                        </div>
>>>>>>> a97840a205826fe60553800d5e750c1313343f6d
                    </div>
                </div>
                
                <div class="deploy-step">
<<<<<<< HEAD
                    <div class="deploy-step-number">4</div>
                    <div class="deploy-step-content">
                        <h3>Adjust Block Settings (Optional)</h3>
                        <p>Fine-tune the appearance in Squarespace:</p>
                        <ul>
                            <li><strong>Width:</strong> Set to "Full" for best results</li>
                            <li><strong>Spacing:</strong> Adjust top/bottom padding as needed</li>
                            <li><strong>Background:</strong> The directory has its own styling, so keep the block background transparent</li>
                        </ul>
                    </div>
                </div>
                
                <div class="deploy-step">
                    <div class="deploy-step-number">5</div>
                    <div class="deploy-step-content">
                        <h3>Save & Publish</h3>
                        <p>Preview your page and publish when ready:</p>
                        <ul>
                            <li>Click <strong>Save</strong> at the top of the page editor</li>
                            <li>Use the <strong>Preview</strong> button to see how it looks</li>
                            <li>When satisfied, click <strong>Publish</strong></li>
                        </ul>
                    </div>
                </div>
                
                <div class="deploy-tips">
                    <div class="deploy-tip-header">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" style="width: 24px; height: 24px; margin-right: 12px;">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 18v-5.25m0 0a6.01 6.01 0 001.5-.189m-1.5.189a6.01 6.01 0 01-1.5-.189m3.75 7.478a12.06 12.06 0 01-4.5 0m3.75 2.383a14.406 14.406 0 01-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 10-7.517 0c.85.493 1.509 1.333 1.509 2.316V18" />
                        </svg>
                        <h3>Pro Tips</h3>
                    </div>
                    <ul>
                        <li><strong>Mobile Responsive:</strong> The directory automatically adapts to all screen sizes</li>
                        <li><strong>Dark Mode:</strong> Visitors can toggle between light and dark themes using the switch in the sidebar</li>
                        <li><strong>Updates:</strong> To update your listings, edit the data in the Data Table tab, then copy the new embed code and replace it in Squarespace</li>
                        <li><strong>Multiple Pages:</strong> You can add the directory to multiple pages - just paste the code wherever needed</li>
                        <li><strong>Custom Styling:</strong> If you want to adjust colors or fonts, modify the CSS in the Code tab before copying</li>
                    </ul>
                </div>
                
                <div class="deploy-note">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" style="width: 20px; height: 20px; margin-right: 10px; flex-shrink: 0;">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z" />
                    </svg>
                    <div>
                        <strong>Note:</strong> Squarespace Code Blocks require a Business plan or higher. If you don't see the Code block option, you may need to upgrade your plan.
                    </div>
                </div>
                
                <!-- Update Workflow Section -->
=======
                    <div class="deploy-step-number" style="background: linear-gradient(135deg, #D65052 0%, #b84446 100%);">4</div>
                    <div class="deploy-step-content">
                        <h3>Live Website</h3>
                        <p><strong>What it is:</strong> Your published Framer site that visitors see.</p>
                        <ul>
                            <li><strong>Automatic Updates:</strong> When Framer CMS refreshes, your live site updates automatically</li>
                            <li><strong>No Downtime:</strong> Changes appear seamlessly without site downtime</li>
                            <li><strong>Preview Mode:</strong> Test changes in Framer's preview before publishing</li>
                            <li><strong>Publishing:</strong> Once you publish in Framer, changes go live immediately</li>
                        </ul>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #D65052;">
                            <strong> Key Point:</strong> The live site is the final destination - it automatically reflects what's in your Google Sheet via Framer CMS.
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Complete Workflow Section -->
            <div style="margin-top: 60px; padding-top: 40px; border-top: 2px solid var(--border-color);">
                <div class="deploy-header" style="margin-bottom: 30px;">
                    <h2 style="display: flex; align-items: center; gap: 12px;">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" style="width: 32px; height: 32px; color: #4E6B52;">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75z" />
                        </svg>
                        Complete Workflow: Making Changes
                    </h2>
                    <p style="color: var(--text-secondary); margin-top: 10px;">Follow these steps whenever you want to update your listings</p>
                </div>
                
                <div class="deploy-steps">
                    <div class="deploy-step">
                        <div class="deploy-step-number" style="background: linear-gradient(135deg, #4E6B52 0%, #3d5540 100%);">1</div>
                        <div class="deploy-step-content">
                            <h3>Edit in Admin Panel</h3>
                            <p>Make your changes here:</p>
                            <ul>
                                <li>Open this admin panel HTML file in your browser</li>
                                <li>Go to <strong>Admin</strong> tab to add/edit individual listings</li>
                                <li>Or use <strong>Data Table</strong> tab for bulk editing</li>
                                <li>Use <strong>Settings</strong> tab to manage form fields (Types, Areas, Amenities)</li>
                            </ul>
                            <p style="margin-top: 12px; padding: 12px; background: #f0f9ff; border-left: 4px solid #0ea5e9; border-radius: 4px;">
                                <strong> Note:</strong> Changes are saved locally in your browser. They won't appear on your website until you sync to Google Sheets.
                            </p>
                        </div>
                    </div>
                    
                    <div class="deploy-step">
                        <div class="deploy-step-number" style="background: linear-gradient(135deg, #34a853 0%, #2d8f47 100%);">2</div>
                        <div class="deploy-step-content">
                            <h3>Sync to Google Sheets</h3>
                            <p>Push your changes to the cloud:</p>
                            <ul>
                                <li>Click <strong>"Save All to Google Sheets"</strong> button (top of Admin tab)</li>
                                <li>You'll be prompted to download a CSV backup first (recommended!)</li>
                                <li>Confirm the sync - this replaces all data in your Google Sheet</li>
                                <li>Wait for the success message: " Replaced all data in Google Sheets"</li>
                            </ul>
                            <div style="background: #fff3cd; padding: 12px; border-radius: 8px; margin-top: 12px; border-left: 4px solid #ffc107;">
                                <strong> Important:</strong> This step overwrites your Google Sheet. Always download a backup first if you're unsure!
                            </div>
                        </div>
                    </div>
                    
                    <div class="deploy-step">
                        <div class="deploy-step-number" style="background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);">3</div>
                        <div class="deploy-step-content">
                            <h3>Framer CMS Auto-Refresh</h3>
                            <p>Framer automatically picks up the changes:</p>
                            <ul>
                                <li>Framer CMS checks your Google Sheet periodically (usually every few minutes)</li>
                                <li>When it detects changes, it automatically updates the CMS collection</li>
                                <li>You can manually refresh in Framer: <strong>CMS</strong>  <strong>Refresh Collection</strong></li>
                                <li>Preview your changes in Framer's preview mode</li>
                            </ul>
                            <div style="background: #e0e7ff; padding: 12px; border-radius: 8px; margin-top: 12px; border-left: 4px solid #6366f1;">
                                <strong> Tip:</strong> If changes don't appear immediately, try manually refreshing the CMS collection in Framer.
                            </div>
                        </div>
                    </div>
                    
                    <div class="deploy-step">
                        <div class="deploy-step-number" style="background: linear-gradient(135deg, #D65052 0%, #b84446 100%);">4</div>
                        <div class="deploy-step-content">
                            <h3>Publish in Framer</h3>
                            <p>Make changes live on your website:</p>
                            <ul>
                                <li>Review your changes in Framer's preview</li>
                                <li>Click <strong>Publish</strong> in Framer</li>
                                <li>Changes go live immediately on your website</li>
                                <li>No code editing needed - it's all automatic!</li>
                            </ul>
                            <div style="background: #fee2e2; padding: 12px; border-radius: 8px; margin-top: 12px; border-left: 4px solid #D65052;">
                                <strong> That's it!</strong> Your workflow is complete: Admin Panel  Google Sheets  Framer CMS  Live Site
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Important Information Section -->
            <div style="margin-top: 60px; padding-top: 40px; border-top: 2px solid var(--border-color);">
                <div class="deploy-header" style="margin-bottom: 30px;">
                    <h2 style="display: flex; align-items: center; gap: 12px;">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" style="width: 32px; height: 32px; color: #4E6B52;">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z" />
                        </svg>
                        Important Things to Know
                    </h2>
                </div>
                
                <div class="deploy-steps">
                    <div class="deploy-step">
                        <div class="deploy-step-number" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);"></div>
                        <div class="deploy-step-content">
                            <h3>Data Safety & Backups</h3>
                            <ul>
                                <li><strong>Always Backup First:</strong> Download CSV backup before syncing to Google Sheets</li>
                                <li><strong>Local Storage:</strong> Your changes are saved locally in your browser - they persist between sessions on the same computer</li>
                                <li><strong>Google Sheets is Source of Truth:</strong> Once synced, Google Sheets becomes the authoritative data source</li>
                                <li><strong>Multiple Devices:</strong> If you use this admin panel on different computers, sync to Google Sheets to share data</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="deploy-step">
                        <div class="deploy-step-number" style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);"></div>
                        <div class="deploy-step-content">
                            <h3>Google Apps Script Configuration</h3>
                            <p>Your Apps Script must be properly configured:</p>
                            <ul>
                                <li><strong>Deployment:</strong> Must be deployed as a "Web app" with "Anyone" access</li>
                                <li><strong>CORS:</strong> Script must read from <code>e.postData.contents</code> (not <code>e.parameter.data</code>)</li>
                                <li><strong>URL:</strong> Copy the deployment URL and paste it in the admin panel configuration</li>
                                <li><strong>New Deployments:</strong> If you update the script, create a new deployment (don't just update)</li>
                            </ul>
                            <div style="background: #f3f4f6; padding: 12px; border-radius: 8px; margin-top: 12px;">
                                <strong>Script File:</strong> See <code>nelson-county-apps-script.gs</code> for the complete, ready-to-use script.
                            </div>
                        </div>
                    </div>
                    
                    <div class="deploy-step">
                        <div class="deploy-step-number" style="background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);"></div>
                        <div class="deploy-step-content">
                            <h3>Google Sheet Structure</h3>
                            <p>Your Google Sheet should have these columns (in any order):</p>
                            <ul>
                                <li><strong>id</strong> - Unique identifier for each listing</li>
                                <li><strong>name</strong> - Listing name/title</li>
                                <li><strong>type</strong> - Category (Brewery, Winery, etc.)</li>
                                <li><strong>area</strong> - Location area</li>
                                <li><strong>description</strong> - Full description text</li>
                                <li><strong>image1</strong> - Primary image URL</li>
                                <li><strong>image2</strong> - Secondary image URL (optional)</li>
                                <li><strong>website</strong> - External website URL</li>
                                <li><strong>phone</strong> - Contact phone number</li>
                                <li><strong>address</strong> - Physical address</li>
                                <li><strong>amenities</strong> - Comma or semicolon-separated list</li>
                                <li><strong>featured</strong> - TRUE or FALSE</li>
                            </ul>
                            <div style="background: #f0fdf4; padding: 12px; border-radius: 8px; margin-top: 12px; border-left: 4px solid #22c55e;">
                                <strong> Tip:</strong> The Apps Script automatically handles different column orders and missing fields.
                            </div>
                        </div>
                    </div>
                    
                    <div class="deploy-step">
                        <div class="deploy-step-number" style="background: linear-gradient(135deg, #ec4899 0%, #db2777 100%);"></div>
                        <div class="deploy-step-content">
                            <h3>Framer CMS Setup Tips</h3>
                            <ul>
                                <li><strong>Sheet Sharing:</strong> Make sure your Google Sheet is shared (view access) or published</li>
                                <li><strong>Column Names:</strong> Framer CMS will automatically detect column names from your sheet header row</li>
                                <li><strong>Refresh Rate:</strong> Framer checks for updates every few minutes - you can manually refresh</li>
                                <li><strong>Data Types:</strong> Framer will auto-detect data types (text, number, image URL, etc.)</li>
                                <li><strong>Multiple Collections:</strong> You can create separate CMS collections for different views/filters</li>
                            </ul>
                            <div style="background: #fce7f3; padding: 12px; border-radius: 8px; margin-top: 12px; border-left: 4px solid #ec4899;">
                                <strong> Pro Tip:</strong> Use Framer's CMS filtering and sorting features to create dynamic, filtered views without additional code.
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Troubleshooting Section -->
>>>>>>> a97840a205826fe60553800d5e750c1313343f6d
                <div style="margin-top: 60px; padding-top: 40px; border-top: 2px solid var(--border-color);">
                    <div class="deploy-header" style="margin-bottom: 30px;">
                        <h2 style="display: flex; align-items: center; gap: 12px;">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" style="width: 32px; height: 32px; color: #4E6B52;">
<<<<<<< HEAD
                                <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99" />
                            </svg>
                            How to Update Your Listings
                        </h2>
                        <p style="color: var(--text-secondary); margin-top: 10px;">This admin panel makes it easy to manage your content, but updates require re-deploying the code to Squarespace</p>
                    </div>
                    
                    <div class="deploy-steps">
                        <div class="deploy-step">
                            <div class="deploy-step-number" style="background: linear-gradient(135deg, #D65052 0%, #b84446 100%);">1</div>
                            <div class="deploy-step-content">
                                <h3>Make Changes in the Admin Tab</h3>
                                <p>Use the <strong>Admin Tab</strong> to manage your listings:</p>
                                <ul>
                                    <li><strong>Add:</strong> Click "+ Add New Listing" to create new cards</li>
                                    <li><strong>Edit:</strong> Click the edit button on any card to modify details</li>
                                    <li><strong>Delete:</strong> Remove listings that are no longer needed</li>
                                    <li><strong>Toggle Featured:</strong> Mark important listings as featured</li>
                                </ul>
                                <p style="margin-top: 12px;">All changes are saved in your browser's local storage, so they'll persist when you return to this page.</p>
                            </div>
                        </div>
                        
                        <div class="deploy-step">
                            <div class="deploy-step-number" style="background: linear-gradient(135deg, #D65052 0%, #b84446 100%);">2</div>
                            <div class="deploy-step-content">
                                <h3>Alternative: Bulk Edit in Data Table</h3>
                                <p>For larger updates, use the <strong>Data Table</strong> tab:</p>
                                <ul>
                                    <li><strong>Direct Editing:</strong> Click any cell to edit inline</li>
                                    <li><strong>CSV Upload:</strong> Upload a spreadsheet with all your data</li>
                                    <li><strong>CSV Download:</strong> Export your current data to Excel/Sheets</li>
                                    <li><strong>Bulk Changes:</strong> Easier for updating many listings at once</li>
                                </ul>
                                <button class="btn btn-secondary" onclick="switchTab('data')" style="margin-top: 12px;">
                                    Open Data Table 
                                </button>
                            </div>
                        </div>
                        
                        <div class="deploy-step">
                            <div class="deploy-step-number" style="background: linear-gradient(135deg, #D65052 0%, #b84446 100%);">3</div>
                            <div class="deploy-step-content">
                                <h3>Generate New Embed Code</h3>
                                <p>After making changes, get the updated code:</p>
                                <ul>
                                    <li>Go to the <strong>Code Tab</strong></li>
                                    <li>Your changes are automatically embedded in the code</li>
                                    <li>Click <strong>Copy</strong> next to "Embed Code"</li>
                                    <li>The new code includes all your latest listings and edits</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="deploy-step">
                            <div class="deploy-step-number" style="background: linear-gradient(135deg, #D65052 0%, #b84446 100%);">4</div>
                            <div class="deploy-step-content">
                                <h3>Replace Code in Squarespace</h3>
                                <p>Update your live site with the new version:</p>
                                <ul>
                                    <li>Log into Squarespace and navigate to your page</li>
                                    <li>Find the existing Code Block with your directory</li>
                                    <li>Click to edit it</li>
                                    <li>Select all the old code (Ctrl+A or Cmd+A) and delete it</li>
                                    <li>Paste the new embed code</li>
                                    <li>Click <strong>Apply</strong> then <strong>Save</strong> and <strong>Publish</strong></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="deploy-tips" style="border-color: #D65052;">
                        <div class="deploy-tip-header" style="color: #D65052;">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" style="width: 24px; height: 24px; margin-right: 12px;">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75z" />
                            </svg>
                            <h3>Quick Update Tips</h3>
                        </div>
                        <ul>
                            <li><strong>Keep This Admin Panel Saved:</strong> Bookmark this HTML file or keep it somewhere accessible. You'll need to open it whenever you want to make updates.</li>
                            <li><strong>Your Data Persists:</strong> All your listings are saved in your browser's local storage, so you don't lose work between sessions (on the same computer/browser).</li>
                            <li><strong>Backup Your Data:</strong> Regularly download your data as CSV from the Data Table tab. This gives you a backup if you switch computers or clear your browser data.</li>
                            <li><strong>Preview Before Deploying:</strong> Always check the Preview tab to see how your changes look before copying the code to Squarespace.</li>
                            <li><strong>Same Process Every Time:</strong> The workflow is always: Edit  Generate Code  Copy  Paste in Squarespace  Publish</li>
                        </ul>
                    </div>
                    
                    <div class="deploy-note" style="border-left-color: #D65052; background: rgba(214, 80, 82, 0.1);">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" style="width: 20px; height: 20px; margin-right: 10px; flex-shrink: 0;">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z" />
                        </svg>
                        <div>
                            <strong>Why Manual Re-deployment?</strong> This approach keeps everything simple and self-contained - no databases, servers, or recurring costs. While it requires manually updating the code in Squarespace, it gives you complete control and works with any Squarespace Business plan or higher without additional services.
                        </div>
                    </div>
                </div>
                
                <!-- Auto-Deploy Section -->
                <div style="margin-top: 60px; padding-top: 40px; border-top: 2px solid var(--border-color);">
                    <div class="deploy-header" style="margin-bottom: 30px;">
                        <h2 style="display: flex; align-items: center; gap: 12px;">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" style="width: 32px; height: 32px; color: #4E6B52;">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M5.25 14.25h13.5m-13.5 0a3 3 0 01-3-3m3 3a3 3 0 100 6h13.5a3 3 0 100-6m-16.5-3a3 3 0 013-3h13.5a3 3 0 013 3m-19.5 0a4.5 4.5 0 01.9-2.7L5.737 5.1a3.375 3.375 0 012.7-1.35h7.126c1.062 0 2.062.5 2.7 1.35l2.587 3.45a4.5 4.5 0 01.9 2.7m0 0a3 3 0 01-3 3m0 3h.008v.008h-.008v-.008zm0-6h.008v.008h-.008v-.008zm-3 6h.008v.008h-.008v-.008zm0-6h.008v.008h-.008v-.008z" />
                            </svg>
                            Advanced: Auto-Deploy with JSON
                        </h2>
                        <p style="color: var(--text-secondary); margin-top: 10px;">For automatic updates without touching Squarespace code, host your data externally and fetch it dynamically</p>
                    </div>
                    
                    <div class="deploy-tips" style="border-color: #6366f1; margin-bottom: 30px;">
                        <div class="deploy-tip-header" style="color: #6366f1;">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" style="width: 24px; height: 24px; margin-right: 12px;">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456z" />
                            </svg>
                            <h3>Benefits of Auto-Deploy</h3>
                        </div>
                        <ul>
                            <li><strong>Update Once, Apply Everywhere:</strong> Change one JSON file and all pages update automatically</li>
                            <li><strong>No Code Changes:</strong> Never touch the Squarespace code block after initial setup</li>
                            <li><strong>Team Collaboration:</strong> Multiple people can update the JSON file</li>
                            <li><strong>Version Control:</strong> Track changes over time using Git</li>
                            <li><strong>Instant Updates:</strong> Changes appear within seconds (depending on caching)</li>
                        </ul>
                    </div>
                    
                    <div class="deploy-steps">
                        <div class="deploy-step">
                            <div class="deploy-step-number" style="background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);">1</div>
                            <div class="deploy-step-content">
                                <h3>Choose a JSON Hosting Service</h3>
                                <p>You need to host your JSON data file somewhere publicly accessible. Here are the best options:</p>
                                
                                <div style="background: var(--bg-secondary); border-radius: 8px; padding: 15px; margin: 15px 0;">
                                    <h4 style="font-size: 16px; color: var(--text-primary); margin-bottom: 10px;">Option A: GitHub (Free & Recommended)</h4>
                                    <ul style="margin: 0; padding-left: 20px;">
                                        <li>Create a free GitHub account at <a href="https://github.com" target="_blank" style="color: #4E6B52;">github.com</a></li>
                                        <li>Create a new repository (can be public or private)</li>
                                        <li>Upload your <code>listings.json</code> file</li>
                                        <li>Use GitHub's raw content URL: <code>https://raw.githubusercontent.com/username/repo/main/listings.json</code></li>
                                        <li><strong>Pros:</strong> Free, version control, easy updates via web interface or Git</li>
                                    </ul>
                                    <button class="btn btn-primary" onclick="document.getElementById('githubDetailedSteps').style.display = document.getElementById('githubDetailedSteps').style.display === 'none' ? 'block' : 'none'" style="margin-top: 12px; font-size: 13px;">
                                         Show Detailed GitHub Setup Guide
                                    </button>
                                    
                                    <!-- Detailed GitHub Guide -->
                                    <div id="githubDetailedSteps" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 2px solid var(--border-color);">
                                        <h4 style="font-size: 18px; color: #4E6B52; margin-bottom: 20px; font-weight: 600;"> Complete GitHub Setup Guide</h4>
                                        
                                        <div style="background: white; border: 2px solid #e5e7eb; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                                                <div style="width: 32px; height: 32px; background: #4E6B52; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">1</div>
                                                <h5 style="margin: 0; font-size: 16px; color: var(--text-primary);">Create a GitHub Account</h5>
                                            </div>
                                            <ul style="margin: 10px 0 0 44px; padding: 0; list-style: none;">
                                                <li style="margin-bottom: 8px;"> Go to <a href="https://github.com/signup" target="_blank" style="color: #4E6B52; font-weight: 600;">github.com/signup</a></li>
                                                <li style="margin-bottom: 8px;"> Enter your email address and click "Continue"</li>
                                                <li style="margin-bottom: 8px;"> Create a password and username</li>
                                                <li style="margin-bottom: 8px;"> Verify your account via email</li>
                                                <li style="margin-bottom: 8px;"> Choose the free plan (no credit card needed)</li>
                                            </ul>
                                        </div>
                                        
                                        <div style="background: white; border: 2px solid #e5e7eb; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                                                <div style="width: 32px; height: 32px; background: #4E6B52; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">2</div>
                                                <h5 style="margin: 0; font-size: 16px; color: var(--text-primary);">Create a New Repository</h5>
                                            </div>
                                            <ul style="margin: 10px 0 0 44px; padding: 0; list-style: none;">
                                                <li style="margin-bottom: 8px;"> Once logged in, click the <strong>+</strong> button in the top-right corner</li>
                                                <li style="margin-bottom: 8px;"> Select <strong>"New repository"</strong></li>
                                                <li style="margin-bottom: 8px;"> <strong>Repository name:</strong> Type something like <code>adventure-listings</code> or <code>listings-data</code></li>
                                                <li style="margin-bottom: 8px;"> <strong>Description (optional):</strong> "JSON data for my adventure directory"</li>
                                                <li style="margin-bottom: 8px;"> <strong>Visibility:</strong> Choose <strong>Public</strong> (required for free raw file access)</li>
                                                <li style="margin-bottom: 8px;"> Check  <strong>"Add a README file"</strong></li>
                                                <li style="margin-bottom: 8px;"> Click <strong>"Create repository"</strong></li>
                                            </ul>
                                        </div>
                                        
                                        <div style="background: white; border: 2px solid #e5e7eb; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                                                <div style="width: 32px; height: 32px; background: #4E6B52; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">3</div>
                                                <h5 style="margin: 0; font-size: 16px; color: var(--text-primary);">Export Your JSON Data</h5>
                                            </div>
                                            <ul style="margin: 10px 0 0 44px; padding: 0; list-style: none;">
                                                <li style="margin-bottom: 8px;"> In this admin panel, click the <strong>Code</strong> tab at the top</li>
                                                <li style="margin-bottom: 8px;"> Scroll down to the <strong>"JSON Data"</strong> section</li>
                                                <li style="margin-bottom: 8px;"> Click the <strong>"Copy"</strong> button</li>
                                                <li style="margin-bottom: 8px;"> Open a text editor (Notepad, TextEdit, VS Code, etc.)</li>
                                                <li style="margin-bottom: 8px;"> Paste the JSON data</li>
                                                <li style="margin-bottom: 8px;"> Save the file as <code><strong>listings.json</strong></code> (make sure it has the .json extension)</li>
                                            </ul>
                                        </div>
                                        
                                        <div style="background: white; border: 2px solid #e5e7eb; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                                                <div style="width: 32px; height: 32px; background: #4E6B52; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">4</div>
                                                <h5 style="margin: 0; font-size: 16px; color: var(--text-primary);">Upload JSON File to GitHub</h5>
                                            </div>
                                            <ul style="margin: 10px 0 0 44px; padding: 0; list-style: none;">
                                                <li style="margin-bottom: 8px;"> Go back to your GitHub repository page</li>
                                                <li style="margin-bottom: 8px;"> Click <strong>"Add file"</strong>  <strong>"Upload files"</strong></li>
                                                <li style="margin-bottom: 8px;"> Drag and drop your <code>listings.json</code> file, or click "choose your files"</li>
                                                <li style="margin-bottom: 8px;"> In the "Commit changes" box at the bottom, type: <code>Add listings data</code></li>
                                                <li style="margin-bottom: 8px;"> Click <strong>"Commit changes"</strong></li>
                                                <li style="margin-bottom: 8px;"> Your file is now uploaded! </li>
                                            </ul>
                                        </div>
                                        
                                        <div style="background: white; border: 2px solid #e5e7eb; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                                                <div style="width: 32px; height: 32px; background: #4E6B52; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">5</div>
                                                <h5 style="margin: 0; font-size: 16px; color: var(--text-primary);">Get Your JSON File URL</h5>
                                            </div>
                                            <ul style="margin: 10px 0 0 44px; padding: 0; list-style: none;">
                                                <li style="margin-bottom: 8px;"> On your repository page, click on <code>listings.json</code></li>
                                                <li style="margin-bottom: 8px;"> Click the <strong>"Raw"</strong> button (top-right of the file viewer)</li>
                                                <li style="margin-bottom: 8px;"> Copy the URL from your browser's address bar</li>
                                                <li style="margin-bottom: 12px;"> It should look like: <code style="display: block; background: #f3f4f6; padding: 8px; border-radius: 4px; margin-top: 8px; word-break: break-all;">https://raw.githubusercontent.com/YourUsername/adventure-listings/main/listings.json</code></li>
                                                <li style="margin-bottom: 8px; padding: 12px; background: #dcfce7; border-left: 3px solid #4E6B52; border-radius: 4px;"><strong> Save this URL!</strong> You'll use it in Step 3 of the Auto-Deploy setup</li>
                                            </ul>
                                        </div>
                                        
                                        <div style="background: white; border: 2px solid #e5e7eb; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                                                <div style="width: 32px; height: 32px; background: #4E6B52; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">6</div>
                                                <h5 style="margin: 0; font-size: 16px; color: var(--text-primary);">How to Update Your Data Later</h5>
                                            </div>
                                            <ul style="margin: 10px 0 0 44px; padding: 0; list-style: none;">
                                                <li style="margin-bottom: 8px;"><strong>Method 1: Web Interface (Easiest)</strong></li>
                                                <li style="margin-bottom: 8px; margin-left: 20px;"> Go to your repository on GitHub</li>
                                                <li style="margin-bottom: 8px; margin-left: 20px;"> Click on <code>listings.json</code></li>
                                                <li style="margin-bottom: 8px; margin-left: 20px;"> Click the pencil icon () to edit</li>
                                                <li style="margin-bottom: 8px; margin-left: 20px;"> Delete all content and paste your new JSON data</li>
                                                <li style="margin-bottom: 8px; margin-left: 20px;"> Scroll down, add a commit message: <code>Update listings</code></li>
                                                <li style="margin-bottom: 12px; margin-left: 20px;"> Click <strong>"Commit changes"</strong></li>
                                                
                                                <li style="margin-bottom: 8px; margin-top: 12px;"><strong>Method 2: Re-upload</strong></li>
                                                <li style="margin-bottom: 8px; margin-left: 20px;"> Download new JSON from Code tab</li>
                                                <li style="margin-bottom: 8px; margin-left: 20px;"> Go to your GitHub repository</li>
                                                <li style="margin-bottom: 8px; margin-left: 20px;"> Click <code>listings.json</code>  Click trash icon  to delete</li>
                                                <li style="margin-bottom: 8px; margin-left: 20px;"> Upload the new version</li>
                                            </ul>
                                        </div>
                                        
                                        <div style="background: #fef3c7; border: 2px solid #fbbf24; border-radius: 8px; padding: 15px; margin-top: 20px;">
                                            <div style="display: flex; align-items: start; gap: 10px;">
                                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" style="width: 24px; height: 24px; color: #d97706; flex-shrink: 0;">
                                                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 18v-5.25m0 0a6.01 6.01 0 001.5-.189m-1.5.189a6.01 6.01 0 01-1.5-.189m3.75 7.478a12.06 12.06 0 01-4.5 0m3.75 2.383a14.406 14.406 0 01-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 10-7.517 0c.85.493 1.509 1.333 1.509 2.316V18" />
                                                </svg>
                                                <div>
                                                    <strong style="color: #92400e;">Pro Tip:</strong> After uploading to GitHub, test your URL by pasting it directly into your browser. You should see your JSON data displayed. If it works there, it will work in your Squarespace embed!
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div style="background: #dbeafe; border: 2px solid #3b82f6; border-radius: 8px; padding: 15px; margin-top: 15px;">
                                            <div style="display: flex; align-items: start; gap: 10px;">
                                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" style="width: 24px; height: 24px; color: #1d4ed8; flex-shrink: 0;">
                                                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                                </svg>
                                                <div>
                                                    <strong style="color: #1e40af;">Next Steps:</strong> Once your JSON file is on GitHub and you have the raw URL, continue to <strong>Step 3</strong> in the Auto-Deploy section above to modify your embed code.
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="background: var(--bg-secondary); border-radius: 8px; padding: 15px; margin: 15px 0;">
                                    <h4 style="font-size: 16px; color: var(--text-primary); margin-bottom: 10px;">Option B: JSONBin.io (Easiest)</h4>
                                    <ul style="margin: 0; padding-left: 20px;">
                                        <li>Visit <a href="https://jsonbin.io" target="_blank" style="color: #4E6B52;">jsonbin.io</a> (free tier available)</li>
                                        <li>Create a "bin" and paste your JSON data</li>
                                        <li>Get a public URL to your data</li>
                                        <li><strong>Pros:</strong> Super simple, no technical knowledge needed</li>
                                        <li><strong>Cons:</strong> Free tier has rate limits</li>
                                    </ul>
                                </div>
                                
                                <div style="background: var(--bg-secondary); border-radius: 8px; padding: 15px; margin: 15px 0;">
                                    <h4 style="font-size: 16px; color: var(--text-primary); margin-bottom: 10px;">Option C: Cloudflare Workers/Pages (Advanced)</h4>
                                    <ul style="margin: 0; padding-left: 20px;">
                                        <li>Host static JSON files on Cloudflare's CDN</li>
                                        <li>Extremely fast global delivery</li>
                                        <li><strong>Pros:</strong> Best performance, generous free tier</li>
                                        <li><strong>Cons:</strong> Requires more technical setup</li>
                                    </ul>
                                </div>
                                
                                <div style="background: var(--bg-secondary); border-radius: 8px; padding: 15px; margin: 15px 0;">
                                    <h4 style="font-size: 16px; color: var(--text-primary); margin-bottom: 10px;">Option D: Your Own Web Hosting</h4>
                                    <ul style="margin: 0; padding-left: 20px;">
                                        <li>If you have web hosting, upload the JSON file via FTP</li>
                                        <li>Access it at <code>https://yourdomain.com/listings.json</code></li>
                                        <li><strong>Pros:</strong> Complete control</li>
                                        <li><strong>Cons:</strong> Need existing hosting and CORS configuration</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="deploy-step">
                            <div class="deploy-step-number" style="background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);">2</div>
                            <div class="deploy-step-content">
                                <h3>Export Your JSON Data</h3>
                                <p>Get your listings data from this admin panel:</p>
                                <ul>
                                    <li>Go to the <strong>Code Tab</strong></li>
                                    <li>Find the <strong>JSON Data</strong> section</li>
                                    <li>Copy all the JSON code</li>
                                    <li>Save it as <code>listings.json</code> on your computer</li>
                                    <li>Upload this file to your chosen hosting service</li>
                                </ul>
                                <button class="btn btn-primary" onclick="switchTab('code')" style="margin-top: 12px;">
                                    Go to Code Tab 
                                </button>
                            </div>
                        </div>
                        
                        <div class="deploy-step">
                            <div class="deploy-step-number" style="background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);">3</div>
                            <div class="deploy-step-content">
                                <h3>Modify the Embed Code</h3>
                                <p>Update the JavaScript to fetch data from your JSON URL instead of using embedded data:</p>
                                
                                <div style="background: #1e293b; color: #e2e8f0; border-radius: 8px; padding: 20px; margin: 15px 0; font-family: 'Courier New', monospace; font-size: 13px; overflow-x: auto;">
<pre style="margin: 0; white-space: pre-wrap;">// Replace the embedded listingsData with:
let listingsData = [];

// Your JSON file URL
const JSON_URL = 'https://raw.githubusercontent.com/username/repo/main/listings.json';

// Fetch data on page load
async function loadListings() {
    try {
        const response = await fetch(JSON_URL);
        listingsData = await response.json();
        renderListings(); // Your existing render function
    } catch (error) {
        console.error('Error loading listings:', error);
    }
}

// Call on page load
loadListings();</pre>
                                </div>
                                
                                <p style="margin-top: 15px;">Replace <code>JSON_URL</code> with your actual JSON file URL from Step 1.</p>
                            </div>
                        </div>
                        
                        <div class="deploy-step">
                            <div class="deploy-step-number" style="background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);">4</div>
                            <div class="deploy-step-content">
                                <h3>Deploy Modified Code to Squarespace</h3>
                                <p>Put the updated code on your Squarespace site (one-time setup):</p>
                                <ul>
                                    <li>Copy the modified embed code (with the fetch logic)</li>
                                    <li>Paste it into a Code Block in Squarespace</li>
                                    <li>Save and publish</li>
                                    <li><strong>That's it!</strong> You'll never need to touch this code again</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="deploy-step">
                            <div class="deploy-step-number" style="background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);">5</div>
                            <div class="deploy-step-content">
                                <h3>Update Your Listings Anytime</h3>
                                <p>Now updating is as simple as updating the JSON file:</p>
                                <ul>
                                    <li>Make changes in this Admin Panel</li>
                                    <li>Go to Code Tab  Copy the JSON Data</li>
                                    <li>Update your <code>listings.json</code> file on your hosting service</li>
                                    <li>Changes appear on your site automatically (within seconds to minutes)</li>
                                </ul>
                                <p style="margin-top: 12px; padding: 12px; background: rgba(99, 102, 241, 0.1); border-left: 3px solid #6366f1; border-radius: 4px;">
                                    <strong>No Squarespace changes needed!</strong> Just update the JSON file and you're done.
                                </p>
                            </div>
                        </div>
=======
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
                            </svg>
                            Troubleshooting
                        </h2>
>>>>>>> a97840a205826fe60553800d5e750c1313343f6d
                    </div>
                    
                    <div class="deploy-tips" style="border-color: #f59e0b;">
                        <div class="deploy-tip-header" style="color: #f59e0b;">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" style="width: 24px; height: 24px; margin-right: 12px;">
<<<<<<< HEAD
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
                            </svg>
                            <h3>Important Considerations</h3>
                        </div>
                        <ul>
                            <li><strong>CORS Headers:</strong> Your JSON hosting must allow cross-origin requests. GitHub, JSONBin, and Cloudflare all support this by default.</li>
                            <li><strong>Caching:</strong> Some services cache data. Changes may take 1-5 minutes to appear. GitHub typically updates within 30 seconds.</li>
                            <li><strong>Rate Limits:</strong> Free tiers have request limits. For high-traffic sites, consider paid plans or Cloudflare.</li>
                            <li><strong>Security:</strong> Your JSON file will be publicly accessible. Don't include sensitive data.</li>
                            <li><strong>Backup Strategy:</strong> Always keep a local copy of your JSON file. Use version control (Git) if possible.</li>
                        </ul>
                    </div>
                    
                    <div class="deploy-note" style="border-left-color: #6366f1; background: rgba(99, 102, 241, 0.1);">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" style="width: 20px; height: 20px; margin-right: 10px; flex-shrink: 0;">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z" />
                        </svg>
                        <div>
                            <strong>Recommended Setup:</strong> Start with GitHub for hosting. It's free, reliable, has version control, and is easy to update through their web interface. For most use cases, this is the perfect balance of simplicity and functionality.
=======
                                <path stroke-linecap="round" stroke-linejoin="round" d="M9.75 3.104v5.714a2.25 2.25 0 01-.659 1.591L5 14.5M9.75 3.104c-.251.023-.501.05-.75.082m.75-.082a24.301 24.301 0 014.5 0m0 0v5.714c0 .597.237 1.17.659 1.591L19.8 15.3M14.25 3.104c.251.023.501.05.75.082M19.8 15.3l-1.57.393A9.065 9.065 0 0112 15a9.065 9.065 0 00-6.23-.693L5 14.5m14.8.8l1.57.393A9.065 9.065 0 0021.75 12a9.065 9.065 0 00-6.23-.693m0 0l-1.57-.393M5 14.5l1.57-.393M5 14.5l-1.57.393M12 15.75l-1.57-.393M12 15.75l1.57-.393" />
                            </svg>
                            <h3>Common Issues & Solutions</h3>
                        </div>
                        <ul>
                            <li><strong>CORS Errors:</strong> Make sure Apps Script is deployed with "Anyone" access and uses <code>e.postData.contents</code>. Try creating a new deployment if issues persist.</li>
                            <li><strong>Data Not Syncing:</strong> Check that your Apps Script URL is correct in the admin panel. Verify the script is deployed and active.</li>
                            <li><strong>Framer Not Updating:</strong> Manually refresh the CMS collection in Framer. Check that your Google Sheet is properly shared/published.</li>
                            <li><strong>Missing Fields:</strong> Ensure your Google Sheet has the required columns (id, name, type, area, description, etc.)</li>
                            <li><strong>Local Changes Lost:</strong> Always sync to Google Sheets before closing the admin panel if you want to keep changes across devices.</li>
                        </ul>
                    </div>
                </div>
                
                <!-- Quick Reference -->
                <div style="margin-top: 60px; padding-top: 40px; border-top: 2px solid var(--border-color);">
                    <div class="deploy-header" style="margin-bottom: 30px;">
                        <h2 style="display: flex; align-items: center; gap: 12px;">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" style="width: 32px; height: 32px; color: #4E6B52;">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25a2.25 2.25 0 01-2.25-2.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z" />
                            </svg>
                            Quick Reference
                        </h2>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                        <div style="background: white; border: 1px solid #dee2e6; border-radius: 8px; padding: 20px;">
                            <h4 style="margin: 0 0 10px 0; color: #4E6B52;"> Admin Panel</h4>
                            <ul style="margin: 0; padding-left: 20px; font-size: 14px;">
                                <li>Edit listings locally</li>
                                <li>Manage field options</li>
                                <li>Download backups</li>
                                <li>Sync to Sheets</li>
                            </ul>
                        </div>
                        
                        <div style="background: white; border: 1px solid #dee2e6; border-radius: 8px; padding: 20px;">
                            <h4 style="margin: 0 0 10px 0; color: #34a853;"> Google Sheets</h4>
                            <ul style="margin: 0; padding-left: 20px; font-size: 14px;">
                                <li>Central data storage</li>
                                <li>Accessed via Apps Script</li>
                                <li>Source for Framer CMS</li>
                                <li>Always backup first!</li>
                            </ul>
                        </div>
                        
                        <div style="background: white; border: 1px solid #dee2e6; border-radius: 8px; padding: 20px;">
                            <h4 style="margin: 0 0 10px 0; color: #6366f1;"> Framer CMS</h4>
                            <ul style="margin: 0; padding-left: 20px; font-size: 14px;">
                                <li>Auto-refreshes from Sheets</li>
                                <li>No code deployment needed</li>
                                <li>Design with CMS data</li>
                                <li>Publish to go live</li>
                            </ul>
                        </div>
                        
                        <div style="background: white; border: 1px solid #dee2e6; border-radius: 8px; padding: 20px;">
                            <h4 style="margin: 0 0 10px 0; color: #D65052;"> Live Site</h4>
                            <ul style="margin: 0; padding-left: 20px; font-size: 14px;">
                                <li>Automatic updates</li>
                                <li>No downtime</li>
                                <li>Reflects Sheet data</li>
                                <li>Always current</li>
                            </ul>
>>>>>>> a97840a205826fe60553800d5e750c1313343f6d
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="listingModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Add New Listing</h2>
                <button class="close-modal" onclick="closeModal()">&times;</button>
            </div>
            
            <form id="listingForm" onsubmit="saveListing(event)">
                <input type="hidden" id="editingId" />
                
                <div class="form-group">
                    <label>Listing Name *</label>
                    <input type="text" id="listingName" required />
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Type *</label>
                        <select id="listingType" required>
                            <option value="">Select Type</option>
<<<<<<< HEAD
                            <option value="Brewery">Brewery</option>
                            <option value="Winery">Winery</option>
                            <option value="Cidery">Cidery</option>
                            <option value="Hiking">Hiking</option>
                            <option value="Outdoor">Outdoor</option>
                            <option value="Indoor Activity">Indoor Activity</option>
                            <option value="Attraction">Attraction</option>
                            <option value="Farm & Orchard">Farm & Orchard</option>
=======
                            <!-- Options will be populated dynamically -->
>>>>>>> a97840a205826fe60553800d5e750c1313343f6d
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Area *</label>
                        <select id="listingArea" required>
                            <option value="">Select Area</option>
<<<<<<< HEAD
                            <option value="Afton">Afton</option>
                            <option value="Wintergreen">Wintergreen</option>
                            <option value="Lovingston">Lovingston</option>
                            <option value="Nellysford">Nellysford</option>
                            <option value="Montebello">Montebello</option>
                            <option value="Arrington">Arrington</option>
                            <option value="Roseland">Roseland</option>
=======
                            <!-- Options will be populated dynamically -->
>>>>>>> a97840a205826fe60553800d5e750c1313343f6d
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Description *</label>
                    <textarea id="listingDescription" required></textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Image URL 1 *</label>
                        <input type="text" id="listingImage1" required placeholder="https:// or data:image..." />
                    </div>
                    
                    <div class="form-group">
                        <label>Image URL 2</label>
                        <input type="text" id="listingImage2" placeholder="https:// or data:image..." />
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Website *</label>
                        <input type="url" id="listingWebsite" required placeholder="https://..." />
                    </div>
                    
                    <div class="form-group">
                        <label>Phone</label>
                        <input type="tel" id="listingPhone" placeholder="(434) 123-4567" />
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Address *</label>
                    <input type="text" id="listingAddress" required />
                </div>
                
                <div class="form-group">
                    <label>Amenities</label>
                    <div class="checkbox-group" id="amenitiesCheckboxes"></div>
                </div>
                
                <div class="form-group">
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" id="listingFeatured" style="width: auto;" />
                        Mark as Featured
                    </label>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancel</button>
                    <button type="submit" class="btn btn-success">Save Listing</button>
                </div>
            </form>
        </div>
    </div>
    
    <script>
        const initialData = 
{
  "listings": [
    {
      "id": "1",
      "name": "Devil's Backbone Brewing Company",
      "type": "Brewery",
      "area": "Wintergreen",
      "description": "Award-winning craft brewery nestled at the base of the Blue Ridge Mountains. Enjoy locally-brewed beers, live music, and mountain views from the outdoor beer garden.",
      "image1": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "image2": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "website": "https://dbbrewingcompany.com",
      "phone": "(434) 361-1001",
      "address": "200 Mosbys Run, Roseland, VA 22967",
      "amenities": ["Pet-Friendly", "Outdoor Seating", "Live Music", "Food Available"],
      "featured": true
    },
    {
      "id": "2",
      "name": "Crabtree Falls Trail",
      "type": "Hiking",
      "area": "Montebello",
      "description": "Virginia's highest vertical-drop cascading waterfall. This moderate 3-mile round trip hike features stunning overlooks and is especially beautiful in fall foliage season.",
      "image1": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "image2": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "website": "https://www.fs.usda.gov/recarea/gwj/recarea/?recid=73957",
      "phone": "(540) 291-2188",
      "address": "Crabtree Falls Hwy, Montebello, VA 24464",
      "amenities": ["Free", "Kid-Friendly", "Scenic Views", "Photography"],
      "featured": true
    },
    {
      "id": "3",
      "name": "Wintergreen Resort",
      "type": "Outdoor",
      "area": "Wintergreen",
      "description": "Four-season mountain resort offering skiing, snowboarding, mountain biking, hiking, golf, and spa services. Stunning Blue Ridge Mountain views year-round.",
      "image1": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "image2": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "website": "https://www.wintergreenresort.com",
      "phone": "(434) 325-2200",
      "address": "39 Mountain Inn Loop, Wintergreen, VA 22958",
      "amenities": ["Kid-Friendly", "Seasonal", "Wheelchair Accessible", "Lessons Available"],
      "featured": true
    },
    {
      "id": "4",
      "name": "Blue Mountain Brewery",
      "type": "Brewery",
      "area": "Afton",
      "description": "Farm brewery and taproom with an on-site hop yard. Full restaurant menu featuring locally-sourced ingredients and spectacular mountain views from multiple decks.",
      "image1": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "image2": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "website": "https://www.bluemountainbrewery.com",
      "phone": "(540) 456-8020",
      "address": "9519 Critzers Shop Rd, Afton, VA 22920",
      "amenities": ["Pet-Friendly", "Outdoor Seating", "Food Available", "Live Music"],
      "featured": false
    },
    {
      "id": "5",
      "name": "The Plunge at Wintergreen",
      "type": "Outdoor",
      "area": "Wintergreen",
      "description": "Outdoor aquatic complex featuring water slides, lazy river, zero-entry pool, and lap pool. Perfect family summer destination with mountain views.",
      "image1": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "image2": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "website": "https://www.wintergreenresort.com/play/the-plunge",
      "phone": "(434) 325-8169",
      "address": "Wintergreen Dr, Wintergreen, VA 22958",
      "amenities": ["Kid-Friendly", "Seasonal", "Wheelchair Accessible", "Lifeguards"],
      "featured": false
    },
    {
      "id": "6",
      "name": "Rockfish Valley Trail",
      "type": "Hiking",
      "area": "Nellysford",
      "description": "Easy 2-mile paved trail perfect for walking, jogging, or biking. Follows Rockfish River with mountain views and connects to local breweries and shops.",
      "image1": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "image2": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "website": "https://www.nelsoncounty-va.gov/facilities/facility/details/Rockfish-Valley-Trail-25",
      "phone": "(434) 263-7015",
      "address": "Rockfish Valley Hwy, Nellysford, VA 22958",
      "amenities": ["Free", "Kid-Friendly", "Pet-Friendly", "Wheelchair Accessible", "Biking"],
      "featured": false
    },
    {
      "id": "7",
      "name": "Wild Wolf Brewing Company",
      "type": "Brewery",
      "area": "Nellysford",
      "description": "Craft brewery with full kitchen, outdoor patio, and kid-friendly atmosphere. Known for creative seasonal beers and live music on weekends.",
      "image1": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "image2": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "website": "https://www.wildwolfbeer.com",
      "phone": "(434) 361-0088",
      "address": "2773 Rockfish Valley Hwy, Nellysford, VA 22958",
      "amenities": ["Kid-Friendly", "Pet-Friendly", "Outdoor Seating", "Food Available", "Live Music"],
      "featured": false
    },
    {
      "id": "8",
      "name": "Stoney Creek Golf Course",
      "type": "Outdoor",
      "area": "Wintergreen",
      "description": "Championship 18-hole golf course designed by Rees Jones. Features dramatic elevation changes, mountain views, and challenging play for all skill levels.",
      "image1": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "image2": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "website": "https://www.wintergreenresort.com/play/golf",
      "phone": "(434) 325-8250",
      "address": "Wintergreen Dr, Wintergreen, VA 22958",
      "amenities": ["Seasonal", "Pro Shop", "Lessons Available", "Cart Rental"],
      "featured": false
    },
    {
      "id": "9",
      "name": "Humpback Rocks Trail",
      "type": "Hiking",
      "area": "Afton",
      "description": "Challenging 2-mile hike to stunning 360-degree Blue Ridge views. Part of the Appalachian Trail with rocky terrain and rewarding summit panoramas.",
      "image1": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "image2": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "website": "https://www.nps.gov/blri/planyourvisit/humpback-rocks.htm",
      "phone": "(540) 943-5187",
      "address": "Milepost 5.8, Blue Ridge Parkway, Afton, VA 22920",
      "amenities": ["Free", "Scenic Views", "Photography", "Appalachian Trail"],
      "featured": true
    },
    {
      "id": "10",
      "name": "Veritas Vineyards",
      "type": "Winery",
      "area": "Afton",
      "description": "Award-winning winery with stunning views of the Blue Ridge foothills. Offers tastings, tours, and a beautiful outdoor pavilion for events.",
      "image1": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "image2": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "website": "https://www.veritaswines.com",
      "phone": "(540) 456-8000",
      "address": "151 Veritas Ln, Afton, VA 22920",
      "amenities": ["Pet-Friendly", "Outdoor Seating", "Tours Available", "Events"],
      "featured": false
    },
    {
      "id": "11",
      "name": "Bold Rock Hard Cider",
      "type": "Cidery",
      "area": "Nellysford",
      "description": "Virginia's first cidery and taproom featuring handcrafted hard ciders made from fresh-pressed Virginia apples. Enjoy live music on the outdoor stage with mountain views, lawn games, and seasonal cider releases. The expansive grounds include a tasting room, outdoor pavilion, and food trucks.",
      "image1": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "image2": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "website": "https://www.boldrock.com",
      "phone": "(434) 361-1030",
      "address": "1020 Rockfish Valley Hwy, Nellysford, VA 22958",
      "amenities": ["Pet-Friendly", "Outdoor Seating", "Live Music", "Kid-Friendly", "Tours Available", "Food Available"],
      "featured": true
    },
    {
      "id": "12",
      "name": "Spy Rock",
      "type": "Hiking",
      "area": "Montebello",
      "description": "A moderately challenging 3.7-mile out-and-back trail leading to stunning 360-degree views from a rocky outcrop. Popular spot for sunrise and sunset photography. The trail passes through beautiful hardwood forest and offers glimpses of wildlife. Best visited in spring for wildflowers or fall for foliage.",
      "image1": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "image2": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "website": "https://www.hikingupward.com/GWNF/SpyRock",
      "phone": "(540) 291-2188",
      "address": "Spy Rock Rd, Montebello, VA 24464",
      "amenities": ["Free", "Scenic Views", "Photography", "Kid-Friendly"],
      "featured": false
    },
    {
      "id": "13",
      "name": "Pharsalia",
      "type": "Farm & Orchard",
      "area": "Lovingston",
      "description": "Working farm and educational center offering farm tours, workshops, and seasonal events. Visit the farm store for locally-raised grass-fed beef, pastured pork, and farm-fresh eggs. Popular destination for school field trips and agritourism. Beautiful historic property with walking trails and picnic areas.",
      "image1": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "image2": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "website": "https://www.pharsalia.org",
      "phone": "(434) 277-5050",
      "address": "3735 Variety Mills Rd, Lovingston, VA 22949",
      "amenities": ["Kid-Friendly", "Tours Available", "Events", "Seasonal", "Free"],
      "featured": false
    },
    {
      "id": "14",
      "name": "Swannanoa Palace",
      "type": "Attraction",
      "area": "Afton",
      "description": "Historic Italian Renaissance-style marble mansion built in 1912 atop Afton Mountain. Offers guided tours showcasing Tiffany stained glass windows, marble columns, and panoramic mountain views. Rich history includes its time as a country club and art school. Perfect for architecture enthusiasts and history buffs.",
      "image1": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "image2": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "website": "https://www.swannanoavalley.org",
      "phone": "(434) 325-5539",
      "address": "3051 Swannanoa Dr, Afton, VA 22920",
      "amenities": ["Tours Available", "Photography", "Scenic Views", "Wheelchair Accessible"],
      "featured": false
    },
    {
      "id": "15",
      "name": "Tye River Gap Trail",
      "type": "Hiking",
      "area": "Roseland",
      "description": "Moderate 2.4-mile trail following the historic Tye River through scenic forest. Features multiple creek crossings, swimming holes, and remnants of old railroad grade. Great for families and dogs. Less crowded than other area trails. Best visited in summer for swimming and wading opportunities.",
      "image1": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "image2": "https://www.adventurebook.com/connect/wp-content/uploads/sites/2/2021/10/Adventure-Ideas.jpg",
      "website": "https://www.nelsoncounty-va.gov/trails",
      "phone": "(434) 263-7015",
      "address": "Tye River Gap, VA-56, Roseland, VA 22967",
      "amenities": ["Free", "Pet-Friendly", "Kid-Friendly", "Scenic Views", "Seasonal"],
      "featured": false
    }
  ],
  "filterOptions": {
    "types": ["Brewery", "Winery", "Cidery", "Hiking", "Outdoor", "Indoor Activity", "Attraction", "Farm & Orchard"],
    "areas": ["Afton", "Wintergreen", "Lovingston", "Nellysford", "Montebello", "Arrington", "Roseland"],
    "amenities": ["Kid-Friendly", "Pet-Friendly", "Wheelchair Accessible", "Free", "Seasonal", "Outdoor Seating", "Food Available", "Live Music", "Tours Available", "Events", "Photography", "Scenic Views", "Biking", "Appalachian Trail", "Pro Shop", "Lessons Available", "Cart Rental", "Lifeguards"]
  }
}
;
        
        // ========================================
        // GOOGLE SHEETS CONFIGURATION
        // ========================================
        // Step 1: Get your Google Sheet's published CSV URL (optional - used as fallback)
        // File  Share  Publish to web  CSV  Copy URL
        const GOOGLE_SHEET_CSV_URL = 'https://docs.google.com/spreadsheets/d/e/YOUR_SHEET_ID/pub?gid=0&single=true&output=csv';
        
        // Step 2: Your Google Apps Script Web App URL (REQUIRED for read/write)
        // This URL is already configured and working!
        const GOOGLE_APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwNH8P5P8iorzRTTx3FpVbYPFNBo1qUWIU630v7ymLJWypvJpSEfPZC5nfxJpjjwjF-Jg/exec';
        
        // ========================================
        
        let data = JSON.parse(JSON.stringify(initialData));
<<<<<<< HEAD
=======
        
        // Load saved filterOptions from localStorage if available
        const savedFilterOptions = localStorage.getItem('nelsonCounty_filterOptions');
        if (savedFilterOptions) {
            try {
                data.filterOptions = JSON.parse(savedFilterOptions);
            } catch (e) {
                console.error('Error loading saved filterOptions:', e);
            }
        }
        
>>>>>>> a97840a205826fe60553800d5e750c1313343f6d
        let deleteConfirmId = null;
        let deleteConfirmTimeout = null;
        
        // Helper function to parse CSV text into array of objects
        function parseCSV(csvText) {
            const rows = [];
            let currentRow = '';
            let inQuotes = false;
            
            for (let i = 0; i < csvText.length; i++) {
                const char = csvText[i];
                const nextChar = csvText[i + 1];
                
                if (char === '"') {
                    if (inQuotes && nextChar === '"') {
                        currentRow += '"';
                        i++;
                    } else {
                        inQuotes = !inQuotes;
                    }
                } else if (char === '\n' && !inQuotes) {
                    if (currentRow.trim()) rows.push(currentRow);
                    currentRow = '';
                } else {
                    currentRow += char;
                }
            }
            if (currentRow.trim()) rows.push(currentRow);
            
            if (rows.length === 0) return [];
            
            const headers = rows[0].split(',').map(h => h.trim().replace(/^"|"$/g, ''));
            const dataRows = [];
            
            for (let i = 1; i < rows.length; i++) {
                const values = [];
                let current = '';
                let inQuotes = false;
                
                for (let j = 0; j < rows[i].length; j++) {
                    const char = rows[i][j];
                    if (char === '"') {
                        if (inQuotes && rows[i][j + 1] === '"') {
                            current += '"';
                            j++;
                        } else {
                            inQuotes = !inQuotes;
                        }
                    } else if (char === ',' && !inQuotes) {
                        values.push(current.trim().replace(/^"|"$/g, ''));
                        current = '';
                    } else {
                        current += char;
                    }
                }
                values.push(current.trim().replace(/^"|"$/g, ''));
                
                if (values[0]) { // Only add rows with a title/ID
                    const row = {};
                    headers.forEach((header, idx) => {
                        row[header] = values[idx] || '';
                    });
                    dataRows.push(row);
                }
            }
            
            return { headers, dataRows };
        }
        
        // Map CSV row to listing object
        function mapCSVRowToListing(row, headers) {
            const listing = {};
            
            headers.forEach(header => {
                const value = row[header] || '';
                const headerLower = header.toLowerCase().trim();
                
                if (headerLower === 'id' || headerLower === 'slug') {
                    listing.id = String(value || '');
                } else if (headerLower === 'title' || headerLower === 'name') {
                    listing.name = String(value || '');
                } else if (headerLower === 'type') {
                    listing.type = String(value || '');
                } else if (headerLower === 'area') {
                    listing.area = String(value || '');
                } else if (headerLower === 'description') {
                    listing.description = String(value || '');
                } else if (headerLower === 'photo' || headerLower === 'image1' || headerLower === 'image 1') {
                    listing.image1 = String(value || '');
                } else if (headerLower === 'image2' || headerLower === 'image 2') {
                    listing.image2 = String(value || '');
                } else if (headerLower === 'external website' || headerLower === 'website' || headerLower === 'url') {
                    listing.website = String(value || '');
                } else if (headerLower === 'phone') {
                    listing.phone = String(value || '');
                } else if (headerLower === 'address') {
                    listing.address = String(value || '');
                } else if (headerLower === 'amenities') {
                    const amenityStr = String(value || '');
                    listing.amenities = amenityStr.split(/[,;]/).map(a => a.trim()).filter(a => a);
                } else if (headerLower === 'featured') {
                    const featuredVal = String(value || '').toLowerCase();
                    listing.featured = featuredVal === 'true' || featuredVal === 'yes' || featuredVal === '1';
                }
            });
            
            // Generate ID if missing
            if (!listing.id && listing.name) {
                listing.id = listing.name.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/^-|-$/g, '');
            }
            
            return listing;
        }
        
        // Update sync status UI
        function updateSyncStatus(success, message) {
            const statusBadge = document.getElementById('sheetsStatusBadge');
            const statusIcon = document.getElementById('sheetsStatusIcon');
            const statusText = document.getElementById('sheetsStatusText');
            const actionStatus = document.getElementById('sheetsActionStatus');
            const lastSync = document.getElementById('lastSyncTime');
            
            if (success) {
                statusBadge.style.background = '#34a853';
                statusIcon.textContent = '';
                statusText.textContent = 'Connected';
                lastSync.textContent = new Date().toLocaleTimeString();
            } else {
                statusBadge.style.background = '#ea4335';
                statusIcon.textContent = '';
                statusText.textContent = 'Error';
            }
            
            if (message) {
                actionStatus.textContent = message;
                setTimeout(() => {
                    actionStatus.textContent = '';
                }, 3000);
            }
        }
        
        // Load data from Google Sheets on page load
        // Tries Apps Script first (preferred), then CSV as fallback
        async function loadDataFromGoogleSheets() {
            updateSyncStatus(true, ' Loading...');
            
            // Check if running from file:// protocol (local file)
            const isFileProtocol = window.location.protocol === 'file:';
            
            // Try Apps Script first (better format, already working)
            if (GOOGLE_APPS_SCRIPT_URL && !GOOGLE_APPS_SCRIPT_URL.includes('YOUR_SCRIPT_ID')) {
                try {
                    console.log(' Loading data from Google Sheets via Apps Script...');
                    const url = GOOGLE_APPS_SCRIPT_URL + '?t=' + Date.now();
                    let response;
                    
                    // If file:// protocol, use proxy immediately (CORS doesn't work with file://)
                    if (isFileProtocol) {
                        console.log(' Running from file://, using proxy...');
                        console.warn(' Note: Opening HTML files directly (file://) has CORS limitations.');
                        console.warn('   For best results, host this file on a web server (e.g., GitHub Pages, Netlify, or local server).');
                        
                        try {
                            const proxyUrl = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(url);
                            response = await fetch(proxyUrl, {
                                method: 'GET',
                                mode: 'cors',
                                cache: 'no-cache'
                            });
                            
                            if (!response || !response.ok) {
                                throw new Error('Proxy request failed');
                            }
                        } catch (proxyError) {
                            console.error(' Proxy also failed due to CORS:', proxyError);
                            throw new Error('Cannot load from Apps Script when opening file directly. Please host on a web server or use CSV fallback.');
                        }
                    } else {
                        // Try direct fetch first (Apps Script should be configured for CORS)
                        try {
                            response = await fetch(url, {
                                method: 'GET',
                                mode: 'cors',
                                cache: 'no-cache'
                            }).catch(corsError => {
                                // CORS error - throw to be caught by outer catch
                                throw new Error('CORS_ERROR: ' + corsError.message);
                            });
                            
                            if (!response || !response.ok) {
                                throw new Error('Failed to fetch from Apps Script');
                            }
                        } catch (fetchError) {
                            // If CORS fails, try alternative proxy
                            if (fetchError.message.includes('CORS_ERROR') || fetchError.message.includes('access control')) {
                                console.log(' CORS blocked direct fetch, trying proxy...');
                                try {
                                    const proxyUrl = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(url);
                                    response = await fetch(proxyUrl, {
                                        method: 'GET',
                                        mode: 'cors',
                                        cache: 'no-cache'
                                    });
                                    
                                    if (!response || !response.ok) {
                                        throw new Error('Proxy also failed');
                                    }
                                } catch (proxyError) {
                                    console.error('Proxy also failed:', proxyError);
                                    throw new Error('Unable to fetch from Apps Script. Please check CORS configuration.');
                                }
                            } else {
                                throw fetchError;
                            }
                        }
                    }
                    
                    if (!response.ok) {
                        // Try to get error message from response
                        let errorMessage = `Failed to fetch from Apps Script (Status: ${response.status})`;
                        try {
                            const errorText = await response.text();
                            if (errorText) {
                                const errorJson = JSON.parse(errorText);
                                errorMessage = errorJson.error || errorMessage;
                            }
                        } catch (e) {
                            // If we can't parse error, use status code
                            if (response.status === 500) {
                                errorMessage = 'Apps Script returned 500 error - check your script for errors';
                            } else if (response.status === 403) {
                                errorMessage = 'Apps Script access denied - check permissions';
                            } else if (response.status === 404) {
                                errorMessage = 'Apps Script URL not found - check your URL';
                            }
                        }
                        throw new Error(errorMessage);
                    }
                    
                    const result = await response.json();
                    
                    if (result.success && result.listings && result.listings.length > 0) {
                        const listings = result.listings;
                        
<<<<<<< HEAD
                        // Extract filter options from listings
=======
                        // Preserve existing filterOptions when loading from Sheets
                        const existingFilterOptions = data.filterOptions || initialData.filterOptions;
                        // Extract filter options from listings (for merging)
>>>>>>> a97840a205826fe60553800d5e750c1313343f6d
                        const types = [...new Set(listings.map(l => l.type).filter(Boolean))].sort();
                        const areas = [...new Set(listings.map(l => l.area).filter(Boolean))].sort();
                        const amenities = [...new Set(listings.flatMap(l => l.amenities || []).filter(Boolean))].sort();
                        
                        data = {
                            listings: listings,
                            filterOptions: {
<<<<<<< HEAD
                                types: types,
                                areas: areas,
                                amenities: amenities
                            }
                        };
=======
                                types: existingFilterOptions.types || types,
                                areas: existingFilterOptions.areas || areas,
                                amenities: existingFilterOptions.amenities || amenities
                            }
                        };
                        // Save filterOptions to localStorage
                        saveFilterOptions();
>>>>>>> a97840a205826fe60553800d5e750c1313343f6d
                        
                        console.log(' Loaded ' + listings.length + ' listings from Google Sheets (Apps Script)');
                        updateSyncStatus(true, ` Loaded ${listings.length} listings`);
                        renderListings();
                        populateAdminFilters();
                        updateStats();
                        return;
                    }
                } catch (error) {
                    console.error(' Error loading from Apps Script:', error);
                    
                    // Check what type of error it is
                    if (error.message.includes('500')) {
                        updateSyncStatus(false, ' Apps Script error (500) - falling back to CSV');
                        console.error(' Your Google Apps Script has an internal error. Check the Apps Script execution logs.');
                        console.error('   Error:', error.message);
                    } else if (error.message.includes('CORS') || error.message.includes('access control') || error.message.includes('Origin null')) {
                        updateSyncStatus(false, ' CORS error - falling back to CSV');
                        console.warn(' CORS Error: Your Google Apps Script needs CORS headers configured.\n' +
                                    'Add this to your doGet function:\n' +
                                    'return ContentService\n' +
                                    '  .createTextOutput(JSON.stringify({success: true, listings: [...]}))\n' +
                                    '  .setMimeType(ContentService.MimeType.JSON);');
                    } else {
                        updateSyncStatus(false, ' Connection error - falling back to CSV');
                        console.error('   Error:', error.message);
                    }
                    
                    console.log(' Falling back to CSV...');
                }
            }
            
            // Fallback to CSV if Apps Script fails or not configured
            if (GOOGLE_SHEET_CSV_URL && !GOOGLE_SHEET_CSV_URL.includes('YOUR_SHEET_ID')) {
                try {
                    const cacheBustUrl = GOOGLE_SHEET_CSV_URL + (GOOGLE_SHEET_CSV_URL.includes('?') ? '&' : '?') + 't=' + Date.now();
                    console.log(' Loading data from Google Sheets CSV...');
                    
                    let response;
                    // If file:// protocol, try multiple approaches
                    if (isFileProtocol) {
                        // Try different proxy services
                        const proxies = [
                            'https://api.allorigins.win/raw?url=',
                            'https://corsproxy.io/?',
                            'https://cors-anywhere.herokuapp.com/'
                        ];
                        
                        let proxySuccess = false;
                        for (let i = 0; i < proxies.length && !proxySuccess; i++) {
                            try {
                                const proxyUrl = proxies[i] + encodeURIComponent(cacheBustUrl);
                                console.log(` Trying proxy ${i + 1}/${proxies.length}...`);
                                response = await fetch(proxyUrl, {
                                    method: 'GET',
                                    mode: 'cors',
                                    cache: 'no-cache'
                                });
                                
                                if (response && response.ok) {
                                    proxySuccess = true;
                                    console.log(' Proxy succeeded!');
                                    break;
                                }
                            } catch (proxyError) {
                                console.warn(` Proxy ${i + 1} failed:`, proxyError.message);
                                continue;
                            }
                        }
                        
                        if (!proxySuccess) {
                            // Last resort: try direct fetch (will likely fail but worth trying)
                            console.warn(' All proxies failed, trying direct CSV fetch...');
                            try {
                                response = await fetch(cacheBustUrl, {
                                    method: 'GET',
                                    mode: 'no-cors'
                                });
                                // If no-cors, we can't verify success, so throw
                                throw new Error('Direct CSV fetch from file:// not possible');
                            } catch (directError) {
                                throw new Error('Cannot load CSV from file:// protocol. All methods failed.');
                            }
                        }
                    } else {
                        response = await fetch(cacheBustUrl);
                    }
                    
                    if (!response || !response.ok) {
                        throw new Error(`Failed to fetch CSV (Status: ${response?.status || 'unknown'})`);
                    }
                    
                    const csvText = await response.text();
                    const parsed = parseCSV(csvText);
                    
                    if (parsed.dataRows && parsed.dataRows.length > 0) {
                        const listings = parsed.dataRows
                            .map(row => mapCSVRowToListing(row, parsed.headers))
                            .filter(listing => listing.name); // Only keep listings with names
                        
                        // Extract filter options from listings
<<<<<<< HEAD
=======
                        // Preserve existing filterOptions when loading from CSV
                        const existingFilterOptions = data.filterOptions || initialData.filterOptions;
                        // Extract filter options from listings (for merging)
>>>>>>> a97840a205826fe60553800d5e750c1313343f6d
                        const types = [...new Set(listings.map(l => l.type).filter(Boolean))].sort();
                        const areas = [...new Set(listings.map(l => l.area).filter(Boolean))].sort();
                        const amenities = [...new Set(listings.flatMap(l => l.amenities || []).filter(Boolean))].sort();
                        
                        data = {
                            listings: listings,
                            filterOptions: {
<<<<<<< HEAD
                                types: types,
                                areas: areas,
                                amenities: amenities
                            }
                        };
=======
                                types: existingFilterOptions.types || types,
                                areas: existingFilterOptions.areas || areas,
                                amenities: existingFilterOptions.amenities || amenities
                            }
                        };
                        // Save filterOptions to localStorage
                        saveFilterOptions();
>>>>>>> a97840a205826fe60553800d5e750c1313343f6d
                        
                        console.log(' Loaded ' + listings.length + ' listings from Google Sheets (CSV)');
                        updateSyncStatus(true, ` Loaded ${listings.length} listings (CSV)`);
                        renderListings();
                        populateAdminFilters();
                        updateStats();
                        return;
                    }
                } catch (error) {
                    console.error(' Error loading from CSV:', error);
                    updateSyncStatus(false, ' CSV fetch failed');
                }
            }
            
            // If both fail, use initial data
            console.log(' Could not load from Google Sheets, using initial data');
            updateSyncStatus(false, ' Using local data only');
            
            // Show warning if running from file://
            if (isFileProtocol) {
                console.error(' IMPORTANT: Opening from file:// protocol has CORS restrictions.');
                console.error('   To fix this, run a local web server:');
                console.error('   1. Open Terminal in this folder');
                console.error('   2. Run: python3 -m http.server 8000');
                console.error('   3. Open: http://localhost:8000/index-sheets.html');
                console.error('   OR host on GitHub Pages / Netlify / etc.');
                
                // Show alert to user
                setTimeout(() => {
                    alert(' CORS Error\n\n' +
                          'Opening HTML files directly (file://) has browser restrictions.\n\n' +
                          'To fix:\n' +
                          '1. Open Terminal in this folder\n' +
                          '2. Run: python3 -m http.server 8000\n' +
                          '3. Open: http://localhost:8000/index-sheets.html\n\n' +
                          'For now, using local data only.');
                }, 1000);
            }
        }
        
        // Reload data from Google Sheets (manual refresh)
        async function reloadFromSheets() {
            updateSyncStatus(true, ' Reloading...');
            await loadDataFromGoogleSheets();
        }
        
<<<<<<< HEAD
=======
        /**
         * Shows a confirmation dialog recommending CSV backup before saving to Sheets
         * @param {number} listingCount - Number of listings to be saved
         * @returns {Promise<boolean>} - true if user confirmed, false if cancelled
         */
        function showBackupConfirmation(listingCount) {
            return new Promise((resolve) => {
                // Create modal overlay
                const overlay = document.createElement('div');
                overlay.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; display: flex; align-items: center; justify-content: center;';
                
                // Create modal dialog
                const modal = document.createElement('div');
                modal.style.cssText = 'background: white; padding: 30px; border-radius: 8px; max-width: 500px; width: 90%; box-shadow: 0 4px 20px rgba(0,0,0,0.3);';
                
                modal.innerHTML = `
                    <div style="margin-bottom: 20px;">
                        <h2 style="margin: 0 0 15px 0; color: #212529; font-size: 24px;"> Backup Recommended</h2>
                        <p style="margin: 0 0 15px 0; color: #6c757d; line-height: 1.6;">
                            You're about to replace <strong>all existing data</strong> in Google Sheets with ${listingCount} listing(s).
                        </p>
                        <p style="margin: 0 0 20px 0; color: #6c757d; line-height: 1.6;">
                            <strong>We recommend downloading a CSV backup first</strong> in case you need to restore the previous data.
                        </p>
                    </div>
                    <div style="display: flex; gap: 10px; justify-content: flex-end; flex-wrap: wrap;">
                        <button id="backupCancelBtn" style="padding: 10px 20px; border: 1px solid #dee2e6; background: white; color: #212529; border-radius: 4px; cursor: pointer; font-weight: 500;">
                            Cancel
                        </button>
                        <button id="backupDownloadBtn" style="padding: 10px 20px; border: none; background: #4E6B52; color: white; border-radius: 4px; cursor: pointer; font-weight: 600;">
                             Download CSV Backup First
                        </button>
                        <button id="backupProceedBtn" style="padding: 10px 20px; border: none; background: #34a853; color: white; border-radius: 4px; cursor: pointer; font-weight: 600;">
                            Proceed Without Backup
                        </button>
                    </div>
                `;
                
                overlay.appendChild(modal);
                document.body.appendChild(overlay);
                
                // Button handlers
                document.getElementById('backupCancelBtn').onclick = () => {
                    document.body.removeChild(overlay);
                    resolve(false);
                };
                
                document.getElementById('backupDownloadBtn').onclick = () => {
                    // Download CSV backup
                    downloadCSV();
                    // Wait a moment for download to start, then proceed
                    setTimeout(() => {
                        document.body.removeChild(overlay);
                        resolve(true);
                    }, 500);
                };
                
                document.getElementById('backupProceedBtn').onclick = () => {
                    document.body.removeChild(overlay);
                    resolve(true);
                };
                
                // Close on overlay click
                overlay.onclick = (e) => {
                    if (e.target === overlay) {
                        document.body.removeChild(overlay);
                        resolve(false);
                    }
                };
            });
        }
        
>>>>>>> a97840a205826fe60553800d5e750c1313343f6d
        async function saveAllToSheets() {
            if (!GOOGLE_APPS_SCRIPT_URL || GOOGLE_APPS_SCRIPT_URL.includes('YOUR_SCRIPT_ID')) {
                alert(' Google Sheets not configured. Please set up your Apps Script URL.');
                return;
            }
            
            if (!data.listings || data.listings.length === 0) {
                alert(' No listings to save.');
                return;
            }
            
<<<<<<< HEAD
=======
            // Show confirmation dialog with backup recommendation
            const confirmed = await showBackupConfirmation(data.listings.length);
            if (!confirmed) {
                return; // User cancelled
            }
            
>>>>>>> a97840a205826fe60553800d5e750c1313343f6d
            updateSyncStatus(true, ` Saving ${data.listings.length} listings to Google Sheets (replacing all existing data)...`);
            
            try {
                // Send all listings at once with a "replaceAll" action
                // This tells the Apps Script to clear the sheet and replace with these listings
                const postData = JSON.stringify({
                    action: 'replaceAllListings',
                    listings: data.listings
                });
                
                let result = { success: false };
                
                // Try direct fetch first
                try {
                    const response = await fetch(GOOGLE_APPS_SCRIPT_URL, {
                        method: 'POST',
                        mode: 'cors',
                        headers: { 'Content-Type': 'application/json' },
                        body: postData
                    });
                    
                    try {
                        const responseText = await response.text();
                        result = responseText ? JSON.parse(responseText) : { success: true };
                    } catch (e) {
                        result = { success: true }; // Assume success if no response
                    }
                } catch (corsError) {
                    console.log('Direct POST failed due to CORS, trying no-cors mode...');
                    
                    // Try no-cors mode - sends request but can't read response
                    try {
                        await fetch(GOOGLE_APPS_SCRIPT_URL, {
                            method: 'POST',
                            mode: 'no-cors',
                            body: postData  // Send raw JSON string
                        });
                        
                        // With no-cors, we can't read response, so assume success
                        result = { success: true };
                        console.log('Sent via no-cors mode (can\'t verify response)');
                    } catch (e) {
                        console.error('No-cors also failed:', e);
                        result = { success: false, error: 'Failed to connect to Google Sheets' };
                        alert(' Unable to save to Google Sheets. Changes saved locally only.\n\n' +
                              'This may be due to CORS restrictions. Your Apps Script may need to be configured to allow CORS.');
                    }
                }
                
                if (result.success) {
                    updateSyncStatus(true, ` Replaced all data in Google Sheets with ${data.listings.length} listings`);
                    alert(` Successfully saved all ${data.listings.length} listings to Google Sheets!`);
                } else {
                    updateSyncStatus(false, ' Save failed');
                    alert(' Error saving to Google Sheets: ' + (result.error || 'Unknown error'));
                }
            } catch (error) {
                console.error('Error saving to Google Sheets:', error);
                updateSyncStatus(false, ' Save failed');
                alert(' Error saving to Google Sheets: ' + error.message);
            }
        }
        
        function renderListings(listings) {
            if (!listings) listings = data.listings;
            const grid = document.getElementById('listingsGrid');
            grid.innerHTML = '';
            
            listings.forEach(function(listing) {
                const card = document.createElement('div');
                card.className = 'listing-card';
                if (listing.featured) {
                    const badge = document.createElement('div');
                    badge.className = 'featured-badge';
                    badge.textContent = 'FEATURED';
                    card.appendChild(badge);
                }
                
                const img = document.createElement('img');
                img.src = listing.image1;
                img.alt = listing.name;
                img.className = 'listing-image';
                card.appendChild(img);
                
                const content = document.createElement('div');
                content.className = 'listing-content';
                content.innerHTML = 
                    '<h3>' + listing.name + '</h3>' +
                    '<div class="listing-meta">' +
                    '<span class="badge badge-type ' + getIconClass(listing.type) + '">' + listing.type + '</span>' +
                    '<span class="badge badge-area">' + listing.area + '</span>' +
                    '</div>' +
                    '<p class="listing-desc">' + listing.description.substring(0, 120) + '...</p>' +
                    '<div class="listing-amenities">' +
                    listing.amenities.slice(0, 4).map(function(a) { return '<span class="amenity">' + a + '</span>'; }).join('') +
                    (listing.amenities.length > 4 ? '<span class="amenity">+' + (listing.amenities.length - 4) + ' more</span>' : '') +
                    '</div>' +
                    '<div class="listing-contact">' +
                    (listing.phone ? 'Phone: ' + listing.phone + '<br>' : '') +
                    'Address: ' + listing.address +
                    '</div>';
                
                const actions = document.createElement('div');
                actions.className = 'listing-actions';
                
                const editBtn = document.createElement('button');
                editBtn.className = 'btn-edit';
                editBtn.textContent = 'Edit';
                editBtn.addEventListener('click', function() { 
                    editListing(listing.id); 
                });
                
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'btn-delete';
                
                // Check if this listing is waiting for confirmation
                if (deleteConfirmId === listing.id) {
                    deleteBtn.textContent = 'Confirm Delete?';
                    deleteBtn.style.background = '#dc2626';
                } else {
                    deleteBtn.textContent = 'Delete';
                    deleteBtn.style.background = '#E3795C';
                }
                
                deleteBtn.addEventListener('click', function() { 
                    deleteListing(listing.id); 
                });
                
                actions.appendChild(editBtn);
                actions.appendChild(deleteBtn);
                content.appendChild(actions);
                card.appendChild(content);
                grid.appendChild(card);
            });
            
            updateStats(listings);
        }
        
        function updateStats(listings) {
            if (!listings) listings = data.listings;
            document.getElementById('totalListings').textContent = listings.length;
            document.getElementById('featuredCount').textContent = listings.filter(function(l) { return l.featured; }).length;
            const uniqueAreas = {};
            listings.forEach(function(l) { uniqueAreas[l.area] = true; });
            document.getElementById('areasCount').textContent = Object.keys(uniqueAreas).length;
            const uniqueTypes = {};
            listings.forEach(function(l) { uniqueTypes[l.type] = true; });
            document.getElementById('typesCount').textContent = Object.keys(uniqueTypes).length;
        }
        
        let currentAdminTypeFilter = '';
        
        function filterListings() {
            const searchTerm = document.getElementById('adminSearchInput').value.toLowerCase().trim();
            const areaFilter = document.getElementById('adminAreaFilter').value;
            const amenityFilter = document.getElementById('adminAmenityFilter').value;
            
            const filtered = data.listings.filter(function(listing) {
                const searchableText = [
                    listing.name,
                    listing.type,
                    listing.area,
                    listing.description,
                    listing.amenities.join(' ')
                ].join(' ').toLowerCase();
                
                const matchesSearch = !searchTerm || searchableText.indexOf(searchTerm) > -1;
                const matchesType = !currentAdminTypeFilter || listing.type === currentAdminTypeFilter;
                const matchesArea = !areaFilter || listing.area === areaFilter;
                const matchesAmenity = !amenityFilter || listing.amenities.indexOf(amenityFilter) > -1;
                
                return matchesSearch && matchesType && matchesArea && matchesAmenity;
            });
            
            renderListings(filtered);
        }
        
        function filterAdminByType(type) {
            currentAdminTypeFilter = type;
            
            // Update button active states
            const buttons = document.querySelectorAll('#adminTab .type-filter-btn');
            buttons.forEach(function(btn) {
                btn.classList.remove('active');
                if (btn.dataset.type === type) {
                    btn.classList.add('active');
                }
            });
            
            filterListings();
        }
        
        function clearAdminFilters() {
            document.getElementById('adminSearchInput').value = '';
            document.getElementById('adminAreaFilter').value = '';
            document.getElementById('adminAmenityFilter').value = '';
            currentAdminTypeFilter = '';
            
            // Reset quick filter buttons
            const buttons = document.querySelectorAll('#adminTab .type-filter-btn');
            buttons.forEach(function(btn) {
                btn.classList.remove('active');
                if (btn.dataset.type === '') {
                    btn.classList.add('active');
                }
            });
            
            renderListings(data.listings);
        }
        
        function populateAdminFilters() {
            const areaFilter = document.getElementById('adminAreaFilter');
            if (areaFilter && areaFilter.options.length === 1) {
                data.filterOptions.areas.forEach(function(area) {
                    const option = document.createElement('option');
                    option.value = area;
                    option.textContent = area;
                    areaFilter.appendChild(option);
                });
            }
            
            const amenityFilter = document.getElementById('adminAmenityFilter');
            if (amenityFilter && amenityFilter.options.length === 1) {
                data.filterOptions.amenities.forEach(function(amenity) {
                    const option = document.createElement('option');
                    option.value = amenity;
                    option.textContent = amenity;
                    amenityFilter.appendChild(option);
                });
            }
        }
        
        function renderAmenitiesCheckboxes() {
            const container = document.getElementById('amenitiesCheckboxes');
            const amenities = data.filterOptions.amenities;
            container.innerHTML = amenities.map(function(amenity) {
                const id = 'amenity-' + amenity.replace(/\s+/g, '-');
                return '<div class="checkbox-item">' +
                    '<input type="checkbox" id="' + id + '" value="' + amenity + '" />' +
                    '<label for="' + id + '" style="font-weight: normal; margin: 0;">' + amenity + '</label>' +
                    '</div>';
            }).join('');
        }
        
        function openAddModal() {
            document.getElementById('modalTitle').textContent = 'Add New Listing';
            document.getElementById('listingForm').reset();
            document.getElementById('editingId').value = '';
<<<<<<< HEAD
=======
            // Ensure dropdowns are populated with current options
            updateTypeDropdown();
            updateAreaDropdown();
            renderAmenitiesCheckboxes();
>>>>>>> a97840a205826fe60553800d5e750c1313343f6d
            document.getElementById('listingModal').classList.add('active');
        }
        
        function editListing(id) {
            const listing = data.listings.find(function(l) { return l.id === id; });
            if (!listing) return;
            
<<<<<<< HEAD
=======
            // Ensure dropdowns are populated with current options
            updateTypeDropdown();
            updateAreaDropdown();
            renderAmenitiesCheckboxes();
            
>>>>>>> a97840a205826fe60553800d5e750c1313343f6d
            document.getElementById('modalTitle').textContent = 'Edit Listing';
            document.getElementById('editingId').value = id;
            document.getElementById('listingName').value = listing.name;
            document.getElementById('listingType').value = listing.type;
            document.getElementById('listingArea').value = listing.area;
            document.getElementById('listingDescription').value = listing.description;
            document.getElementById('listingImage1').value = listing.image1;
            document.getElementById('listingImage2').value = listing.image2 || '';
            document.getElementById('listingWebsite').value = listing.website;
            document.getElementById('listingPhone').value = listing.phone || '';
            document.getElementById('listingAddress').value = listing.address;
            document.getElementById('listingFeatured').checked = listing.featured || false;
            
            const checkboxes = document.querySelectorAll('#amenitiesCheckboxes input[type="checkbox"]');
            checkboxes.forEach(function(checkbox) {
                checkbox.checked = listing.amenities.indexOf(checkbox.value) > -1;
            });
            
            document.getElementById('listingModal').classList.add('active');
        }
        
        async function deleteListing(id) {
            const listing = data.listings.find(function(l) { return l.id === id; });
            
            if (!listing) {
                alert('Listing not found!');
                return;
            }
            
            // Check if this is the confirmation click
            if (deleteConfirmId === id) {
                // Confirmed - delete it
                deleteConfirmId = null;
                if (deleteConfirmTimeout) clearTimeout(deleteConfirmTimeout);
                
                // Delete from Google Sheets if configured
                if (GOOGLE_APPS_SCRIPT_URL && !GOOGLE_APPS_SCRIPT_URL.includes('YOUR_SCRIPT_ID')) {
                    try {
                        // Try direct POST, fallback to form submission
                        const postData = JSON.stringify({
                            action: 'deleteListing',
                            listingId: id
                        });
                        
                        let result = { success: false };
                        
                        try {
                            const response = await fetch(GOOGLE_APPS_SCRIPT_URL, {
                                method: 'POST',
                                mode: 'cors',
                                headers: {
                                    'Content-Type': 'application/json',
                                },
                                body: postData
                            });
                            
                            try {
                                const responseText = await response.text();
                                result = responseText ? JSON.parse(responseText) : { success: true };
                            } catch (e) {
                                result = { success: true };
                            }
                        } catch (corsError) {
                            // Use no-cors mode as fallback
                            try {
                                await fetch(GOOGLE_APPS_SCRIPT_URL, {
                                    method: 'POST',
                                    mode: 'no-cors',
                                    headers: {
                                        'Content-Type': 'application/json',
                                    },
                                    body: postData
                                });
                                result = { success: true };
                                console.log('Using no-cors mode for delete, assuming success');
                            } catch (e) {
                                result = { success: false, error: 'Failed to connect' };
                            }
                        }
                        if (result.success) {
                            // Update local data
                            data.listings = data.listings.filter(function(l) { return l.id !== id; });
                            updateSyncStatus(true, ' Deleted from Google Sheets');
                            
                            // Reload from Google Sheets to sync
                            setTimeout(() => loadDataFromGoogleSheets(), 1000);
                        } else {
                            throw new Error(result.error || 'Delete failed');
                        }
                    } catch (error) {
                        console.error('Error deleting from Google Sheets:', error);
                        updateSyncStatus(false, ' Delete failed');
                        alert(' Failed to delete from Google Sheets: ' + error.message + '\n\nDeleted locally only.');
                        
                        // Still delete locally
                        data.listings = data.listings.filter(function(l) { return l.id !== id; });
                    }
                } else {
                    // No Google Sheets configured - delete locally only
                    data.listings = data.listings.filter(function(l) { return l.id !== id; });
                    alert('Deleted "' + listing.name + '" (Local only - configure Google Sheets to sync)');
                }
                
                renderListings();
                
                const previewTab = document.getElementById('previewTab');
                if (previewTab && previewTab.classList.contains('active')) {
                    renderPreview();
                }
            } else {
                // First click - set confirmation needed
                deleteConfirmId = id;
                
                // Clear any existing timeout
                if (deleteConfirmTimeout) clearTimeout(deleteConfirmTimeout);
                
                // Re-render to update button text
                renderListings();
                
                // Reset after 3 seconds
                deleteConfirmTimeout = setTimeout(function() {
                    deleteConfirmId = null;
                    renderListings();
                }, 3000);
            }
        }
        
        async function saveListing(event) {
            event.preventDefault();
            
            const checkboxes = document.querySelectorAll('#amenitiesCheckboxes input[type="checkbox"]:checked');
            const selectedAmenities = [];
            checkboxes.forEach(function(cb) { selectedAmenities.push(cb.value); });
            
            const listing = {
                id: document.getElementById('editingId').value || Date.now().toString(),
                name: document.getElementById('listingName').value,
                type: document.getElementById('listingType').value,
                area: document.getElementById('listingArea').value,
                description: document.getElementById('listingDescription').value,
                image1: document.getElementById('listingImage1').value,
                image2: document.getElementById('listingImage2').value,
                website: document.getElementById('listingWebsite').value,
                phone: document.getElementById('listingPhone').value,
                address: document.getElementById('listingAddress').value,
                amenities: selectedAmenities,
                featured: document.getElementById('listingFeatured').checked
            };
            
            const editingId = document.getElementById('editingId').value;
            const isUpdate = !!editingId;
            
<<<<<<< HEAD
            // Save to Google Sheets if configured
            if (GOOGLE_APPS_SCRIPT_URL && !GOOGLE_APPS_SCRIPT_URL.includes('YOUR_SCRIPT_ID')) {
                try {
                    // Try direct POST first, then fallback methods
                    const postData = JSON.stringify({
                        action: 'saveListing',
                        listing: listing
                    });
                    
                    let result = { success: false };
                    
                    // Method 1: Try direct POST (if Apps Script is configured for CORS)
                    try {
                        const response = await fetch(GOOGLE_APPS_SCRIPT_URL, {
                            method: 'POST',
                            mode: 'cors',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: postData
                        });
                        
                        try {
                            const responseText = await response.text();
                            if (responseText) {
                                result = JSON.parse(responseText);
                            } else {
                                result = { success: true }; // Assume success if no response
                            }
                        } catch (e) {
                            result = { success: true }; // Assume success
                        }
                    } catch (corsError) {
                        console.log('Direct POST failed due to CORS, trying no-cors mode...');
                        
                        // Try no-cors mode - sends request but can't read response
                        // Note: no-cors mode strips Content-Type header, so Apps Script
                        // needs to handle raw body or we need to use a different method
                        // Note: no-cors mode has limitations - we can't verify the response
                        // But we can still try to send the data
                        console.warn(' CORS blocked direct request. Attempting no-cors fallback...');
                        console.warn('Note: Your Apps Script must read from e.postData.contents (not e.parameter.data)');
                        
                        result = { success: false, error: 'CORS blocked - Apps Script needs proper CORS headers' };
                        
                        // Show user-friendly message about Apps Script configuration
                        alert(' CORS Error\n\n' +
                              'Your Google Apps Script needs to be configured to:\n\n' +
                              '1. Accept CORS requests (add CORS headers)\n' +
                              '2. Read JSON from e.postData.contents (not e.parameter.data)\n\n' +
                              'Example doPost function:\n' +
                              'function doPost(e) {\n' +
                              '  const data = JSON.parse(e.postData.contents);\n' +
                              '  // ... your code ...\n' +
                              '  return ContentService\n' +
                              '    .createTextOutput(JSON.stringify({success: true}))\n' +
                              '    .setMimeType(ContentService.MimeType.JSON);\n' +
                              '}\n\n' +
                              'Changes saved locally only for now.');
                    }
                    
                    if (result.success) {
                        // Update local data
                        if (isUpdate) {
                            const index = data.listings.findIndex(function(l) { return l.id === editingId; });
                            if (index >= 0) {
                                data.listings[index] = listing;
                            }
                            updateSyncStatus(true, ' Updated in Google Sheets');
                        } else {
                            data.listings.push(listing);
                            updateSyncStatus(true, ' Added to Google Sheets');
                        }
                        
                        // Reload from Google Sheets to sync
                        setTimeout(() => loadDataFromGoogleSheets(), 1000);
                    } else {
                        throw new Error(result.error || 'Save failed');
                    }
                } catch (error) {
                    console.error('Error saving to Google Sheets:', error);
                    updateSyncStatus(false, ' Save failed');
                    alert(' Failed to save to Google Sheets: ' + error.message + '\n\nChanges saved locally only.');
                    
                    // Still update local data
                    if (isUpdate) {
                        const index = data.listings.findIndex(function(l) { return l.id === editingId; });
                        data.listings[index] = listing;
                    } else {
                        data.listings.push(listing);
                    }
                }
            } else {
                // No Google Sheets configured - save locally only
                if (isUpdate) {
                    const index = data.listings.findIndex(function(l) { return l.id === editingId; });
                    data.listings[index] = listing;
                    alert('"' + listing.name + '" has been updated! (Local only - configure Google Sheets to sync)');
                } else {
                    data.listings.push(listing);
                    alert('"' + listing.name + '" has been added! (Local only - configure Google Sheets to sync)');
                }
            }
            
=======
            // Save locally only - user must click "Save All to Google Sheets" to sync
            if (isUpdate) {
                const index = data.listings.findIndex(function(l) { return l.id === editingId; });
                if (index >= 0) {
                    data.listings[index] = listing;
                    alert('"' + listing.name + '" has been updated locally!\n\n Click "Save All to Google Sheets" to sync changes.');
                } else {
                    data.listings.push(listing);
                    alert('"' + listing.name + '" has been added locally!\n\n Click "Save All to Google Sheets" to sync changes.');
                }
            } else {
                data.listings.push(listing);
                alert('"' + listing.name + '" has been added locally!\n\n Click "Save All to Google Sheets" to sync changes.');
            }
            
            // Update the display and close modal
>>>>>>> a97840a205826fe60553800d5e750c1313343f6d
            renderListings();
            closeModal();
        }
        
        function closeModal() {
            document.getElementById('listingModal').classList.remove('active');
        }
        
        function exportData() {
            const format = confirm('Export as JSON data file?\n\nClick OK for JSON\nClick Cancel for full HTML admin backup');
            
            if (format) {
                const dataStr = JSON.stringify(data, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'adventure-directory-data-' + new Date().toISOString().split('T')[0] + '.json';
                link.click();
                URL.revokeObjectURL(url);
                alert('JSON data exported! Check your downloads folder.');
            } else {
                const htmlContent = document.documentElement.outerHTML;
                const htmlBlob = new Blob([htmlContent], { type: 'text/html' });
                const url = URL.createObjectURL(htmlBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'adventure-directory-admin-backup-' + new Date().toISOString().split('T')[0] + '.html';
                link.click();
                URL.revokeObjectURL(url);
                alert('Full admin backup exported! You can open this HTML file anytime to continue editing.');
            }
        }
        
        function quickExportJSON() {
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'data-' + new Date().toISOString().split('T')[0] + '.json';
            link.click();
            URL.revokeObjectURL(url);
            alert('JSON file downloaded! This contains all your listing data.');
        }
        
        // Download JSON backup (same as quickExportJSON but with different naming)
        function downloadJSON() {
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'nelson-county-listings-' + new Date().toISOString().split('T')[0] + '.json';
            link.click();
            URL.revokeObjectURL(url);
            updateSyncStatus(true, ' JSON backup downloaded');
        }
        
        document.getElementById('listingModal').addEventListener('click', function(e) {
            if (e.target === this) closeModal();
        });
        
        function switchTab(tab) {
            document.querySelectorAll('.tab-btn').forEach(function(btn) { btn.classList.remove('active'); });
            document.querySelectorAll('.tab-content').forEach(function(content) { content.classList.remove('active'); });
            
            const header = document.querySelector('.header');
            
            if (tab === 'admin') {
                document.querySelectorAll('.tab-btn')[0].classList.add('active');
                document.getElementById('adminTab').classList.add('active');
                header.style.display = 'block';
            } else if (tab === 'data') {
                document.querySelectorAll('.tab-btn')[1].classList.add('active');
                document.getElementById('dataTab').classList.add('active');
                header.style.display = 'block';
                renderDataTable();
<<<<<<< HEAD
            } else if (tab === 'code') {
                document.querySelectorAll('.tab-btn')[2].classList.add('active');
=======
            } else if (tab === 'settings') {
                document.querySelectorAll('.tab-btn')[2].classList.add('active');
                document.getElementById('settingsTab').classList.add('active');
                header.style.display = 'block';
                renderSettings();
            } else if (tab === 'code') {
                document.querySelectorAll('.tab-btn')[3].classList.add('active');
>>>>>>> a97840a205826fe60553800d5e750c1313343f6d
                document.getElementById('codeTab').classList.add('active');
                header.style.display = 'block';
                generateCode();
            } else if (tab === 'preview') {
<<<<<<< HEAD
                document.querySelectorAll('.tab-btn')[3].classList.add('active');
                document.getElementById('previewTab').classList.add('active');
                header.style.display = 'none';
                renderPreview();
            } else if (tab === 'deploy') {
                document.querySelectorAll('.tab-btn')[4].classList.add('active');
                document.getElementById('deployTab').classList.add('active');
=======
                document.querySelectorAll('.tab-btn')[4].classList.add('active');
                document.getElementById('previewTab').classList.add('active');
                header.style.display = 'none';
                renderPreview();
            } else if (tab === 'learn') {
                document.querySelectorAll('.tab-btn')[5].classList.add('active');
                document.getElementById('learnTab').classList.add('active');
>>>>>>> a97840a205826fe60553800d5e750c1313343f6d
                header.style.display = 'block';
            }
        }
        
<<<<<<< HEAD
=======
        // ==================================================
        // SETTINGS MANAGEMENT FUNCTIONS
        // ==================================================
        
        function renderSettings() {
            renderTypesList();
            renderAreasList();
            renderAmenitiesList();
        }
        
        function renderTypesList() {
            const container = document.getElementById('typesList');
            if (!container) return;
            
            container.innerHTML = data.filterOptions.types.map(function(type, index) {
                return '<div style="display: flex; align-items: center; justify-content: space-between; padding: 8px; background: #f8f9fa; border-radius: 4px; margin-bottom: 8px;">' +
                    '<span>' + type + '</span>' +
                    '<button onclick="removeType(' + index + ')" style="background: #dc3545; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 12px;">Remove</button>' +
                    '</div>';
            }).join('');
        }
        
        function renderAreasList() {
            const container = document.getElementById('areasList');
            if (!container) return;
            
            container.innerHTML = data.filterOptions.areas.map(function(area, index) {
                return '<div style="display: flex; align-items: center; justify-content: space-between; padding: 8px; background: #f8f9fa; border-radius: 4px; margin-bottom: 8px;">' +
                    '<span>' + area + '</span>' +
                    '<button onclick="removeArea(' + index + ')" style="background: #dc3545; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 12px;">Remove</button>' +
                    '</div>';
            }).join('');
        }
        
        function renderAmenitiesList() {
            const container = document.getElementById('amenitiesList');
            if (!container) return;
            
            container.innerHTML = data.filterOptions.amenities.map(function(amenity, index) {
                return '<div style="display: flex; align-items: center; justify-content: space-between; padding: 8px; background: #f8f9fa; border-radius: 4px;">' +
                    '<span>' + amenity + '</span>' +
                    '<button onclick="removeAmenity(' + index + ')" style="background: #dc3545; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 12px;">Remove</button>' +
                    '</div>';
            }).join('');
        }
        
        function addType() {
            const input = document.getElementById('newTypeInput');
            const value = input.value.trim();
            if (!value) return;
            
            if (data.filterOptions.types.indexOf(value) === -1) {
                data.filterOptions.types.push(value);
                saveFilterOptions();
                renderTypesList();
                updateTypeDropdown();
                input.value = '';
            } else {
                alert('This type already exists.');
            }
        }
        
        function removeType(index) {
            if (confirm('Are you sure you want to remove "' + data.filterOptions.types[index] + '"? This will not affect existing listings.')) {
                data.filterOptions.types.splice(index, 1);
                saveFilterOptions();
                renderTypesList();
                updateTypeDropdown();
            }
        }
        
        function addArea() {
            const input = document.getElementById('newAreaInput');
            const value = input.value.trim();
            if (!value) return;
            
            if (data.filterOptions.areas.indexOf(value) === -1) {
                data.filterOptions.areas.push(value);
                saveFilterOptions();
                renderAreasList();
                updateAreaDropdown();
                input.value = '';
            } else {
                alert('This area already exists.');
            }
        }
        
        function removeArea(index) {
            if (confirm('Are you sure you want to remove "' + data.filterOptions.areas[index] + '"? This will not affect existing listings.')) {
                data.filterOptions.areas.splice(index, 1);
                saveFilterOptions();
                renderAreasList();
                updateAreaDropdown();
            }
        }
        
        function addAmenity() {
            const input = document.getElementById('newAmenityInput');
            const value = input.value.trim();
            if (!value) return;
            
            if (data.filterOptions.amenities.indexOf(value) === -1) {
                data.filterOptions.amenities.push(value);
                saveFilterOptions();
                renderAmenitiesList();
                updateAmenitiesCheckboxes();
                input.value = '';
            } else {
                alert('This amenity already exists.');
            }
        }
        
        function removeAmenity(index) {
            if (confirm('Are you sure you want to remove "' + data.filterOptions.amenities[index] + '"? This will not affect existing listings.')) {
                data.filterOptions.amenities.splice(index, 1);
                saveFilterOptions();
                renderAmenitiesList();
                updateAmenitiesCheckboxes();
            }
        }
        
        function saveFilterOptions() {
            // Save to localStorage
            localStorage.setItem('nelsonCounty_filterOptions', JSON.stringify(data.filterOptions));
        }
        
        function updateTypeDropdown() {
            const select = document.getElementById('listingType');
            if (!select) return;
            
            const currentValue = select.value;
            select.innerHTML = '<option value="">Select Type</option>' +
                data.filterOptions.types.map(function(type) {
                    return '<option value="' + type + '">' + type + '</option>';
                }).join('');
            select.value = currentValue;
        }
        
        function updateAreaDropdown() {
            const select = document.getElementById('listingArea');
            if (!select) return;
            
            const currentValue = select.value;
            select.innerHTML = '<option value="">Select Area</option>' +
                data.filterOptions.areas.map(function(area) {
                    return '<option value="' + area + '">' + area + '</option>';
                }).join('');
            select.value = currentValue;
        }
        
        function updateAmenitiesCheckboxes() {
            renderAmenitiesCheckboxes();
        }
        
>>>>>>> a97840a205826fe60553800d5e750c1313343f6d
        // Icon mapping function - maps activity types to centralized icon library
        function getIconClass(type) {
            const typeMap = {
                'Wine': 'icon-wine',
                'Winery': 'icon-wine',
                'Beer': 'icon-beer',
                'Brewery': 'icon-beer',
                'Spirits': 'icon-spirits',
                'Distillery': 'icon-spirits',
                'Cocktails': 'icon-cocktail',
                'Cocktail Bar': 'icon-cocktail',
                'Coffee': 'icon-coffee',
                'Coffee Shop': 'icon-coffee',
                'Caf': 'icon-coffee',
                'Tea': 'icon-tea',
                'Tea Room': 'icon-tea',
                'Restaurant': 'icon-restaurant',
                'Dining': 'icon-restaurant',
                'Bakery': 'icon-bakery',
                'Patisserie': 'icon-bakery',
                'Cheese': 'icon-cheese',
                'Fromagerie': 'icon-cheese',
                'Chocolate': 'icon-chocolate',
                'Chocolatier': 'icon-chocolate',
                'Museum': 'icon-museum',
                'Art': 'icon-art',
                'Art Gallery': 'icon-gallery',
                'Gallery': 'icon-gallery',
                'Hiking': 'icon-hiking',
                'Hike': 'icon-hiking',
                'Trail': 'icon-hiking',
                'Cycling': 'icon-cycling',
                'Bike': 'icon-cycling',
                'Activity': 'icon-activity',
                'Activities': 'icon-activity',
                'Kayaking': 'icon-kayaking',
                'Kayak': 'icon-kayaking',
                'Spa': 'icon-spa',
                'Wellness': 'icon-wellness',
                'Health': 'icon-wellness',
                'Shopping': 'icon-shopping',
                'Shop': 'icon-shopping',
                'Market': 'icon-market',
                'Farmers Market': 'icon-market',
                'Concert': 'icon-concert',
                'Music': 'icon-concert',
                'Theater': 'icon-theater',
                'Theatre': 'icon-theater',
                'Cinema': 'icon-cinema',
                'Movie': 'icon-cinema',
                'Film': 'icon-cinema',
                'Festival': 'icon-festival',
                'Event': 'icon-festival',
                'Hotel': 'icon-hotel',
                'Lodging': 'icon-lodging',
                'B&B': 'icon-lodging',
                'Inn': 'icon-lodging',
                'Transport': 'icon-transport',
                'Transportation': 'icon-transport',
                'Train': 'icon-train',
                'Railway': 'icon-train',
                'Boat': 'icon-boat',
                'Ferry': 'icon-boat',
                'Scenic': 'icon-scenic',
                'Viewpoint': 'icon-viewpoint',
                'Lookout': 'icon-viewpoint',
                'Park': 'icon-park',
                'Garden': 'icon-garden',
                'Beach': 'icon-beach',
                'History': 'icon-history',
                'Historical': 'icon-history',
                'Heritage': 'icon-history',
                'Culture': 'icon-culture',
                'Cultural': 'icon-culture',
                'Architecture': 'icon-architecture',
                'Building': 'icon-architecture',
                'Local': 'icon-local',
                'Tour': 'icon-tour',
                'Guided Tour': 'icon-tour',
                'Workshop': 'icon-workshop',
                'Class': 'icon-class',
                'Course': 'icon-class',
                'Food': 'icon-food',
                'Cuisine': 'icon-food'
            };
            return typeMap[type] || 'icon-default';
        }
        
        function renderPreview(filteredListings) {
            const listings = filteredListings || data.listings;
            const grid = document.getElementById('previewGrid');
            grid.innerHTML = '';
            
            // Populate filter dropdowns if not already done
            const areaFilter = document.getElementById('previewAreaFilter');
            if (areaFilter.options.length === 1) {
                data.filterOptions.areas.forEach(function(area) {
                    const option = document.createElement('option');
                    option.value = area;
                    option.textContent = area;
                    areaFilter.appendChild(option);
                });
            }
            
            const amenityFilter = document.getElementById('previewAmenityFilter');
            if (amenityFilter.options.length === 1) {
                data.filterOptions.amenities.forEach(function(amenity) {
                    const option = document.createElement('option');
                    option.value = amenity;
                    option.textContent = amenity;
                    amenityFilter.appendChild(option);
                });
            }
            
            // Update results count
            document.getElementById('previewResultsCount').textContent = 'Showing ' + listings.length + ' listing' + (listings.length !== 1 ? 's' : '');
            
            listings.forEach(function(listing) {
                const card = document.createElement('div');
                card.className = 'flip-card';
                
                let flipBackTimeout = null;
                
                card.onclick = function(e) {
                    // Don't flip if clicking on links or buttons inside
                    if (e.target.tagName === 'A' || e.target.tagName === 'BUTTON' || e.target.closest('a') || e.target.closest('button')) {
                        return;
                    }
                    
                    // Close all other flipped cards
                    document.querySelectorAll('.flip-card.flipped').forEach(function(otherCard) {
                        if (otherCard !== card) {
                            otherCard.classList.remove('flipped');
                        }
                    });
                    
                    this.classList.toggle('flipped');
                    const overlay = document.getElementById('flipOverlay');
                    if (this.classList.contains('flipped')) {
                        overlay.classList.add('active');
                        document.body.style.overflow = 'hidden'; // Prevent scrolling
                    } else {
                        overlay.classList.remove('active');
                        document.body.style.overflow = '';
                    }
                    
                    if (flipBackTimeout) {
                        clearTimeout(flipBackTimeout);
                        flipBackTimeout = null;
                    }
                };
                
                const inner = document.createElement('div');
                inner.className = 'flip-card-inner';
                
                const front = document.createElement('div');
                front.className = 'flip-card-front';
                front.innerHTML = 
                    '<img src="' + listing.image1 + '" style="width: 100%; height: 200px; object-fit: cover;" />' +
                    '<div style="padding: 20px;">' +
                    '<h3 style="font-size: 20px; margin-bottom: 10px; color: var(--text-primary);">' + listing.name + '</h3>' +
                    '<div style="display: flex; gap: 8px; margin-bottom: 10px;">' +
                    '<span class="badge-type ' + getIconClass(listing.type) + '" data-type="' + listing.type + '" onclick="filterByBadge(event, \'type\', \'' + listing.type + '\')">' + listing.type + '</span>' +
                    '<span class="badge-area" data-area="' + listing.area + '" onclick="filterByBadge(event, \'area\', \'' + listing.area + '\')">' + listing.area + '</span>' +
                    '</div>' +
                    '<p style="font-size: 14px; color: var(--text-secondary); line-height: 1.5;">' + listing.description.substring(0, 100) + '...</p>' +
                    '</div>';
                
                const back = document.createElement('div');
                back.className = 'flip-card-back';
                
                // Build images HTML
                let imagesHTML = '<div class="flip-back-images">';
                imagesHTML += '<img src="' + listing.image1 + '" class="flip-back-image" />';
                if (listing.image2) {
                    imagesHTML += '<img src="' + listing.image2 + '" class="flip-back-image" />';
                }
                imagesHTML += '</div>';
                
                // Build amenities HTML if they exist
                let amenitiesHTML = '';
                if (listing.amenities && listing.amenities.length > 0) {
                    amenitiesHTML = 
                        '<div class="flip-tags-container">' +
                        '<div class="flip-tags-title">Amenities</div>' +
                        '<div class="flip-tags-list">' +
                        listing.amenities.map(function(amenity) {
                            return '<span class="badge-type" style="font-size: 10px; padding: 3px 8px;">' + amenity + '</span>';
                        }).join('') +
                        '</div>' +
                        '</div>';
                }
                
                back.innerHTML = 
                    '<button class="flip-close-btn" onclick="event.stopPropagation(); this.closest(\'.flip-card\').classList.remove(\'flipped\'); document.getElementById(\'flipOverlay\').classList.remove(\'active\'); document.body.style.overflow = \'\';">&times;</button>' +
                    imagesHTML +
                    '<h3 style="font-size: 22px; margin-bottom: 12px; color: var(--text-primary);">' + listing.name + '</h3>' +
                    '<div style="display: flex; gap: 8px; margin-bottom: 15px; flex-wrap: wrap;">' +
                    '<span class="badge-type ' + getIconClass(listing.type) + '">' + listing.type + '</span>' +
                    '<span class="badge-area">' + listing.area + '</span>' +
                    (listing.featured ? '<span class="badge-featured">Featured</span>' : '') +
                    '</div>' +
                    '<p style="font-size: 14px; color: var(--text-secondary); margin-bottom: 15px; line-height: 1.6;">' + listing.description + '</p>' +
                    amenitiesHTML +
                    '<a href="https://www.google.com/maps/search/?api=1&query=' + encodeURIComponent(listing.address) + '" target="_blank" class="card-info-item" style="text-decoration: none; cursor: pointer;" onclick="event.stopPropagation();">' +
                    '<div class="card-info-icon">' +
                    '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">' +
                    '<path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z" />' +
                    '<path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z" />' +
                    '</svg>' +
                    '</div>' +
                    '<div class="card-info-text" style="color: var(--text-secondary);">' + listing.address + '</div>' +
                    '</a>' +
                    (listing.phone ? 
                    '<a href="tel:' + listing.phone.replace(/[^0-9+]/g, '') + '" class="card-info-item" style="text-decoration: none; cursor: pointer;" onclick="event.stopPropagation();">' +
                    '<div class="card-info-icon">' +
                    '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">' +
                    '<path stroke-linecap="round" stroke-linejoin="round" d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 002.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 01-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 00-1.091-.852H4.5A2.25 2.25 0 002.25 4.5v2.25z" />' +
                    '</svg>' +
                    '</div>' +
                    '<div class="card-info-text" style="color: var(--text-secondary);">' + listing.phone + '</div>' +
                    '</a>' : '') +
                    '<div style="margin-top: auto; display: flex; gap: 10px; padding-top: 15px;">' +
                    '<a href="' + listing.website + '" target="_blank" style="flex: 1; background: #4E6B52; color: white; padding: 12px; text-align: center; border-radius: 6px; text-decoration: none; font-size: 13px; font-weight: 600; display: flex; align-items: center; justify-content: center; gap: 6px;" onclick="event.stopPropagation();">' +
                    '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" style="width: 18px; height: 18px;">' +
                    '<path stroke-linecap="round" stroke-linejoin="round" d="M12 21a9.004 9.004 0 008.716-6.747M12 21a9.004 9.004 0 01-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 017.843 4.582M12 3a8.997 8.997 0 00-7.843 4.582m15.686 0A11.953 11.953 0 0112 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0121 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0112 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 013 12c0-1.605.42-3.113 1.157-4.418" />' +
                    '</svg>' +
                    'Website' +
                    '</a>' +
                    '<a href="https://www.google.com/maps/search/?api=1&query=' + encodeURIComponent(listing.address) + '" target="_blank" style="flex: 1; background: #E3795C; color: white; padding: 12px; text-align: center; border-radius: 6px; text-decoration: none; font-size: 13px; font-weight: 600; display: flex; align-items: center; justify-content: center; gap: 6px;" onclick="event.stopPropagation();">' +
                    '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" style="width: 18px; height: 18px;">' +
                    '<path stroke-linecap="round" stroke-linejoin="round" d="M9 6.75V15m6-6v8.25m.503 3.498l4.875-2.437c.381-.19.622-.58.622-1.006V4.82c0-.836-.88-1.38-1.628-1.006l-3.869 1.934c-.317.159-.69.159-1.006 0L9.503 3.252a1.125 1.125 0 00-1.006 0L3.622 5.689C3.24 5.88 3 6.27 3 6.695V19.18c0 .836.88 1.38 1.628 1.006l3.869-1.934c.317-.159.69-.159 1.006 0l4.994 2.497c.317.158.69.158 1.006 0z" />' +
                    '</svg>' +
                    'Directions' +
                    '</a>' +
                    '</div>';
                
                inner.appendChild(front);
                inner.appendChild(back);
                card.appendChild(inner);
                grid.appendChild(card);
            });
        }
        
        let currentTypeFilter = '';
        
        function closeAllFlippedCards() {
            document.querySelectorAll('.flip-card.flipped').forEach(function(card) {
                card.classList.remove('flipped');
            });
            document.getElementById('flipOverlay').classList.remove('active');
            document.body.style.overflow = '';
        }
        
        function filterByBadge(event, filterType, value) {
            event.stopPropagation(); // Prevent card flip
            
            if (filterType === 'type') {
                currentTypeFilter = value;
                
                // Update button active states
                document.querySelectorAll('#previewTab .type-filter-btn').forEach(function(btn) {
                    btn.classList.remove('active');
                    if (btn.dataset.type === value) {
                        btn.classList.add('active');
                    }
                });
            } else if (filterType === 'area') {
                document.getElementById('previewAreaFilter').value = value;
            }
            
            filterPreview();
        }
        
        function filterPreview() {
            const searchTerm = document.getElementById('previewSearchInput').value.toLowerCase().trim();
            const areaFilter = document.getElementById('previewAreaFilter').value;
            const amenityFilter = document.getElementById('previewAmenityFilter').value;
            
            const filtered = data.listings.filter(function(listing) {
                // Search text
                const searchableText = [
                    listing.name,
                    listing.type,
                    listing.area,
                    listing.description,
                    listing.amenities.join(' ')
                ].join(' ').toLowerCase();
                
                const matchesSearch = !searchTerm || searchableText.indexOf(searchTerm) > -1;
                const matchesType = !currentTypeFilter || listing.type === currentTypeFilter;
                const matchesArea = !areaFilter || listing.area === areaFilter;
                const matchesAmenity = !amenityFilter || listing.amenities.indexOf(amenityFilter) > -1;
                
                return matchesSearch && matchesType && matchesArea && matchesAmenity;
            });
            
            renderPreview(filtered);
        }
        
        function clearPreviewFilters() {
            document.getElementById('previewSearchInput').value = '';
            document.getElementById('previewAreaFilter').value = '';
            document.getElementById('previewAmenityFilter').value = '';
            currentTypeFilter = '';
            
            // Reset quick filter buttons
            document.querySelectorAll('.type-filter-btn').forEach(function(btn) {
                btn.classList.remove('active');
                if (btn.dataset.type === '') {
                    btn.classList.add('active');
                }
            });
            
            renderPreview();
        }
        
        function toggleDarkMode() {
            const root = document.documentElement;
            const button = document.getElementById('darkModeToggle');
            const previewButton = document.getElementById('previewDarkToggle');
            
            const moonIcon = `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
            </svg>`;
            
            const sunIcon = `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="5"></circle>
                <line x1="12" y1="1" x2="12" y2="3"></line>
                <line x1="12" y1="21" x2="12" y2="23"></line>
                <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                <line x1="1" y1="12" x2="3" y2="12"></line>
                <line x1="21" y1="12" x2="23" y2="12"></line>
                <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
            </svg>`;
            
            if (root.classList.contains('dark-mode')) {
                root.classList.remove('dark-mode');
                localStorage.setItem('darkMode', 'disabled');
                if (button) {
                    button.innerHTML = moonIcon + '<span style="margin-left: 6px;">Dark Mode</span>';
                }
                if (previewButton) {
                    previewButton.innerHTML = moonIcon;
                }
            } else {
                root.classList.add('dark-mode');
                localStorage.setItem('darkMode', 'enabled');
                if (button) {
                    button.innerHTML = sunIcon + '<span style="margin-left: 6px;">Light Mode</span>';
                }
                if (previewButton) {
                    previewButton.innerHTML = sunIcon;
                }
            }
        }
        
        function loadDarkModePreference() {
            const darkMode = localStorage.getItem('darkMode');
            const root = document.documentElement;
            const button = document.getElementById('darkModeToggle');
            const previewButton = document.getElementById('previewDarkToggle');
            
            const sunIcon = `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="5"></circle>
                <line x1="12" y1="1" x2="12" y2="3"></line>
                <line x1="12" y1="21" x2="12" y2="23"></line>
                <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                <line x1="1" y1="12" x2="3" y2="12"></line>
                <line x1="21" y1="12" x2="23" y2="12"></line>
                <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
            </svg>`;
            
            if (darkMode === 'enabled') {
                root.classList.add('dark-mode');
                if (button) {
                    button.innerHTML = sunIcon + '<span style="margin-left: 6px;">Light Mode</span>';
                }
                if (previewButton) {
                    previewButton.innerHTML = sunIcon;
                }
            }
        }
        
        function generateCode() {
            const jsonData = JSON.stringify(data, null, 2);
            document.getElementById('jsonCode').value = jsonData;
            
            const embedCode = '<div id="adventure-directory"><\/div>\n<scr' + 'ipt src="https:\/\/your-domain.com\/directory.js"><\/scr' + 'ipt>\n<link rel="stylesheet" href="https:\/\/your-domain.com\/directory.css">';
            document.getElementById('embedCode').value = embedCode;
            
            // Extract all CSS from the style tag
            const styleTag = document.querySelector('style');
            const cssCode = styleTag ? styleTag.textContent : '';
            document.getElementById('cssCode').value = cssCode;
            
            const jsCode = 'const listings = ' + jsonData + ';\n\nfunction renderListings() {\n  const container = document.getElementById("adventure-directory");\n  listings.forEach(function(listing) {\n    const card = document.createElement("div");\n    card.className = "listing-card";\n    card.innerHTML = "<h3>" + listing.name + "</h3>";\n    container.appendChild(card);\n  });\n}\n\nrenderListings();';
            document.getElementById('jsCode').value = jsCode;
        }
        
        function copyCode(type) {
            let textarea;
            if (type === 'embed') textarea = document.getElementById('embedCode');
            else if (type === 'json') textarea = document.getElementById('jsonCode');
            else if (type === 'css') textarea = document.getElementById('cssCode');
            else if (type === 'js') textarea = document.getElementById('jsCode');
            
            textarea.select();
            document.execCommand('copy');
            alert('Copied to clipboard!');
        }
        
        function renderDataTable() {
            const tbody = document.getElementById('dataTableBody');
            tbody.innerHTML = '';
            
            data.listings.forEach(function(listing, index) {
                const row = document.createElement('tr');
                row.setAttribute('data-index', index);
                row.innerHTML = 
                    '<td class="cell-id">' + listing.id + '</td>' +
                    '<td class="cell-name"><input type="text" value="' + listing.name + '" data-field="name" /></td>' +
                    '<td class="cell-type"><select data-field="type">' +
                        data.filterOptions.types.map(function(t) { return '<option value="' + t + '" ' + (listing.type === t ? 'selected' : '') + '>' + t + '</option>'; }).join('') +
                    '</select></td>' +
                    '<td class="cell-area"><select data-field="area">' +
                        data.filterOptions.areas.map(function(a) { return '<option value="' + a + '" ' + (listing.area === a ? 'selected' : '') + '>' + a + '</option>'; }).join('') +
                    '</select></td>' +
                    '<td class="cell-description"><textarea data-field="description">' + listing.description + '</textarea></td>' +
                    '<td class="cell-image"><input type="text" value="' + (listing.image1 || '') + '" data-field="image1" placeholder="Image URL or base64" /></td>' +
                    '<td class="cell-image"><input type="text" value="' + (listing.image2 || '') + '" data-field="image2" placeholder="Image URL or base64" /></td>' +
                    '<td class="cell-website"><input type="url" value="' + listing.website + '" data-field="website" /></td>' +
                    '<td class="cell-phone"><input type="tel" value="' + (listing.phone || '') + '" data-field="phone" /></td>' +
                    '<td class="cell-address"><input type="text" value="' + listing.address + '" data-field="address" /></td>' +
                    '<td class="cell-amenities"><textarea data-field="amenities">' + listing.amenities.join(', ') + '</textarea></td>' +
                    '<td class="cell-featured"><input type="checkbox" ' + (listing.featured ? 'checked' : '') + ' data-field="featured" /></td>' +
                    '<td class="cell-actions">' +
                        '<button class="btn-table-delete" onclick="deleteFromTable(' + index + ')" style="background: ' + (deleteConfirmId === listing.id ? '#dc2626' : '#E3795C') + ';">' +
                        (deleteConfirmId === listing.id ? 'Confirm?' : 'Delete') +
                        '</button>' +
                    '</td>';
                tbody.appendChild(row);
            });
        }
        
        function saveTableChanges() {
            const rows = Array.from(document.querySelectorAll('#dataTableBody tr'));
            let changeCount = 0;
            
            rows.forEach(function(row) {
                const index = parseInt(row.getAttribute('data-index'));
                const listing = data.listings[index];
                
                // Get all input fields
                const inputs = row.querySelectorAll('[data-field]');
                inputs.forEach(function(input) {
                    const field = input.getAttribute('data-field');
                    let newValue;
                    
                    if (input.type === 'checkbox') {
                        newValue = input.checked;
                    } else if (field === 'amenities') {
                        // Convert comma-separated string to array
                        newValue = input.value.split(',').map(function(a) { return a.trim(); }).filter(function(a) { return a.length > 0; });
                    } else {
                        newValue = input.value;
                    }
                    
                    // Compare arrays properly for amenities
                    if (field === 'amenities') {
                        if (JSON.stringify(listing[field]) !== JSON.stringify(newValue)) {
                            listing[field] = newValue;
                            changeCount++;
                        }
                    } else if (listing[field] !== newValue) {
                        listing[field] = newValue;
                        changeCount++;
                    }
                });
            });
            
            // Update all views
            renderListings();
            const previewTab = document.getElementById('previewTab');
            if (previewTab.classList.contains('active')) {
                renderPreview();
            }
            
<<<<<<< HEAD
            // Save to Google Sheets if configured
            if (changeCount > 0 && GOOGLE_APPS_SCRIPT_URL && !GOOGLE_APPS_SCRIPT_URL.includes('YOUR_SCRIPT_ID')) {
                updateSyncStatus(true, ' Saving to Google Sheets...');
                
                // Save each changed listing to Google Sheets
                const changedListings = rows.filter(function(row) {
                    const index = parseInt(row.getAttribute('data-index'));
                    const listing = data.listings[index];
                    const inputs = row.querySelectorAll('[data-field]');
                    let hasChanges = false;
                    
                    inputs.forEach(function(input) {
                        const field = input.getAttribute('data-field');
                        let newValue;
                        
                        if (input.type === 'checkbox') {
                            newValue = input.checked;
                        } else if (field === 'amenities') {
                            newValue = input.value.split(',').map(function(a) { return a.trim(); }).filter(function(a) { return a.length > 0; });
                        } else {
                            newValue = input.value;
                        }
                        
                        if (field === 'amenities') {
                            if (JSON.stringify(listing[field]) !== JSON.stringify(newValue)) {
                                hasChanges = true;
                            }
                        } else if (listing[field] !== newValue) {
                            hasChanges = true;
                        }
                    });
                    
                    return hasChanges;
                }).map(function(row) {
                    const index = parseInt(row.getAttribute('data-index'));
                    return data.listings[index];
                });
                
                // Save all changed listings
                Promise.all(changedListings.map(listing => {
                    const postData = JSON.stringify({
                        action: 'saveListing',
                        listing: listing
                    });
                    
                    // Try direct fetch first, fallback to no-cors mode
                    return fetch(GOOGLE_APPS_SCRIPT_URL, {
                        method: 'POST',
                        mode: 'cors',
                        headers: { 'Content-Type': 'application/json' },
                        body: postData
                    }).then(async r => {
                        try {
                            const text = await r.text();
                            return text ? JSON.parse(text) : { success: true };
                        } catch (e) {
                            return { success: true };
                        }
                    }).catch(corsError => {
                        // Fallback: no-cors mode (sends request but can't read response)
                        return fetch(GOOGLE_APPS_SCRIPT_URL, {
                            method: 'POST',
                            mode: 'no-cors',
                            headers: { 'Content-Type': 'application/json' },
                            body: postData
                        }).then(() => {
                            // With no-cors, assume success if no error
                            return { success: true };
                        }).catch(() => {
                            return { success: false };
                        });
                    });
                })).then(results => {
                    const successCount = results.filter(r => r.success).length;
                    updateSyncStatus(true, ` Saved ${successCount} listing(s) to Google Sheets`);
                }).catch(error => {
                    console.error('Error saving to Google Sheets:', error);
                    updateSyncStatus(false, ' Some saves failed');
                });
            }
            
            alert('Table updated! ' + changeCount + ' field(s) changed.');
=======
            // Changes saved locally only - user must click "Save All to Google Sheets" to sync
            if (changeCount > 0) {
                alert('Table updated! ' + changeCount + ' field(s) changed locally.\n\n Click "Save All to Google Sheets" to sync changes.');
            } else {
                alert('No changes detected.');
            }
>>>>>>> a97840a205826fe60553800d5e750c1313343f6d
        }
        
        function deleteFromTable(index) {
            const listing = data.listings[index];
            
            // Check if this is the confirmation click
            if (deleteConfirmId === listing.id) {
                // Confirmed - delete it
                data.listings.splice(index, 1);
                deleteConfirmId = null;
                if (deleteConfirmTimeout) clearTimeout(deleteConfirmTimeout);
                
                renderDataTable();
                renderListings();
                
                const previewTab = document.getElementById('previewTab');
                if (previewTab.classList.contains('active')) {
                    renderPreview();
                }
                
                alert('Deleted: ' + listing.name);
            } else {
                // First click - set confirmation needed
                deleteConfirmId = listing.id;
                
                // Clear any existing timeout
                if (deleteConfirmTimeout) clearTimeout(deleteConfirmTimeout);
                
                // Re-render to update button text
                renderDataTable();
                
                // Reset after 3 seconds
                deleteConfirmTimeout = setTimeout(function() {
                    deleteConfirmId = null;
                    renderDataTable();
                }, 3000);
            }
        }
        
        function downloadCSV() {
            try {
                console.log('Downloading CSV...');
                const headers = ['ID', 'Name', 'Type', 'Area', 'Description', 'Image1', 'Image2', 'Website', 'Phone', 'Address', 'Amenities', 'Featured'];
                const rows = data.listings.map(function(listing) {
                    return [
                        listing.id,
                        '"' + (listing.name || '').replace(/"/g, '""') + '"',
                        listing.type,
                        listing.area,
                        '"' + (listing.description || '').replace(/"/g, '""') + '"',
                        '"' + (listing.image1 || '').replace(/"/g, '""') + '"',
                        '"' + (listing.image2 || '').replace(/"/g, '""') + '"',
                        listing.website,
                        listing.phone || '',
                        '"' + (listing.address || '').replace(/"/g, '""') + '"',
                        '"' + listing.amenities.join('; ') + '"',
                        listing.featured ? 'true' : 'false'
                    ].join(',');
                });
                
                const csv = [headers.join(',')].concat(rows).join('\n');
                console.log('CSV generated, length:', csv.length);
                
                const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'listings-' + new Date().toISOString().split('T')[0] + '.csv';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
                
                console.log('CSV download triggered');
                alert('CSV downloaded!');
            } catch (error) {
                console.error('Error downloading CSV:', error);
                alert('Error downloading CSV: ' + error.message);
            }
        }
        
        function handleCSVUpload(event) {
            try {
                console.log('CSV upload started');
                const file = event.target.files[0];
                if (!file) {
                    console.log('No file selected');
                    return;
                }
                
                console.log('Reading file:', file.name);
                const reader = new FileReader();
                
                reader.onerror = function(error) {
                    console.error('File read error:', error);
                    alert('Error reading file: ' + error);
                };
                
                reader.onload = function(e) {
                    try {
                        console.log('File loaded, parsing CSV...');
                        const text = e.target.result;
                        const lines = text.split('\n');
                        console.log('Total lines:', lines.length);
                        
                        const headers = lines[0].split(',');
                        console.log('Headers:', headers);
                        
                        const newListings = [];
                        for (let i = 1; i < lines.length; i++) {
                            if (!lines[i].trim()) continue;
                            
                            // Simple CSV parsing (handles quoted fields)
                            const values = [];
                            let currentValue = '';
                            let inQuotes = false;
                            
                            for (let j = 0; j < lines[i].length; j++) {
                                const char = lines[i][j];
                                if (char === '"') {
                                    inQuotes = !inQuotes;
                                } else if (char === ',' && !inQuotes) {
                                    values.push(currentValue.trim());
                                    currentValue = '';
                                } else {
                                    currentValue += char;
                                }
                            }
                            values.push(currentValue.trim());
                            
                            // Clean values
                            const cleanValues = values.map(function(v) {
                                return v.replace(/^"/, '').replace(/"$/, '').replace(/""/g, '"');
                            });
                            
                            const listing = {
                                id: cleanValues[0] || Date.now().toString() + '-' + i,
                                name: cleanValues[1] || 'Unnamed',
                                type: cleanValues[2] || 'Brewery',
                                area: cleanValues[3] || 'Afton',
                                description: cleanValues[4] || '',
                                image1: cleanValues[5] || '',
                                image2: cleanValues[6] || '',
                                website: cleanValues[7] || '',
                                phone: cleanValues[8] || '',
                                address: cleanValues[9] || '',
                                amenities: cleanValues[10] ? cleanValues[10].split(';').map(function(a) { return a.trim(); }).filter(function(a) { return a; }) : [],
                                featured: cleanValues[11] === 'true'
                            };
                            
                            newListings.push(listing);
                        }
                        
                        console.log('Parsed listings:', newListings.length);
                        
                        if (newListings.length === 0) {
                            alert('No valid listings found in CSV file.');
                            return;
                        }
                        
                        if (confirm('Upload ' + newListings.length + ' listings? This will replace all current listings.')) {
                            data.listings = newListings;
                            renderDataTable();
                            renderListings();
                            
                            // Update preview if active
                            const previewTab = document.getElementById('previewTab');
                            if (previewTab.classList.contains('active')) {
                                renderPreview();
                            }
                            
<<<<<<< HEAD
                            // Save all listings to Google Sheets if configured
                            if (GOOGLE_APPS_SCRIPT_URL && !GOOGLE_APPS_SCRIPT_URL.includes('YOUR_SCRIPT_ID')) {
                                updateSyncStatus(true, ' Saving ' + newListings.length + ' listings to Google Sheets...');
                                
                                Promise.all(newListings.map(listing => {
                                    const postData = JSON.stringify({
                                        action: 'saveListing',
                                        listing: listing
                                    });
                                    
                                    // Try direct fetch first, fallback to no-cors mode
                                    return fetch(GOOGLE_APPS_SCRIPT_URL, {
                                        method: 'POST',
                                        mode: 'cors',
                                        headers: { 'Content-Type': 'application/json' },
                                        body: postData
                                    }).then(async r => {
                                        try {
                                            const text = await r.text();
                                            return text ? JSON.parse(text) : { success: true };
                                        } catch (e) {
                                            return { success: true };
                                        }
                                    }).catch(corsError => {
                                        // Fallback: no-cors mode (sends request but can't read response)
                                        return fetch(GOOGLE_APPS_SCRIPT_URL, {
                                            method: 'POST',
                                            mode: 'no-cors',
                                            headers: { 'Content-Type': 'application/json' },
                                            body: postData
                                        }).then(() => {
                                            // With no-cors, assume success if no error
                                            return { success: true };
                                        }).catch(() => {
                                            return { success: false };
                                        });
                                    });
                                })).then(results => {
                                    const successCount = results.filter(r => r.success).length;
                                    updateSyncStatus(true, ` Saved ${successCount}/${newListings.length} listings to Google Sheets`);
                                    alert('CSV uploaded successfully! ' + newListings.length + ' listings imported. ' + successCount + ' saved to Google Sheets.');
                                }).catch(error => {
                                    console.error('Error saving to Google Sheets:', error);
                                    updateSyncStatus(false, ' Some saves failed');
                                    alert('CSV uploaded! ' + newListings.length + ' listings imported locally, but some failed to save to Google Sheets.');
                                });
                            } else {
                                alert('CSV uploaded successfully! ' + newListings.length + ' listings imported. (Local only - configure Google Sheets to sync)');
                            }
=======
                            // CSV imported locally only - user must click "Save All to Google Sheets" to sync
                            alert('CSV uploaded successfully! ' + newListings.length + ' listings imported locally.\n\n Click "Save All to Google Sheets" to sync changes.');
>>>>>>> a97840a205826fe60553800d5e750c1313343f6d
                        }
                        
                        // Reset file input
                        event.target.value = '';
                        
                    } catch (parseError) {
                        console.error('Error parsing CSV:', parseError);
                        alert('Error parsing CSV file: ' + parseError.message);
                    }
                };
                
                reader.readAsText(file);
                
            } catch (error) {
                console.error('Error in handleCSVUpload:', error);
                alert('Error uploading CSV: ' + error.message);
            }
        }
        
        window.addEventListener("DOMContentLoaded", async function() {
            await loadDataFromGoogleSheets();
            
<<<<<<< HEAD
=======
            // Initialize form dropdowns with dynamic options
            updateTypeDropdown();
            updateAreaDropdown();
>>>>>>> a97840a205826fe60553800d5e750c1313343f6d
            renderAmenitiesCheckboxes();
            renderListings();
            updateStats();
            loadDarkModePreference();
            populateAdminFilters();
            
            // Add event listeners to quick filter buttons
            document.querySelectorAll('.type-filter-btn').forEach(function(btn) {
                btn.addEventListener('click', function() {
                    // Remove active class from all buttons
                    document.querySelectorAll('.type-filter-btn').forEach(function(b) {
                        b.classList.remove('active');
                    });
                    
                    // Add active class to clicked button
                    this.classList.add('active');
                    
                    // Set the current type filter
                    currentTypeFilter = this.dataset.type;
                    
                    // Apply filter
                    filterPreview();
                });
            });
        });
        
        // ==================================================
        // GITHUB INTEGRATION FUNCTIONS
        // ==================================================
        
        async function saveToGitHub() {
            const token = document.getElementById('githubToken').value.trim();
            const username = document.getElementById('githubUsername').value.trim();
            const repo = document.getElementById('githubRepo').value.trim();
            const path = document.getElementById('githubPath').value.trim();
            const statusDiv = document.getElementById('githubStatus');
            
            // Validation
            if (!token) {
                statusDiv.textContent = ' Please enter your GitHub token';
                statusDiv.style.color = '#dc3545';
                return;
            }
            if (!username || !repo || !path) {
                statusDiv.textContent = ' Please fill in all fields';
                statusDiv.style.color = '#dc3545';
                return;
            }
            
            try {
                statusDiv.textContent = ' Saving to GitHub...';
                statusDiv.style.color = '#ffc107';
                
                // Get your data object (this already exists in your admin panel)
                const jsonData = data;
                
                // Convert to base64 (required by GitHub API)
                let content;
                try {
                    content = btoa(JSON.stringify(jsonData, null, 2));
                } catch (e) {
                    // If btoa fails due to special characters, use UTF-8 encoding
                    const jsonString = JSON.stringify(jsonData, null, 2);
                    content = btoa(unescape(encodeURIComponent(jsonString)));
                }
                
                // Check if file exists to get SHA (required for updates)
                const getUrl = `https://api.github.com/repos/${username}/${repo}/contents/${path}`;
                let sha = null;
                
                try {
                    const getRes = await fetch(getUrl, {
                        headers: { 
                            'Authorization': `token ${token}`,
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    });
                    
                    if (getRes.ok) {
                        const fileData = await getRes.json();
                        sha = fileData.sha;
                    }
                } catch (e) {
                    console.log('File does not exist yet, will create new file');
                }
                
                // Commit the file
                const commitMessage = `Update from admin panel - ${new Date().toISOString()}`;
                const putRes = await fetch(getUrl, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `token ${token}`,
                        'Content-Type': 'application/json',
                        'Accept': 'application/vnd.github.v3+json'
                    },
                    body: JSON.stringify({
                        message: commitMessage,
                        content: content,
                        sha: sha
                    })
                });
                
                if (putRes.ok) {
                    const result = await putRes.json();
                    statusDiv.textContent = ' Successfully saved to GitHub!';
                    statusDiv.style.color = '#28a745';
                    
                    // Save config to localStorage so user doesn't have to re-enter
                    localStorage.setItem('github_username', username);
                    localStorage.setItem('github_repo', repo);
                    localStorage.setItem('github_path', path);
                    
                    console.log('File saved at:', result.content.html_url);
                } else {
                    const error = await putRes.json();
                    console.error('GitHub API Error:', error);
                    statusDiv.textContent = ` Error: ${error.message}`;
                    statusDiv.style.color = '#dc3545';
                }
                
            } catch (error) {
                console.error('Save to GitHub error:', error);
                statusDiv.textContent = ` Error: ${error.message}`;
                statusDiv.style.color = '#dc3545';
            }
        }
        
        function downloadJSON() {
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'adventure-directory-data-' + new Date().toISOString().split('T')[0] + '.json';
            link.click();
            URL.revokeObjectURL(url);
            
            const statusDiv = document.getElementById('githubStatus');
            if (statusDiv) {
                statusDiv.textContent = ' JSON file downloaded!';
                statusDiv.style.color = '#28a745';
                setTimeout(() => { statusDiv.textContent = ''; }, 3000);
            }
        }
        
        // Load saved GitHub config from localStorage on page load
        document.addEventListener('DOMContentLoaded', function() {
            const savedUsername = localStorage.getItem('github_username');
            const savedRepo = localStorage.getItem('github_repo');
            const savedPath = localStorage.getItem('github_path');
            
            if (savedUsername) document.getElementById('githubUsername').value = savedUsername;
            if (savedRepo) document.getElementById('githubRepo').value = savedRepo;
            if (savedPath) document.getElementById('githubPath').value = savedPath;
        });
        
        // ==================================================
        // GOOGLE OAUTH AUTHENTICATION
        // ==================================================
        
        //  CONFIGURATION: Google OAuth Client ID
        // Get this from: https://console.cloud.google.com/apis/credentials
        // 1. Create OAuth 2.0 Client ID
        // 2. Application type: Web application
        // 3. Authorized JavaScript origins: Add your domain (e.g., https://yourdomain.com)
        // 4. Authorized redirect URIs: Add your domain
        const GOOGLE_OAUTH_CLIENT_ID = '1087570888908-4g9jboc2hoi1dl9t9qs5hmnak6ct1t24.apps.googleusercontent.com';
        
        //  AUTHORIZED EMAILS: List of Google email addresses that can access the admin panel
        // SECURITY NOTE: For better security, move this list to your Google Apps Script
        // and fetch it via an API call instead of storing it in the client code.
        const AUTHORIZED_EMAILS = [
            'ernest@oddplusevenstudio.com',
            // Add more authorized emails here (one per line, comma-separated)
            // Example: 'admin@example.com',
            // Example: 'user@example.com',
            // Example: 'team-member@example.com',
        ];
        
        // Parse JWT token to get user info
        function parseJwt(token) {
            try {
                const base64Url = token.split('.')[1];
                const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
                const jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
                    return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
                }).join(''));
                return JSON.parse(jsonPayload);
            } catch (e) {
                console.error('Error parsing JWT:', e);
                return null;
            }
        }
        
        // Handle Google OAuth callback
        function handleCredentialResponse(response) {
            const errorDiv = document.getElementById('loginError');
            const errorText = document.getElementById('loginErrorText');
            
            try {
                // Parse the JWT token
                const payload = parseJwt(response.credential);
                
                if (!payload || !payload.email) {
                    throw new Error('Invalid token - missing email');
                }
                
                const userEmail = payload.email;
                const userName = payload.name || userEmail;
                
                console.log('Google Sign-In successful:', userEmail);
                
                // Check if email is authorized
                if (AUTHORIZED_EMAILS.includes(userEmail)) {
                    // Authorized - hide login overlay
                    document.getElementById('loginOverlay').style.display = 'none';
                    
                    // Store session info
                    sessionStorage.setItem('adminLoggedIn', 'true');
                    sessionStorage.setItem('adminEmail', userEmail);
                    sessionStorage.setItem('adminName', userName);
                    
                    // Show success message briefly
                    const overlay = document.getElementById('loginOverlay');
                    const overlayContent = overlay.querySelector('div');
                    overlayContent.innerHTML = `
                        <div style="text-align: center; padding: 40px;">
                            <div style="color: #22c55e; font-size: 48px; margin-bottom: 20px;"></div>
                            <h2 style="color: #4E6B52; margin: 0 0 10px 0;">Welcome, ${userName}!</h2>
                            <p style="color: #6c757d; margin: 0;">Loading admin panel...</p>
                        </div>
                    `;
                    
                    setTimeout(() => {
                        overlay.style.display = 'none';
                    }, 1000);
                    
                } else {
                    // Not authorized
                    errorText.textContent = `Access denied. ${userEmail} is not authorized to access this admin panel.`;
                    errorDiv.style.display = 'block';
                    
                    // Shake animation
                    const overlay = document.getElementById('loginOverlay');
                    overlay.style.animation = 'shake 0.5s';
                    setTimeout(() => { overlay.style.animation = ''; }, 500);
                    
                    // Log the unauthorized attempt
                    console.warn('Unauthorized access attempt:', userEmail);
                }
            } catch (error) {
                console.error('Error processing Google Sign-In:', error);
                errorText.textContent = 'Authentication failed. Please try again.';
                errorDiv.style.display = 'block';
            }
        }
        
        // Initialize Google Sign-In
        let initAttempts = 0;
        const MAX_INIT_ATTEMPTS = 50; // 5 seconds max wait
        
        function initializeGoogleSignIn() {
            initAttempts++;
            const loadingMessage = document.getElementById('loadingMessage');
            const errorDiv = document.getElementById('loginError');
            const errorText = document.getElementById('loginErrorText');
            const buttonContainer = document.getElementById('g_id_onload');
            const fallbackContainer = document.getElementById('fallbackButtonContainer');
            
            console.log('Initializing Google Sign-In, attempt:', initAttempts);
            console.log('Client ID:', GOOGLE_OAUTH_CLIENT_ID);
            console.log('Google object:', typeof google !== 'undefined' ? 'exists' : 'missing');
            
            // Check if Client ID is configured
            if (GOOGLE_OAUTH_CLIENT_ID === 'YOUR_CLIENT_ID.apps.googleusercontent.com') {
                if (loadingMessage) loadingMessage.style.display = 'none';
                errorText.innerHTML = `
                    <strong> Configuration Required:</strong><br>
                    Please set up Google OAuth Client ID in the code.<br>
                    <small>See line ~5341 in index-sheets.html<br>
                    Replace 'YOUR_CLIENT_ID.apps.googleusercontent.com' with your actual Client ID from Google Cloud Console</small>
                `;
                errorDiv.style.display = 'block';
                return;
            }
            
            // Wait for Google Identity Services to load
            if (typeof google !== 'undefined' && google.accounts && google.accounts.id) {
                try {
                    if (loadingMessage) loadingMessage.style.display = 'none';
                    
                    console.log(' Google Identity Services loaded, initializing...');
                    console.log(' Current origin:', window.location.origin);
                    console.log(' Client ID:', GOOGLE_OAUTH_CLIENT_ID);
                    
                    google.accounts.id.initialize({
                        client_id: GOOGLE_OAUTH_CLIENT_ID,
                        callback: handleCredentialResponse,
                        auto_select: false,
                        cancel_on_tap_outside: true
                    });
                    
                    console.log(' Google Sign-In initialized successfully');
                    console.log(' Rendering button...');
                    
                    // Clear container first
                    buttonContainer.innerHTML = '';
                    
                    // Render the sign-in button
                    google.accounts.id.renderButton(
                        buttonContainer,
                        {
                            theme: 'filled_blue',
                            size: 'large',
                            width: '100%',
                            text: 'signin_with',
                            type: 'standard'
                        }
                    );
                    
                    console.log(' Google Sign-In button rendered successfully!');
                    console.log(' Everything looks good! The button should be visible now.');
                    
                    // Hide fallback button and loading message
                    if (fallbackContainer) fallbackContainer.style.display = 'none';
                    if (loadingMessage) loadingMessage.style.display = 'none';
                    
                } catch (error) {
                    console.error(' Error rendering Google Sign-In button:', error);
                    console.error('Error details:', {
                        message: error.message,
                        name: error.name,
                        stack: error.stack,
                        origin: window.location.origin,
                        clientId: GOOGLE_OAUTH_CLIENT_ID
                    });
                    
                    if (loadingMessage) loadingMessage.style.display = 'none';
                    
                    // Show fallback button
                    if (fallbackContainer) {
                        fallbackContainer.style.display = 'block';
                        errorText.innerHTML = `
                            <strong> Error loading Google button:</strong><br>
                            ${error.message || 'Unknown error'}<br>
                            <small>This usually means your domain isn't authorized yet or Google hasn't updated (can take 1-5 minutes).<br>
                            Check the browser console (F12) for more details.<br>
                            Click the button below to try manual sign-in.</small>
                        `;
                        errorDiv.style.display = 'block';
                    } else {
                        errorText.innerHTML = `
                            <strong> Error loading Google Sign-In:</strong><br>
                            ${error.message || 'Unknown error'}<br>
                            <small>Check your browser console for more details.</small>
                        `;
                        errorDiv.style.display = 'block';
                    }
                }
            } else {
                // Retry after a short delay if Google Identity Services hasn't loaded yet
                if (initAttempts < MAX_INIT_ATTEMPTS) {
                    if (loadingMessage) {
                        loadingMessage.textContent = `Loading sign-in button... (${initAttempts}/${MAX_INIT_ATTEMPTS})`;
                    }
                    setTimeout(initializeGoogleSignIn, 100);
                } else {
                    // Timeout - Google script failed to load, show fallback
                    console.error('Google Identity Services failed to load after', MAX_INIT_ATTEMPTS, 'attempts');
                    if (loadingMessage) loadingMessage.style.display = 'none';
                    
                    // Always show fallback button if Google's button doesn't load
                    if (fallbackContainer) {
                        fallbackContainer.style.display = 'block';
                        const currentOrigin = window.location.origin;
                        errorText.innerHTML = `
                            <strong> Google Sign-In script didn't load:</strong><br>
                            <strong>Your current domain:</strong> <code style="background: #f8f9fa; padding: 2px 6px; border-radius: 3px;">${currentOrigin}</code><br>
                            <br>
                            <strong>To fix:</strong><br>
                            1. Go to: <a href="https://console.cloud.google.com/apis/credentials" target="_blank" style="color: #4285f4;">Google Cloud Console  Credentials</a><br>
                            2. Click your OAuth 2.0 Client ID<br>
                            3. Under "Authorized JavaScript origins", click "+ ADD URI"<br>
                            4. Add: <code style="background: #f8f9fa; padding: 2px 6px; border-radius: 3px;">${currentOrigin}</code><br>
                            5. Also add: <code style="background: #f8f9fa; padding: 2px 6px; border-radius: 3px;">http://localhost</code> (for local testing)<br>
                            6. Under "Authorized redirect URIs", add the same URLs<br>
                            7. Click "SAVE"<br>
                            8. Wait 1-2 minutes, then refresh this page<br>
                            <br>
                            <strong>Click the button below to try manual sign-in:</strong>
                        `;
                        errorDiv.style.display = 'block';
                    } else {
                        errorText.innerHTML = `
                            <strong> Failed to load Google Sign-In:</strong><br>
                            Google Identity Services script did not load.<br>
                            <small>Please check your internet connection and try refreshing the page.</small>
                        `;
                        errorDiv.style.display = 'block';
                    }
                }
            }
        }
        
        // Fallback function to trigger Google Sign-In manually
        function triggerGoogleSignIn() {
            console.log('Triggering manual Google Sign-In');
            
            // Try to use the One Tap prompt if available
            if (typeof google !== 'undefined' && google.accounts && google.accounts.id) {
                try {
                    google.accounts.id.prompt((notification) => {
                        console.log('One Tap notification:', notification);
                        if (notification.isNotDisplayed() || notification.isSkippedMoment()) {
                            // One Tap failed, try popup
                            window.location.href = `https://accounts.google.com/o/oauth2/v2/auth?client_id=${GOOGLE_OAUTH_CLIENT_ID}&redirect_uri=${encodeURIComponent(window.location.origin + window.location.pathname)}&response_type=token&scope=openid%20profile%20email&nonce=${Date.now()}`;
                        }
                    });
                } catch (error) {
                    console.error('Error with One Tap:', error);
                    // Fallback to OAuth popup
                    window.location.href = `https://accounts.google.com/o/oauth2/v2/auth?client_id=${GOOGLE_OAUTH_CLIENT_ID}&redirect_uri=${encodeURIComponent(window.location.origin + window.location.pathname)}&response_type=token&scope=openid%20profile%20email&nonce=${Date.now()}`;
                }
            } else {
                const currentOrigin = window.location.origin;
                alert(`Google Sign-In is not available.\n\nYour current domain: ${currentOrigin}\n\nTo fix:\n1. Go to: https://console.cloud.google.com/apis/credentials\n2. Edit your OAuth Client ID\n3. Add "${currentOrigin}" to "Authorized JavaScript origins"\n4. Also add "http://localhost" for local testing\n5. Save and wait 1-2 minutes, then refresh`);
            }
        }
        
        // Check if user is already logged in
        window.addEventListener('load', function() {
            const isLoggedIn = sessionStorage.getItem('adminLoggedIn');
            const adminEmail = sessionStorage.getItem('adminEmail');
            
            // Check if running from file:// protocol (won't work with Google OAuth)
            const isFileProtocol = window.location.protocol === 'file:';
            
            // Get current origin for helpful error messages
            const currentOrigin = window.location.origin;
            const currentHost = window.location.host;
            
            if (isFileProtocol) {
                const errorDiv = document.getElementById('loginError');
                const errorText = document.getElementById('loginErrorText');
                const loadingMessage = document.getElementById('loadingMessage');
                const fallbackContainer = document.getElementById('fallbackButtonContainer');
                
                if (loadingMessage) loadingMessage.style.display = 'none';
                errorText.innerHTML = `
                    <strong> File Protocol Detected:</strong><br>
                    Google OAuth doesn't work with file:// protocol.<br>
                    <strong>Solution:</strong> Run a local web server:<br>
                    <code style="background: #f8f9fa; padding: 4px 8px; border-radius: 4px; display: block; margin: 10px 0;">
                        python3 -m http.server 8000
                    </code>
                    Then open: <code>http://localhost:8000/index-sheets.html</code>
                `;
                errorDiv.style.display = 'block';
                
                // Show fallback button that explains the issue
                if (fallbackContainer) {
                    fallbackContainer.innerHTML = `
                        <button disabled style="width: 100%; background: #ccc; color: #666; border: none; padding: 12px 24px; border-radius: 6px; font-size: 16px; font-weight: 600; cursor: not-allowed;">
                            Sign in with Google (Not Available - Use Local Server)
                        </button>
                    `;
                    fallbackContainer.style.display = 'block';
                }
                return;
            }
            
            // If logged in but no email (old password-based login), force logout
            if (isLoggedIn === 'true' && !adminEmail) {
                console.log('Detected old password-based session. Forcing logout for Google OAuth.');
                sessionStorage.clear();
                localStorage.removeItem('adminLoggedIn');
                // Fall through to show login
            }
            
            // Check if properly logged in with Google OAuth
            if (isLoggedIn === 'true' && adminEmail) {
                document.getElementById('loginOverlay').style.display = 'none';
            } else {
                // Initialize Google Sign-In when page loads
                // Wait a bit for the page to fully render
                setTimeout(function() {
                    initializeGoogleSignIn();
                    // Update diagnostics after a moment
                    setTimeout(updateDiagnostics, 1000);
                }, 500);
            }
        });
        
        // Test and diagnostic functions
        function testGoogleSignIn() {
            console.log(' Testing Google Sign-In configuration...');
            const origin = window.location.origin;
            const clientId = GOOGLE_OAUTH_CLIENT_ID;
            
            console.log(' Current origin:', origin);
            console.log(' Client ID:', clientId);
            console.log(' Google script loaded:', typeof google !== 'undefined' ? ' Yes' : ' No');
            
            if (typeof google !== 'undefined' && google.accounts && google.accounts.id) {
                try {
                    google.accounts.id.initialize({
                        client_id: clientId,
                        callback: function(response) {
                            console.log(' Test successful! Got credential response');
                            alert(' Test successful! Google Sign-In is working.\n\nIf you see this, your configuration is correct!');
                        },
                        auto_select: false
                    });
                    
                    // Try to render a test button
                    const testDiv = document.createElement('div');
                    document.body.appendChild(testDiv);
                    
                    google.accounts.id.renderButton(testDiv, {
                        theme: 'filled_blue',
                        size: 'large',
                        text: 'signin_with'
                    });
                    
                    console.log(' Test button rendered - configuration is correct!');
                    alert(' Test successful! Google Sign-In button rendered.\n\nYour configuration is working correctly!\n\nIf you still don\'t see the button on the login screen, wait 1-2 minutes for Google\'s servers to update.');
                    
                    // Remove test button
                    setTimeout(() => testDiv.remove(), 5000);
                } catch (error) {
                    console.error(' Test failed:', error);
                    alert(` Test failed: ${error.message}\n\nThis usually means:\n1. Your domain isn't authorized yet (wait 1-5 minutes)\n2. Or there's a configuration issue\n\nCheck the console for details.`);
                }
            } else {
                alert(' Google Identity Services script not loaded.\n\nCheck:\n1. Your internet connection\n2. Browser console for errors\n3. That the script tag is in the HTML');
            }
        }
        
        function checkOAuthConfig() {
            const origin = window.location.origin;
            const clientId = GOOGLE_OAUTH_CLIENT_ID;
            
            const config = {
                origin: origin,
                clientId: clientId,
                googleLoaded: typeof google !== 'undefined',
                buttonContainer: document.getElementById('g_id_onload') ? 'exists' : 'missing',
                authorizedEmails: AUTHORIZED_EMAILS.length
            };
            
            console.log(' OAuth Configuration Check:', config);
            
            let message = ' OAuth Configuration:\n\n';
            message += `Domain: ${origin}\n`;
            message += `Client ID: ${clientId.substring(0, 20)}...\n`;
            message += `Google Script: ${config.googleLoaded ? ' Loaded' : ' Not loaded'}\n`;
            message += `Button Container: ${config.buttonContainer}\n`;
            message += `Authorized Emails: ${config.authorizedEmails}\n\n`;
            
            if (config.googleLoaded) {
                message += ' Google script is loaded\n';
            } else {
                message += ' Google script not loaded - check internet connection\n';
            }
            
            message += `\nMake sure "${origin}" is added to Google Cloud Console  Authorized JavaScript origins`;
            
            alert(message);
            console.log('Full config:', config);
        }
        
        // Update diagnostic info on load
        function updateDiagnostics() {
            const diagSection = document.getElementById('diagnosticSection');
            if (diagSection) {
                document.getElementById('diagOrigin').textContent = window.location.origin;
                document.getElementById('diagClientId').textContent = GOOGLE_OAUTH_CLIENT_ID.substring(0, 30) + '...';
                document.getElementById('diagGoogleLoaded').textContent = typeof google !== 'undefined' ? ' Yes' : ' No';
                document.getElementById('diagContainer').textContent = document.getElementById('g_id_onload') ? ' Found' : ' Missing';
                
                const status = typeof google !== 'undefined' && document.getElementById('g_id_onload') ? ' Ready' : ' Waiting...';
                document.getElementById('diagStatus').textContent = status;
                
                // Show diagnostic section
                diagSection.style.display = 'block';
            }
        }
        
        // Logout function
        function logout() {
            // Revoke Google token if available
            if (typeof google !== 'undefined' && google.accounts) {
                google.accounts.id.disableAutoSelect();
            }
            
            // Clear session data
            sessionStorage.removeItem('adminLoggedIn');
            sessionStorage.removeItem('adminEmail');
            sessionStorage.removeItem('adminName');
            localStorage.removeItem('adminLoggedIn');
            
            // Reload page to show login screen
            location.reload();
        }
    </script>
</body>
</html>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
